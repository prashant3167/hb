{
    "configuration" : {
        "@" : {
            "junos:changed-seconds" : "1556258104", 
            "junos:changed-localtime" : "2019-04-26 05:55:04 UTC"
        }, 
        "version" : "20190324.083354_rbu-builder.r1014486 [rbu-builder]", 
        "iceberg" : {
            "topic" : [
            {
                "topic-name" : "chassis.fan", 
                "description" : "Monitors the chassis fan status and notifies anomalies", 
                "synopsis" : "Chassis environment analyzer", 
                "rule" : [
                {
                    "rule-name" : "check-fan-health", 
                    "keys" : ["fan-name"],
                    "synopsis" : "Chassis fans health analyzer", 
                    "description" : "Collects chassis fan statistics periodically and notifies anomalies when fan status is NOK", 
                    "sensor" : [
                    {
                        "sensor-name" : "chassis-fan", 
                        "synopsis" : "iAgent sensor definition", 
                        "description" : "iAgent sensor using show-chassis-fan command to collect data from network device", 
                        "iAgent" : {
                            "file" : "chassis-fan.yml", 
                            "table" : "ChassisFanTable", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "fan-status", 
                        "synopsis" : "Chassis fan health KPI", 
                        "description" : "Sets health based on chassis fan status and speed", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-fan-health-good", 
                            "when" : {
                                "matches-with" : [
                                {
                                    "left-operand" : "$fan-status", 
                                    "right-operand" : "OK"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "$fan-name health-status is normal. $fan-measurement($fan-rpm rpm)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "is-fan-health-bad", 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "$fan-name health-status is $fan-status. $fan-measurement($fan-rpm rpm)"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "ACX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "11.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "11.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "SRX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }, 
                        "helper-files" : [
                        {
                            "file-type" : "other", 
                            "list-of-files" : ["chassis-fan.yml"]
                        }
                        ]
                    }
                }
                ]
            }, 
            {
                "topic-name" : "chassis.networkservices", 
                "rule" : [
                {
                    "rule-name" : "netsvc-rule", 
                    "sensor" : [
                    {
                        "sensor-name" : "netsvc-sensor", 
                        "iAgent" : {
                            "file" : "netsvc.yml", 
                            "table" : "NetSvcTable", 
                            "frequency" : "1h"
                        }
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "netsvc-sync", 
                        "frequency" : "1h", 
                        "term" : [
                        {
                            "term-name" : "synched", 
                            "when" : {
                                "matches-with" : [
                                {
                                    "left-operand" : "$netsvc_sync", 
                                    "right-operand" : "true", 
                                    "ignore-case" : [null]
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "green"
                                }
                            }
                        }, 
                        {
                            "term-name" : "else", 
                            "when" : {
                                "matches-with" : [
                                {
                                    "left-operand" : "$netsvc_sync", 
                                    "right-operand" : "false", 
                                    "ignore-case" : [null]
                                }
                                ], 
                                "exists" : [
                                {
                                    "field-name" : "$proposed_action"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "$proposed_action"
                                }
                            }
                        }
                        ]
                    }
                    ]
                }
                ]
            }, 
            {
                "topic-name" : "chassis.power", 
                "description" : "Monitors the chassis power usage of whole system, zone & PMs and notifies anomalies", 
                "synopsis" : "Chassis power manager", 
                "rule" : [
                {
                    "rule-name" : "check-pem-power-usage", 
                    "keys" : ["pem-slot"],
                    "synopsis" : "PEM power check", 
                    "description" : "Collects PEM power usage periodically and notifies anomaly when power usage exceed threshold", 
                    "function" : [
                    {
                        "function-name" : "used-percentage", 
                        "description" : "Calculates % of power usage out of total available", 
                        "path" : "used-percentage.py", 
                        "method" : "used_percentage", 
                        "argument" : [
                        {
                            "argument-name" : "total", 
                            "mandatory" : [null]
                        }, 
                        {
                            "argument-name" : "used", 
                            "mandatory" : [null]
                        }
                        ]
                    }
                    ], 
                    "sensor" : [
                    {
                        "sensor-name" : "components", 
                        "synopsis" : "Chassis components sensor definition", 
                        "description" : "/components open-config sensor to collect telemetry data from network device", 
                        "open-config" : {
                            "sensor-name" : "/components/", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "pem-power-usage", 
                        "formula" : {
                            "user-defined-function" : {
                                "function-name" : "used-percentage", 
                                "argument" : [
                                {
                                    "argument" : "total", 
                                    "value" : "$power-capacity-maximum"
                                }, 
                                {
                                    "argument" : "used", 
                                    "value" : "$power-dc-output"
                                }
                                ]
                            }
                        }, 
                        "type" : "integer", 
                        "description" : "Stores % of power usage by PEMs using UDF"
                    }, 
                    {
                        "field-name" : "pem-power-usage-threshold", 
                        "constant" : {
                            "value" : "{{pem-power-usage-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "PEM power usage threshold"
                    }, 
                    {
                        "field-name" : "pem-slot", 
                        "sensor" : [
                        {
                            "sensor-name" : "components", 
                            "where" : [
                            {
                                "query" : "/components/component/@name =~/^PEM[0-9]$/"
                            }
                            ], 
                            "path" : "/components/component/@name"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "PEM slot to monitor"
                    }, 
                    {
                        "field-name" : "pem-state", 
                        "sensor" : [
                        {
                            "sensor-name" : "components", 
                            "where" : [
                            {
                                "query" : "/components/component/properties/property/@name == 'state'"
                            }
                            ], 
                            "path" : "/components/component/properties/property/state/value"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "PEM current state"
                    }, 
                    {
                        "field-name" : "power-capacity-maximum", 
                        "sensor" : [
                        {
                            "sensor-name" : "components", 
                            "where" : [
                            {
                                "query" : "/components/component/properties/property/@name == 'power-capacity-maximum'"
                            }
                            ], 
                            "path" : "/components/component/properties/property/state/value"
                        }
                        ], 
                        "type" : "integer", 
                        "description" : "PEM maximum power capacity"
                    }, 
                    {
                        "field-name" : "power-dc-input", 
                        "sensor" : [
                        {
                            "sensor-name" : "components", 
                            "where" : [
                            {
                                "query" : "/components/component/properties/property/@name == 'power-dc-input'"
                            }
                            ], 
                            "path" : "/components/component/properties/property/state/value"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "PEM DC input"
                    }, 
                    {
                        "field-name" : "power-dc-output", 
                        "sensor" : [
                        {
                            "sensor-name" : "components", 
                            "where" : [
                            {
                                "query" : "/components/component/properties/property/@name == 'power-dc-output'"
                            }
                            ], 
                            "path" : "/components/component/properties/property/state/value"
                        }
                        ], 
                        "type" : "integer", 
                        "description" : "PEM DC output"
                    }, 
                    {
                        "field-name" : "temperature-status", 
                        "sensor" : [
                        {
                            "sensor-name" : "components", 
                            "where" : [
                            {
                                "query" : "/components/component/properties/property/@name == 'temperature-status'"
                            }
                            ], 
                            "path" : "/components/component/properties/property/state/value"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "PEM temperature"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "pem-power-usage", 
                        "synopsis" : "PEM power usage KPI", 
                        "description" : "Sets health based increase in PEM power usage", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-power-usage-crossing-threshold", 
                            "when" : {
                                "greater-than" : [
                                {
                                    "left-operand" : "$pem-power-usage", 
                                    "right-operand" : "$pem-power-usage-threshold"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "$pem-slot power usage($pem-power-usage) exceed threshold"
                                }
                            }
                        }, 
                        {
                            "term-name" : "power-usage-normal", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "$pem-slot power usage($pem-power-usage) is normal"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "pem-state", 
                        "synopsis" : "PEM state check KPI", 
                        "description" : "Sets health based on PEM state", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-pem-online", 
                            "when" : {
                                "matches-with" : [
                                {
                                    "left-operand" : "$pem-state", 
                                    "right-operand" : "Online"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "$pem-slot is $pem-state"
                                }
                            }
                        }, 
                        {
                            "term-name" : "pem-offline", 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "$pem-slot is $pem-state"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "pem-temperature-status", 
                        "synopsis" : "PEM temperature KPI", 
                        "description" : "Sets health based on PEM temperature state", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-temperature-status-ok", 
                            "when" : {
                                "matches-with" : [
                                {
                                    "left-operand" : "$temperature-status", 
                                    "right-operand" : "OK"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "$pem-slot temperature status is $temperature-status"
                                }
                            }
                        }, 
                        {
                            "term-name" : "temperature-status-not-ok", 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "$pem-slot temperature status is $temperature-status"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "power-dc-input", 
                        "synopsis" : "PEM power DC input state KPI", 
                        "description" : "Sets health based on power DC input state", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-power-dc-input-ok", 
                            "when" : {
                                "matches-with" : [
                                {
                                    "left-operand" : "$power-dc-input", 
                                    "right-operand" : "OK"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "$pem-slot power-dc-input is $power-dc-input"
                                }
                            }
                        }, 
                        {
                            "term-name" : "is-power-dc-input-not-ok", 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "$pem-slot power-dc-input is $power-dc-input"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "pem-power-usage-threshold", 
                        "value" : "80", 
                        "description" : "PEM power usage threshold percentage", 
                        "type" : "int"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX9200"]
                                        }, 
                                        {
                                            "release-name" : "18.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX4650"]
                                        }, 
                                        {
                                            "release-name" : "18.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX4600"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "16.1R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["MX2010", "MX2020", "MX240", "MX480", "MX960"]
                                        }, 
                                        {
                                            "release-name" : "17.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["MX150"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["PTX1000", "PTX10000", "PTX5000"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX10000", "QFX5200"]
                                        }, 
                                        {
                                            "release-name" : "18.1R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX5100"]
                                        }, 
                                        {
                                            "release-name" : "18.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX5120-48Y"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }
                    }
                }, 
                {
                    "rule-name" : "check-system-power-usage", 
                    "synopsis" : "Chassis system power check", 
                    "description" : "Collects PEM power usage periodically and notifies anomaly when power usage exceed threshold", 
                    "function" : [
                    {
                        "function-name" : "used-percentage", 
                        "description" : "Calculates % of power usage out of total available", 
                        "path" : "used-percentage.py", 
                        "method" : "used_percentage", 
                        "argument" : [
                        {
                            "argument-name" : "total", 
                            "mandatory" : [null]
                        }, 
                        {
                            "argument-name" : "used", 
                            "mandatory" : [null]
                        }
                        ]
                    }
                    ], 
                    "sensor" : [
                    {
                        "sensor-name" : "components", 
                        "synopsis" : "Chassis components sensor definition", 
                        "description" : "/components open-config sensor to collect telemetry data from network device", 
                        "open-config" : {
                            "sensor-name" : "/components/", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "power-system-maximum", 
                        "sensor" : [
                        {
                            "sensor-name" : "components", 
                            "where" : [
                            {
                                "query" : "/components/component/properties/property/@name == 'power-system-maximum'"
                            }
                            ], 
                            "path" : "/components/component/properties/property/state/value"
                        }
                        ], 
                        "type" : "integer", 
                        "description" : "System max power available"
                    }, 
                    {
                        "field-name" : "power-system-remaining", 
                        "sensor" : [
                        {
                            "sensor-name" : "components", 
                            "where" : [
                            {
                                "query" : "/components/component/properties/property/@name == 'power-system-remaining'"
                            }
                            ], 
                            "path" : "/components/component/properties/property/state/value"
                        }
                        ], 
                        "type" : "integer", 
                        "description" : "System remaining power"
                    }, 
                    {
                        "field-name" : "system-power-remaining-in-percentage", 
                        "formula" : {
                            "user-defined-function" : {
                                "function-name" : "used-percentage", 
                                "argument" : [
                                {
                                    "argument" : "total", 
                                    "value" : "$power-system-maximum"
                                }, 
                                {
                                    "argument" : "used", 
                                    "value" : "$power-system-remaining"
                                }
                                ]
                            }
                        }, 
                        "type" : "integer", 
                        "description" : "Stores remaining power for system using UDF"
                    }, 
                    {
                        "field-name" : "system-power-usage-threshold", 
                        "constant" : {
                            "value" : "{{system-power-remaining-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "System power usage threshold"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "system-power-usage", 
                        "synopsis" : "System power usage KPI", 
                        "description" : "Sets health based on increasing system power usage", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-power-usage-abnormal", 
                            "when" : {
                                "less-than" : [
                                {
                                    "left-operand" : "$system-power-remaining-in-percentage", 
                                    "right-operand" : "$system-power-usage-threshold"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "System power usage abnormal! only $system-power-remaining-in-percentage % of power remaining"
                                }
                            }
                        }, 
                        {
                            "term-name" : "power-usage-normal", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "System power usage is normal. $system-power-remaining-in-percentage% of power remaining"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "system-power-remaining-threshold", 
                        "value" : "20", 
                        "description" : "System remaining power threshold percentage", 
                        "type" : "int"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX9200"]
                                        }, 
                                        {
                                            "release-name" : "18.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX4650"]
                                        }, 
                                        {
                                            "release-name" : "18.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX4600"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "16.1R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["MX2010", "MX2020", "MX240", "MX480", "MX960"]
                                        }, 
                                        {
                                            "release-name" : "17.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["MX150"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["PTX1000", "PTX10000", "PTX5000"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX10000", "QFX5200"]
                                        }, 
                                        {
                                            "release-name" : "18.1R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX5100"]
                                        }, 
                                        {
                                            "release-name" : "18.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX5120-48Y"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }
                    }
                }, 
                {
                    "rule-name" : "check-zone-power-usage", 
                    "keys" : ["str-zone", "zone"],
                    "synopsis" : "Zone power check", 
                    "description" : "Collects chassis zone power usage periodically and notifies anomaly when power usage exceed threshold", 
                    "function" : [
                    {
                        "function-name" : "used-percentage", 
                        "description" : "Calculates % of power usage out of total available", 
                        "path" : "used-percentage.py", 
                        "method" : "used_percentage", 
                        "argument" : [
                        {
                            "argument-name" : "total", 
                            "mandatory" : [null]
                        }, 
                        {
                            "argument-name" : "used", 
                            "mandatory" : [null]
                        }
                        ]
                    }
                    ], 
                    "sensor" : [
                    {
                        "sensor-name" : "chassis-power", 
                        "synopsis" : "iAgent sensor definition", 
                        "description" : "Netconf rpc used to collect telemetry data from network device", 
                        "iAgent" : {
                            "file" : "chassis-power.yml", 
                            "table" : "ChassisPowerTable", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "zone-power-usage", 
                        "formula" : {
                            "user-defined-function" : {
                                "function-name" : "used-percentage", 
                                "argument" : [
                                {
                                    "argument" : "total", 
                                    "value" : "$capacity-max"
                                }, 
                                {
                                    "argument" : "used", 
                                    "value" : "$capacity-actual-usage"
                                }
                                ]
                            }
                        }, 
                        "type" : "integer", 
                        "description" : "Stores % of zone power used using UDF"
                    }, 
                    {
                        "field-name" : "zone-power-usage-threshold", 
                        "constant" : {
                            "value" : "{{zone-power-usage-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "Zone power usage threshold"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "zone-power-usage", 
                        "synopsis" : "Zone power usage KPI", 
                        "description" : "Sets health based increase in zone power usage", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-power-usage-abnormal", 
                            "when" : {
                                "greater-than" : [
                                {
                                    "left-operand" : "$zone-power-usage", 
                                    "right-operand" : "$zone-power-usage-threshold"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Zone-$zone power usage($zone-power-usage%) exceed threshold"
                                }
                            }
                        }, 
                        {
                            "term-name" : "power-usage-normal", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "Zone-$zone power usage($zone-power-usage%) is normal"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "zone-power-usage-threshold", 
                        "value" : "80", 
                        "description" : "Zone power usage threshold", 
                        "type" : "int"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "ACX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "11.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "11.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "SRX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }, 
                        "helper-files" : [
                        {
                            "file-type" : "other", 
                            "list-of-files" : ["chassis-power.yml", "used-percentage.py"]
                        }
                        ]
                    }
                }
                ]
            }, 
            {
                "topic-name" : "chassis.temperatures", 
                "description" : "Monitors the chassis temperatures of whole chassis, REs', FPCs' & RE CPUs and notifies anomalies", 
                "synopsis" : "Chassis environment analyzer", 
                "rule" : [
                {
                    "rule-name" : "check-chassis-temperature", 
                    "keys" : ["chassis-name"],
                    "synopsis" : "Chassis temperature check", 
                    "description" : "Collects chassis temperature periodically and notifies anomalies when temperature exceed threshold", 
                    "sensor" : [
                    {
                        "sensor-name" : "components", 
                        "synopsis" : "Chassis components sensor definition", 
                        "description" : "/components open-config sensor to collect telemetry data from network device", 
                        "open-config" : {
                            "sensor-name" : "/components/", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "chassis-name", 
                        "sensor" : [
                        {
                            "sensor-name" : "components", 
                            "where" : [
                            {
                                "query" : "/components/component/@name =~ /Chassis/"
                            }
                            ], 
                            "path" : "/components/component/@name"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "chassis name to monitor"
                    }, 
                    {
                        "field-name" : "high-threshold", 
                        "constant" : {
                            "value" : "{{chassis-temperature-high-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "Chassis ambient temperature high threshold"
                    }, 
                    {
                        "field-name" : "low-threshold", 
                        "constant" : {
                            "value" : "{{chassis-temperature-low-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "Chassis ambient temperature low threshold"
                    }, 
                    {
                        "field-name" : "temperature-ambient", 
                        "sensor" : [
                        {
                            "sensor-name" : "components", 
                            "where" : [
                            {
                                "query" : "/components/component/properties/property/@name == 'temperature-ambient'"
                            }
                            ], 
                            "path" : "/components/component/properties/property/state/value"
                        }
                        ], 
                        "type" : "integer", 
                        "description" : "Chassis temperature"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "chassis-ambient-temperature", 
                        "synopsis" : "Chassis temperature KPI", 
                        "description" : "Sets health based on increase in chassis temperature", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-temperature-normal", 
                            "when" : {
                                "less-than" : [
                                {
                                    "left-operand" : "$temperature-ambient", 
                                    "right-operand" : "$low-threshold"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "Chassis ambient temperature is normal"
                                }
                            }
                        }, 
                        {
                            "term-name" : "is-temperature-median", 
                            "when" : {
                                "less-than" : [
                                {
                                    "left-operand" : "$temperature-ambient", 
                                    "right-operand" : "$high-threshold"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "Chassis ambient temperature($temperature-ambient degree C) exceed low threshold"
                                }
                            }
                        }, 
                        {
                            "term-name" : "temperature-abnormal", 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Chassis ambient temperature($temperature-ambient degree C) exceed high threshold"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "chassis-temperature-high-threshold", 
                        "value" : "55", 
                        "description" : "Chassis temperature high threshold: Utilization increase between metrics, before we report anomaly", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "chassis-temperature-low-threshold", 
                        "value" : "45", 
                        "description" : "Chassis temperature low threshold: Utilization increase between metrics, before we report anomaly", 
                        "type" : "int"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX9200"]
                                        }, 
                                        {
                                            "release-name" : "18.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX4650"]
                                        }, 
                                        {
                                            "release-name" : "18.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX4600"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "16.1R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["MX2010", "MX2020", "MX240", "MX480", "MX960"]
                                        }, 
                                        {
                                            "release-name" : "17.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["MX150"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["PTX1000", "PTX10000", "PTX5000"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX10000", "QFX5200"]
                                        }, 
                                        {
                                            "release-name" : "18.1R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX5100"]
                                        }, 
                                        {
                                            "release-name" : "18.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX5120-48Y"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }
                    }
                }, 
                {
                    "rule-name" : "check-fpc-temperature", 
                    "keys" : ["fpc"],
                    "synopsis" : "FPC temperature check", 
                    "description" : "Collects FPC temperature periodically and notifies anomaly when temperature exceed threshold", 
                    "sensor" : [
                    {
                        "sensor-name" : "components", 
                        "synopsis" : "Chassis components sensor definition", 
                        "description" : "/components open-config sensor to collect telemetry data from network device", 
                        "open-config" : {
                            "sensor-name" : "/components/", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "fpc", 
                        "sensor" : [
                        {
                            "sensor-name" : "components", 
                            "where" : [
                            {
                                "query" : "/components/component/@name =~ /^FPC{{fpc-slot-no}}$/"
                            }
                            ], 
                            "path" : "/components/component/@name"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "FPC slot to monitor"
                    }, 
                    {
                        "field-name" : "fpc-temperature", 
                        "sensor" : [
                        {
                            "sensor-name" : "components", 
                            "where" : [
                            {
                                "query" : "/components/component/properties/property/@name == 'temperature-intake'"
                            }
                            ], 
                            "path" : "/components/component/properties/property/state/value"
                        }
                        ], 
                        "type" : "integer", 
                        "description" : "FPC temperature"
                    }, 
                    {
                        "field-name" : "high-threshold", 
                        "constant" : {
                            "value" : "{{fpc-temperature-high-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "FPC temperature high threshold"
                    }, 
                    {
                        "field-name" : "low-threshold", 
                        "constant" : {
                            "value" : "{{fpc-temperature-low-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "FPC temperature low threshold"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "fpc-temperature", 
                        "synopsis" : "FPC temperature KPI", 
                        "description" : "Sets health based increase in FPC temperature", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-fpc-temperature-normal", 
                            "when" : {
                                "less-than-or-equal-to" : [
                                {
                                    "left-operand" : "$fpc-temperature", 
                                    "right-operand" : "$low-threshold"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "$fpc temperature($fpc-temperature degree C) is normal"
                                }
                            }
                        }, 
                        {
                            "term-name" : "is-fpc-temperature-median", 
                            "when" : {
                                "less-than-or-equal-to" : [
                                {
                                    "left-operand" : "$fpc-temperature", 
                                    "right-operand" : "$high-threshold"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "$fpc temperature($fpc-temperature degree C) exceed low threshold"
                                }
                            }
                        }, 
                        {
                            "term-name" : "fpc-temperature-abnormal", 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "$fpc temperature($fpc-temperature degree C) exceed high threshold"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "fpc-slot-no", 
                        "value" : "[0-9]*", 
                        "description" : "FPC slot to monitor, regular expression, e.g. '0'", 
                        "type" : "string"
                    }, 
                    {
                        "name" : "fpc-temperature-high-threshold", 
                        "value" : "55", 
                        "description" : "FPC temperature high threshold, We report anomaly if it is more than this value", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "fpc-temperature-low-threshold", 
                        "value" : "45", 
                        "description" : "FPC temperature low threshold, We report anomaly if it is more than this value", 
                        "type" : "int"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX9200"]
                                        }, 
                                        {
                                            "release-name" : "18.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX4650"]
                                        }, 
                                        {
                                            "release-name" : "18.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX4600"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "16.1R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["MX2010", "MX2020", "MX240", "MX480", "MX960"]
                                        }, 
                                        {
                                            "release-name" : "17.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["MX150"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["PTX1000", "PTX10000", "PTX5000"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX10000", "QFX5200"]
                                        }, 
                                        {
                                            "release-name" : "18.1R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX5100"]
                                        }, 
                                        {
                                            "release-name" : "18.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX5120-48Y"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }
                    }
                }, 
                {
                    "rule-name" : "check-re-cpu-temperature", 
                    "keys" : ["routing-engine"],
                    "synopsis" : "RE CPU temperature check", 
                    "description" : "Collects RE CPU temperature periodically and notifies anomaly when temperature exceed threshold", 
                    "sensor" : [
                    {
                        "sensor-name" : "components", 
                        "synopsis" : "Chassis components sensor definition", 
                        "description" : "/components open-config sensor to collect telemetry data from network device", 
                        "open-config" : {
                            "sensor-name" : "/components/", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "high-threshold", 
                        "constant" : {
                            "value" : "{{re-cpu-temperature-high-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "RE CPU temperature high threshold"
                    }, 
                    {
                        "field-name" : "low-threshold", 
                        "constant" : {
                            "value" : "{{re-cpu-temperature-low-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "RE CPU temperature low threshold"
                    }, 
                    {
                        "field-name" : "re-cpu-temperature", 
                        "sensor" : [
                        {
                            "sensor-name" : "components", 
                            "where" : [
                            {
                                "query" : "/components/component/properties/property/@name == 'temperature-cpu'"
                            }
                            ], 
                            "path" : "/components/component/properties/property/state/value"
                        }
                        ], 
                        "description" : "RE CPU temperature"
                    }, 
                    {
                        "field-name" : "routing-engine", 
                        "sensor" : [
                        {
                            "sensor-name" : "components", 
                            "where" : [
                            {
                                "query" : "/components/component/@name =~ /^Routing Engine[{{re-slot-no}}]*$/"
                            }
                            ], 
                            "path" : "/components/component/@name"
                        }
                        ], 
                        "description" : "RE name to monitor"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "re-cpu-temperature", 
                        "synopsis" : "RE CPU temperature KPI", 
                        "description" : "Sets health based increase in RE CPU temperature", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-temperature-normal", 
                            "when" : {
                                "less-than-or-equal-to" : [
                                {
                                    "left-operand" : "$re-cpu-temperature", 
                                    "right-operand" : "$low-threshold"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "$routing-engine CPU temperature($re-cpu-temperature degree C) is normal"
                                }
                            }
                        }, 
                        {
                            "term-name" : "is-temperature-median", 
                            "when" : {
                                "less-than" : [
                                {
                                    "left-operand" : "$re-cpu-temperature", 
                                    "right-operand" : "$high-threshold"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "$routing-engine CPU temperature($re-cpu-temperature degree C) exceed low threshold"
                                }
                            }
                        }, 
                        {
                            "term-name" : "temperature-abnormal", 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "$routing-engine CPU temperature($re-cpu-temperature degree C) exceed high threshold"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "re-cpu-temperature-high-threshold", 
                        "value" : "55", 
                        "description" : "RE CPU temperature high threshold: Utilization increase between metrics, before we report anomaly", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "re-cpu-temperature-low-threshold", 
                        "value" : "45", 
                        "description" : "RE CPU temperature low threshold: Utilization increase between metrics, before we report anomaly", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "re-slot-no", 
                        "value" : "0-1", 
                        "description" : "Routing engine slot numbers to monitor, regular expression, e.g. '0'", 
                        "type" : "string"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX9200"]
                                        }, 
                                        {
                                            "release-name" : "18.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX4650"]
                                        }, 
                                        {
                                            "release-name" : "18.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX4600"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "16.1R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["MX2010", "MX2020", "MX240", "MX480", "MX960"]
                                        }, 
                                        {
                                            "release-name" : "17.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["MX150"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["PTX1000", "PTX10000", "PTX5000"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX10000", "QFX5200"]
                                        }, 
                                        {
                                            "release-name" : "18.1R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX5100"]
                                        }, 
                                        {
                                            "release-name" : "18.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX5120-48Y"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }
                    }
                }, 
                {
                    "rule-name" : "check-re-temperature", 
                    "keys" : ["routing-engine"],
                    "synopsis" : "Routing-engine temperature check", 
                    "description" : "Collects routing-engine (RE) temperature periodically and notifies anomaly when temperature exceed threshold", 
                    "sensor" : [
                    {
                        "sensor-name" : "components", 
                        "synopsis" : "Chassis components sensor definition", 
                        "description" : "/components open-config sensor to collect telemetry data from network device", 
                        "open-config" : {
                            "sensor-name" : "/components/", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "high-threshold", 
                        "constant" : {
                            "value" : "{{re-temperature-high-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "RE temperature high threshold"
                    }, 
                    {
                        "field-name" : "low-threshold", 
                        "constant" : {
                            "value" : "{{re-temperature-low-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "RE temperature low threshold"
                    }, 
                    {
                        "field-name" : "re-temperature", 
                        "sensor" : [
                        {
                            "sensor-name" : "components", 
                            "where" : [
                            {
                                "query" : "/components/component/properties/property/@name == 'temperature'"
                            }
                            ], 
                            "path" : "/components/component/properties/property/state/value"
                        }
                        ], 
                        "description" : "RE temperature"
                    }, 
                    {
                        "field-name" : "routing-engine", 
                        "sensor" : [
                        {
                            "sensor-name" : "components", 
                            "where" : [
                            {
                                "query" : "/components/component/@name =~ /^Routing Engine[{{re-slot-no}}]*$/"
                            }
                            ], 
                            "path" : "/components/component/@name"
                        }
                        ], 
                        "description" : "RE name to monitor"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "re-temperature", 
                        "synopsis" : "RE temperature KPI", 
                        "description" : "Sets health based increase in RE temperature", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-re-temperature-normal", 
                            "when" : {
                                "less-than-or-equal-to" : [
                                {
                                    "left-operand" : "$re-temperature", 
                                    "right-operand" : "$low-threshold"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "$routing-engine temperature($re-temperature degree C) is normal"
                                }
                            }
                        }, 
                        {
                            "term-name" : "is-re-temperature-median", 
                            "when" : {
                                "less-than-or-equal-to" : [
                                {
                                    "left-operand" : "$re-temperature", 
                                    "right-operand" : "$high-threshold"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "$routing-engine temperature($re-temperature degree C) exceed low threshold"
                                }
                            }
                        }, 
                        {
                            "term-name" : "re-temperature-abnormal", 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "$routing-engine temperature($re-temperature degree C) exceed high threshold"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "re-slot-no", 
                        "value" : "0-1", 
                        "description" : "Routing engine slot numbers to monitor, regular expression, e.g. '0'", 
                        "type" : "string"
                    }, 
                    {
                        "name" : "re-temperature-high-threshold", 
                        "value" : "55", 
                        "description" : "RE temperature high threshold: Utilization increase between metrics, before we report anomaly", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "re-temperature-low-threshold", 
                        "value" : "45", 
                        "description" : "RE temperature low threshold: Utilization increase between metrics, before we report anomaly", 
                        "type" : "int"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX9200"]
                                        }, 
                                        {
                                            "release-name" : "18.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX4650"]
                                        }, 
                                        {
                                            "release-name" : "18.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX4600"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "16.1R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["MX2010", "MX2020", "MX240", "MX480", "MX960"]
                                        }, 
                                        {
                                            "release-name" : "17.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["MX150"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["PTX1000", "PTX10000", "PTX5000"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX10000", "QFX5200"]
                                        }, 
                                        {
                                            "release-name" : "18.1R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX5100"]
                                        }, 
                                        {
                                            "release-name" : "18.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX5120-48Y"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }
                    }
                }
                ]
            }, 
            {
                "topic-name" : "class-of-service.microburst", 
                "description" : "Interface egress queues microburst detection", 
                "synopsis" : "Microburst detector", 
                "rule" : [
                {
                    "rule-name" : "check-queue", 
                    "keys" : ["if-name", "queue-no"],
                    "synopsis" : " Microbust detector", 
                    "description" : "Collects all interfaces egress queues data using gpb sensor and detects microbursts", 
                    "sensor" : [
                    {
                        "sensor-name" : "jnpr-qmon-ext", 
                        "synopsis" : "Qmon native gpb sensor", 
                        "description" : "Sensor configuration to get bgp data from network devices", 
                        "native-gpb" : {
                            "sensor-name" : "jnpr_qmon_ext", 
                            "port" : 22000
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "buffer-percentage", 
                        "sensor" : [
                        {
                            "sensor-name" : "jnpr-qmon-ext", 
                            "path" : "queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.peak_buffer_occupancy_percent"
                        }
                        ], 
                        "type" : "float", 
                        "description" : "Interface egress buffer percent"
                    }, 
                    {
                        "field-name" : "egress-packets", 
                        "sensor" : [
                        {
                            "sensor-name" : "jnpr-qmon-ext", 
                            "path" : "queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.packets"
                        }
                        ], 
                        "type" : "float", 
                        "description" : "Interface egress packets"
                    }, 
                    {
                        "field-name" : "if-name", 
                        "sensor" : [
                        {
                            "sensor-name" : "jnpr-qmon-ext", 
                            "where" : [
                            {
                                "query" : "queue_monitor_element_info.if_name =~ /{{if-name-expr}}/"
                            }
                            ], 
                            "path" : "queue_monitor_element_info.if_name"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "Interface name to monitor"
                    }, 
                    {
                        "field-name" : "microburst", 
                        "formula" : {
                            "microburst" : {
                                "if-name" : "$if-name", 
                                "queue-no" : "$queue-no", 
                                "percentage" : "$buffer-percentage", 
                                "packets" : "$egress-packets"
                            }
                        }, 
                        "type" : "integer", 
                        "description" : "Derives microburst value"
                    }, 
                    {
                        "field-name" : "queue-no", 
                        "sensor" : [
                        {
                            "sensor-name" : "jnpr-qmon-ext", 
                            "where" : [
                            {
                                "query" : "queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.queue_number =~ /{{queue-no-expr}}/"
                            }
                            ], 
                            "path" : "queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.queue_number"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "Queue name or number to monitor"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "microburst", 
                        "synopsis" : "Microburst KPI", 
                        "description" : "Sets health based on the increase in microburst count", 
                        "frequency" : "30s", 
                        "term" : [
                        {
                            "term-name" : "green", 
                            "when" : {
                                "equal-to" : [
                                {
                                    "left-operand" : "$microburst", 
                                    "right-operand" : "0"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "No Microburst seen"
                                }
                            }
                        }, 
                        {
                            "term-name" : "red", 
                            "when" : {
                                "matches-with" : [
                                {
                                    "left-operand" : "True", 
                                    "right-operand" : "True"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Microburst detected"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "if-name-expr", 
                        "value" : ".*", 
                        "description" : "Interface names to monitor, regular expression, eg 'ge-.*'", 
                        "type" : "string"
                    }, 
                    {
                        "name" : "queue-no-expr", 
                        "value" : ".*", 
                        "description" : "Queue number or name to monitor, regular expression, eg '1|2'", 
                        "type" : "string"
                    }
                    ]
                }
                ]
            }, 
            {
                "topic-name" : "interface.monitor", 
                "description" : "Monitors only filtered interfaces based on keyword in description", 
                "synopsis" : "Selective interface KPIs monitoring", 
                "rule" : [
                {
                    "rule-name" : "check-interface-health", 
                    "keys" : ["interface-name"],
                    "synopsis" : "Interface KPI monitor based on description", 
                    "description" : "Using this rule any one of the interface statistics counter (in and out errors, packets, octets, flaps) will be monitored", 
                    "sensor" : [
                    {
                        "sensor-name" : "interfaces", 
                        "synopsis" : "Interface open-config sensor definition", 
                        "description" : "Interfaces open-config sensor to collect telemetry data from network device", 
                        "open-config" : {
                            "sensor-name" : "/interfaces/", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "description", 
                        "sensor" : [
                        {
                            "sensor-name" : "interfaces", 
                            "path" : "/interfaces/interface/state/description"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "This field is for interface description"
                    }, 
                    {
                        "field-name" : "high-threshold", 
                        "constant" : {
                            "value" : "{{high-threshold-variable}}"
                        }, 
                        "type" : "integer", 
                        "description" : "In error count high threshold"
                    }, 
                    {
                        "field-name" : "interface-name", 
                        "sensor" : [
                        {
                            "sensor-name" : "interfaces", 
                            "path" : "/interfaces/interface/@name"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "This field is interface name"
                    }, 
                    {
                        "field-name" : "medium-threshold", 
                        "constant" : {
                            "value" : "{{medium-threshold-variable}}"
                        }, 
                        "type" : "integer", 
                        "description" : "In error count high threshold"
                    }, 
                    {
                        "field-name" : "stats-name", 
                        "constant" : {
                            "value" : "{{stats-name-variable}}"
                        }, 
                        "type" : "string", 
                        "description" : "Interface statistics counter name"
                    }, 
                    {
                        "field-name" : "stats-value", 
                        "sensor" : [
                        {
                            "sensor-name" : "interfaces", 
                            "path" : "/interfaces/interface/state/counters/{{stats-name-variable}}"
                        }
                        ], 
                        "type" : "integer", 
                        "description" : "Interface statistics counter (in-octets) value"
                    }, 
                    {
                        "field-name" : "user-description", 
                        "constant" : {
                            "value" : "{{interface-description}}"
                        }, 
                        "type" : "string", 
                        "description" : "Keyword in interface description"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "interface-stats", 
                        "synopsis" : "interface statistics kpi", 
                        "description" : "Sets health based on interface statistics exceed threshold", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-interface-description-not-matching", 
                            "when" : {
                                "does-not-match-with" : [
                                {
                                    "left-operand" : "$description", 
                                    "right-operand" : "$user-description"
                                }
                                ]
                            }
                        }, 
                        {
                            "term-name" : "is-interface-stats-increasing-high-threshold", 
                            "when" : {
                                "increasing-at-least-by-value" : [
                                {
                                    "field-name" : "$stats-value", 
                                    "value" : "$high-threshold", 
                                    "time-range" : "180s"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "$stats-name of $interface-name($description) is:$stats-value and above high threshold($high-threshold)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "is-interface-stats-increasing-medium-threshold", 
                            "when" : {
                                "increasing-at-least-by-value" : [
                                {
                                    "field-name" : "$stats-value", 
                                    "value" : "$medium-threshold", 
                                    "time-range" : "180s"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "$stats-name of $interface-name($description) is:$stats-value and in medium range($medium-threshold)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "interface-stats-normal", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "$stats-name of $interface-name($description) is:$stats-value is normal"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "high-threshold-variable", 
                        "value" : "800000000", 
                        "description" : "Interface in traffic high threshold value in octets. Traffic rate of increase between metrics, before we report anomaly", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "interface-description", 
                        "value" : ".+", 
                        "description" : "Filter interfaces which contains keyword in its description, regular expression, e.g. 'core|edge|access|bng'", 
                        "type" : "string"
                    }, 
                    {
                        "name" : "medium-threshold-variable", 
                        "value" : "500000000", 
                        "description" : "Interface in traffic medium threshold value in octets. Traffic rate of increase between metrics, before we report anomaly", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "stats-name-variable", 
                        "value" : "in-octets", 
                        "description" : "Interface statistics counter name(in-octets, out-octets, in-pkts, out-pkts, in-unicast-pkts, out-unicast-pkts, in-errors, out-errors, carrier-transitions) to monitor. Create separate instance for each kpi", 
                        "type" : "string"
                    }
                    ]
                }
                ]
            }, 
            {
                "topic-name" : "interface.statistics", 
                "description" : "Rules relevant to metrics and KPI on the interfaces", 
                "synopsis" : "Host loopback analyzer", 
                "rule" : [
                {
                    "rule-name" : "check-host-loopback-status", 
                    "keys" : ["target"],
                    "synopsis" : "Host loopback analyzer", 
                    "description" : "Monitors the host loopback to detected wedges, toolkit errors", 
                    "sensor" : [
                    {
                        "sensor-name" : "hostlbstatussummarytable", 
                        "synopsis" : "iAgent  sensor definition", 
                        "description" : "Netconf command show host_loopback status-summary iAgent sensor to collect telemetry data from network device", 
                        "iAgent" : {
                            "file" : "host-loopback-status.yml", 
                            "table" : "HostlbStatusSummaryTable", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "detected-wedges", 
                        "synopsis" : "Host loopback wedges kpi", 
                        "description" : "Sets health based on host loopack wedges", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "are-detected-wedges-present", 
                            "when" : {
                                "matches-with" : [
                                {
                                    "left-operand" : "$no-detected-wedges", 
                                    "right-operand" : "true"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "No detected host loopback wedges"
                                }
                            }
                        }, 
                        {
                            "term-name" : "detected-wedges-present", 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Detected a host loopback wedge"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "toolkit-errors", 
                        "synopsis" : "Host loopback toolkit error kpi", 
                        "description" : "Sets health based on host loopback toolkit errors", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "are-toolkit-errors-present", 
                            "when" : {
                                "matches-with" : [
                                {
                                    "left-operand" : "$no-toolkit-errors", 
                                    "right-operand" : "true"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "No detected toolkit errors"
                                }
                            }
                        }, 
                        {
                            "term-name" : "toolkit-errors-present", 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Detected a toolkit error"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "ACX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "SRX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }, 
                        "helper-files" : [
                        {
                            "file-type" : "other", 
                            "list-of-files" : ["task-io.yml"]
                        }
                        ]
                    }
                }, 
                {
                    "rule-name" : "check-ifl-in-traffic", 
                    "keys" : ["interface-name", "sub-interface-index"],
                    "synopsis" : "Sub Interface input traffic analyzer.", 
                    "description" : "Collects input traffic (in-octets) periodically and notifies in case of traffic is above threshold", 
                    "sensor" : [
                    {
                        "sensor-name" : "interfaces", 
                        "synopsis" : "Sub Interface open-config sensor definition", 
                        "description" : "Sub Interfaces open-config sensor to collect telemetry data from network device", 
                        "open-config" : {
                            "sensor-name" : "/interfaces/", 
                            "frequency" : "20s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "high-threshold", 
                        "constant" : {
                            "value" : "{{in-octets-high-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "Input traffic high threshold."
                    }, 
                    {
                        "field-name" : "in-octets-stats-value", 
                        "sensor" : [
                        {
                            "sensor-name" : "interfaces", 
                            "path" : "/interfaces/interface/subinterfaces/subinterface/state/counters/{{stats-name}}"
                        }
                        ], 
                        "type" : "integer", 
                        "description" : "Sub Interface statistics counter (in-octets) value."
                    }, 
                    {
                        "field-name" : "interface-name", 
                        "sensor" : [
                        {
                            "sensor-name" : "interfaces", 
                            "where" : [
                            {
                                "query" : "/interfaces/interface/@name =~ /{{ifd-name}}/"
                            }
                            ], 
                            "path" : "/interfaces/interface/@name"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "Interfaces to be monitored"
                    }, 
                    {
                        "field-name" : "low-threshold", 
                        "constant" : {
                            "value" : "{{in-octets-low-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "Input traffic low threshold."
                    }, 
                    {
                        "field-name" : "sub-interface-index", 
                        "sensor" : [
                        {
                            "sensor-name" : "interfaces", 
                            "where" : [
                            {
                                "query" : "/interfaces/interface/subinterfaces/subinterface/@index =~ /{{ifl-no}}/"
                            }
                            ], 
                            "path" : "/interfaces/interface/subinterfaces/subinterface/@index"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "Interfaces to be monitored"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "in-traffic", 
                        "synopsis" : "Sub Interface input traffic kpi", 
                        "description" : "Sets health based on input traffic exceed threshold.", 
                        "frequency" : "20s", 
                        "term" : [
                        {
                            "term-name" : "is-interface-in-traffic-abnormal", 
                            "when" : {
                                "min-rate-of-increase" : [
                                {
                                    "field-name" : "$in-octets-stats-value", 
                                    "rate" : "$high-threshold", 
                                    "time-range" : "5m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "$interface-name.$sub-interface-index input traffic is above high threshold($high-threshold octets)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "is-interface-in-traffic-median", 
                            "when" : {
                                "min-rate-of-increase" : [
                                {
                                    "field-name" : "$in-octets-stats-value", 
                                    "rate" : "$low-threshold", 
                                    "time-range" : "5m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "$interface-name.$sub-interface-index input traffic is in medium range(>=$low-threshold,<=$high-threshold  octets)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "interface-in-traffic-normal", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "$interface-name.$sub-interface-index input traffic:$in-octets-stats-value is normal"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "ifd-name", 
                        "value" : ".*", 
                        "description" : "Interfaces to be monitored, regular expression, eg 'ge-.*'", 
                        "type" : "string"
                    }, 
                    {
                        "name" : "ifl-no", 
                        "value" : ".*", 
                        "description" : "Sub interfaces index to be monitored, regular expression, eg '0-10'", 
                        "type" : "string"
                    }, 
                    {
                        "name" : "in-octets-high-threshold", 
                        "value" : "80000000", 
                        "description" : "Sub Interface input traffic high threshold value in octets. Traffic rate of increase between metrics, before we report anomaly. Default value is 80000000 octets (80 MB)", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "in-octets-low-threshold", 
                        "value" : "50000000", 
                        "description" : "Sub Interface input traffic low threshold value in octets. Traffic rate of increase between metrics, before we report anomaly. Default value is 50000000 octets (50 MB)", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "stats-name", 
                        "value" : "in-octets", 
                        "description" : "Sub Interface input traffic counter name", 
                        "type" : "string"
                    }
                    ]
                }, 
                {
                    "rule-name" : "check-ifl-out-traffic", 
                    "keys" : ["interface-name", "sub-interface-index"],
                    "synopsis" : "Sub Interface output traffic analyzer.", 
                    "description" : "Collects output traffic (out-octets) periodically and notifies in case of traffic is above threshold", 
                    "sensor" : [
                    {
                        "sensor-name" : "interfaces", 
                        "synopsis" : "Sub Interface open-config sensor definition", 
                        "description" : "Sub Interfaces open-config sensor to collect telemetry data from network device", 
                        "open-config" : {
                            "sensor-name" : "/interfaces/", 
                            "frequency" : "20s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "high-threshold", 
                        "constant" : {
                            "value" : "{{out-octets-high-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "Output traffic high threshold."
                    }, 
                    {
                        "field-name" : "interface-name", 
                        "sensor" : [
                        {
                            "sensor-name" : "interfaces", 
                            "where" : [
                            {
                                "query" : "/interfaces/interface/@name =~ /{{ifd-name}}/"
                            }
                            ], 
                            "path" : "/interfaces/interface/@name"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "Interfaces to be monitored"
                    }, 
                    {
                        "field-name" : "low-threshold", 
                        "constant" : {
                            "value" : "{{out-octets-low-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "Output traffic low threshold."
                    }, 
                    {
                        "field-name" : "out-octets-stats-value", 
                        "sensor" : [
                        {
                            "sensor-name" : "interfaces", 
                            "path" : "/interfaces/interface/subinterfaces/subinterface/state/counters/{{stats-name}}"
                        }
                        ], 
                        "type" : "integer", 
                        "description" : "Sub Interface statistics counter (out-octets) value."
                    }, 
                    {
                        "field-name" : "sub-interface-index", 
                        "sensor" : [
                        {
                            "sensor-name" : "interfaces", 
                            "where" : [
                            {
                                "query" : "/interfaces/interface/subinterfaces/subinterface/@index =~ /{{ifl-no}}/"
                            }
                            ], 
                            "path" : "/interfaces/interface/subinterfaces/subinterface/@index"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "Interfaces to be monitored"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "out-traffic", 
                        "synopsis" : "Sub Interface output traffic kpi", 
                        "description" : "Sets health based on output traffic exceed threshold.", 
                        "frequency" : "20s", 
                        "term" : [
                        {
                            "term-name" : "is-interface-out-traffic-abnormal", 
                            "when" : {
                                "min-rate-of-increase" : [
                                {
                                    "field-name" : "$out-octets-stats-value", 
                                    "rate" : "$high-threshold", 
                                    "time-range" : "5m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "$interface-name.$sub-interface-index output traffic is above high threshold($high-threshold octets)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "is-interface-out-traffic-median", 
                            "when" : {
                                "min-rate-of-increase" : [
                                {
                                    "field-name" : "$out-octets-stats-value", 
                                    "rate" : "$low-threshold", 
                                    "time-range" : "5m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "$interface-name.$sub-interface-index output traffic is in medium range(>=$low-threshold,<=$high-threshold  octets)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "interface-out-traffic-normal", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "$interface-name.$sub-interface-index output traffic:$out-octets-stats-value is normal"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "ifd-name", 
                        "value" : ".*", 
                        "description" : "Interfaces to be monitored, regular expression, eg 'ge-.*'", 
                        "type" : "string"
                    }, 
                    {
                        "name" : "ifl-no", 
                        "value" : ".*", 
                        "description" : "Sub interfaces index to be monitored, regular expression, eg '0-10'", 
                        "type" : "string"
                    }, 
                    {
                        "name" : "out-octets-high-threshold", 
                        "value" : "80000000", 
                        "description" : "Sub Interface output traffic high threshold value in octets. Traffic rate of increase between metrics, before we report anomaly. Default value is 80000000 octets (80 MB)", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "out-octets-low-threshold", 
                        "value" : "50000000", 
                        "description" : "Sub Interface output traffic low threshold value in octets. Traffic rate of increase between metrics, before we report anomaly. Default value is 50000000 octets (50 MB)", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "stats-name", 
                        "value" : "out-octets", 
                        "description" : "Sub Interface output traffic counter name", 
                        "type" : "string"
                    }
                    ]
                }, 
                {
                    "rule-name" : "check-in-errors", 
                    "keys" : ["interface-name"],
                    "synopsis" : "Interface in-error analyzer", 
                    "description" : "Collects the interface input error (errors (all), drops,discards, timeouts and runts) periodically and notifies in case of anomalies", 
                    "sensor" : [
                    {
                        "sensor-name" : "interfaces", 
                        "synopsis" : "Interface open-config sensor definition", 
                        "description" : "Interfaces open-config sensor to collect telemetry data from network device", 
                        "open-config" : {
                            "sensor-name" : "/interfaces/", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "in-errors-count", 
                        "sensor" : [
                        {
                            "sensor-name" : "interfaces", 
                            "path" : "/interfaces/interface/state/counters/{{in-errors-stats-name}}"
                        }
                        ], 
                        "type" : "integer", 
                        "description" : "Number of in-errors"
                    }, 
                    {
                        "field-name" : "in-errors-threshold", 
                        "constant" : {
                            "value" : "{{in-errors-threshold-variable}}"
                        }, 
                        "type" : "integer", 
                        "description" : "In errors count increase threshold"
                    }, 
                    {
                        "field-name" : "interface-name", 
                        "sensor" : [
                        {
                            "sensor-name" : "interfaces", 
                            "where" : [
                            {
                                "query" : "/interfaces/interface/@name =~ /{{interface-name-variable}}/"
                            }
                            ], 
                            "path" : "/interfaces/interface/@name"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "Interfaces to be monitored"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "in-errors", 
                        "synopsis" : "Interface in-errors kpi", 
                        "description" : "Sets health based on the change in in-errors count", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-interface-in-errors-abnormal", 
                            "when" : {
                                "increasing-at-least-by-value" : [
                                {
                                    "field-name" : "$in-errors-count", 
                                    "value" : "$in-errors-threshold", 
                                    "time-range" : "180s"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "In errors are increasing continuously on $interface-name, Error count is:$in-errors-count"
                                }
                            }
                        }, 
                        {
                            "term-name" : "is-interface-in-errors-median", 
                            "when" : {
                                "increasing-at-least-by-value" : [
                                {
                                    "field-name" : "$in-errors-count", 
                                    "value" : "$in-errors-threshold"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "$interface-name in errors($in-errors-count) are intermittent"
                                }
                            }
                        }, 
                        {
                            "term-name" : "no-interface-in-errors", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "$interface-name is stable"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "in-errors-stats-name", 
                        "value" : "in-errors", 
                        "description" : "Error stats counter name in-errors which is cumulative of in-frame-errors, in-resource-errors, in-giants, in-drops, in-discards and mtu-erros", 
                        "type" : "string"
                    }, 
                    {
                        "name" : "in-errors-threshold-variable", 
                        "value" : "1", 
                        "description" : "Interface in errors threshold: Number of errors increase between metrics, before we report anomaly", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "interface-name-variable", 
                        "value" : ".*", 
                        "description" : "Interface names to monitor, regular expression, e.g. 'ge-.*'", 
                        "type" : "string"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX9200"]
                                        }, 
                                        {
                                            "release-name" : "18.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX4650"]
                                        }, 
                                        {
                                            "release-name" : "18.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX4600"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "16.1R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["MX2010", "MX2020", "MX240", "MX480", "MX960"]
                                        }, 
                                        {
                                            "release-name" : "17.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["MX150"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["PTX1000", "PTX10000", "PTX5000"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX10000", "QFX5200"]
                                        }, 
                                        {
                                            "release-name" : "18.1R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX5100"]
                                        }, 
                                        {
                                            "release-name" : "18.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX5120-48Y"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }, 
                            "other-vendor" : [
                            {
                                "vendor-identifier" : "cisco-IOS-XR", 
                                "vendor-name" : "cisco", 
                                "operating-system" : "IOS-XR"
                            }
                            ]
                        }
                    }
                }, 
                {
                    "rule-name" : "check-in-traffic", 
                    "keys" : ["interface-name"],
                    "synopsis" : "Interface input traffic analyzer", 
                    "description" : "Collects input traffic (in-octets) periodically and notifies in case of traffic is above threshold", 
                    "sensor" : [
                    {
                        "sensor-name" : "interfaces", 
                        "synopsis" : "Interface open-config sensor definition", 
                        "description" : "Interfaces open-config sensor to collect telemetry data from network device", 
                        "open-config" : {
                            "sensor-name" : "/interfaces/", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "high-threshold", 
                        "constant" : {
                            "value" : "{{in-octets-high-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "Input traffic high threshold"
                    }, 
                    {
                        "field-name" : "in-octets-stats-value", 
                        "sensor" : [
                        {
                            "sensor-name" : "interfaces", 
                            "path" : "/interfaces/interface/state/counters/{{stats-name}}"
                        }
                        ], 
                        "type" : "integer", 
                        "description" : "Interface statistics counter (in-octets) value"
                    }, 
                    {
                        "field-name" : "interface-name", 
                        "sensor" : [
                        {
                            "sensor-name" : "interfaces", 
                            "where" : [
                            {
                                "query" : "/interfaces/interface/@name =~ /{{interface-name-variable}}/"
                            }
                            ], 
                            "path" : "/interfaces/interface/@name"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "Interfaces to be monitored"
                    }, 
                    {
                        "field-name" : "low-threshold", 
                        "constant" : {
                            "value" : "{{in-octets-low-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "Input traffic low threshold"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "in-traffic", 
                        "synopsis" : "Interface input traffic kpi", 
                        "description" : "Sets health based on input traffic exceed threshold", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-interface-in-traffic-abnormal", 
                            "when" : {
                                "increasing-at-least-by-value" : [
                                {
                                    "field-name" : "$in-octets-stats-value", 
                                    "value" : "$high-threshold", 
                                    "time-range" : "180s"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "$interface-name input traffic is above high threshold($high-threshold octets)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "is-interface-in-traffic-median", 
                            "when" : {
                                "increasing-at-least-by-value" : [
                                {
                                    "field-name" : "$in-octets-stats-value", 
                                    "value" : "$low-threshold", 
                                    "time-range" : "180s"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "$interface-name input traffic is in medium range(>=$low-threshold,<=$high-threshold  octets)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "interface-in-traffic-normal", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "$interface-name input traffic:$in-octets-stats-value is normal"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "in-octets-high-threshold", 
                        "value" : "800000000", 
                        "description" : "Interface input traffic high threshold value in octets. Traffic rate of increase between metrics, before we report anomaly. Default value for 1G interface is 800000000. Modify default value for 10G is 8000000000 and 100G is 80000000000", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "in-octets-low-threshold", 
                        "value" : "500000000", 
                        "description" : "Interface input traffic low threshold value in octets. Traffic rate of increase between metrics, before we report anomaly. Default value for 1G interface is 500000000. Modify default value for 10G is 5000000000 and 100G is 50000000000", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "interface-name-variable", 
                        "value" : ".*", 
                        "description" : "Interfaces to be monitored", 
                        "type" : "string"
                    }, 
                    {
                        "name" : "stats-name", 
                        "value" : "in-octets", 
                        "description" : "Interface input traffic counter name", 
                        "type" : "string"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX9200"]
                                        }, 
                                        {
                                            "release-name" : "18.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX4650"]
                                        }, 
                                        {
                                            "release-name" : "18.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX4600"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "16.1R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["MX2010", "MX2020", "MX240", "MX480", "MX960"]
                                        }, 
                                        {
                                            "release-name" : "17.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["MX150"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["PTX1000", "PTX10000", "PTX5000"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX10000", "QFX5200"]
                                        }, 
                                        {
                                            "release-name" : "18.1R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX5100"]
                                        }, 
                                        {
                                            "release-name" : "18.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX5120-48Y"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }, 
                            "other-vendor" : [
                            {
                                "vendor-identifier" : "cisco-IOS-XR", 
                                "vendor-name" : "cisco", 
                                "operating-system" : "IOS-XR"
                            }
                            ]
                        }
                    }
                }, 
                {
                    "rule-name" : "check-interface-flaps", 
                    "keys" : ["interface-name"],
                    "synopsis" : "Link flaps detector", 
                    "description" : "Collects link flap count periodically and notifies when flap count increases", 
                    "sensor" : [
                    {
                        "sensor-name" : "interfaces", 
                        "synopsis" : "Interface open-config sensor definition", 
                        "description" : "Interfaces open-config sensor to collect telemetry data from network device", 
                        "open-config" : {
                            "sensor-name" : "/interfaces/", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "admin-state", 
                        "sensor" : [
                        {
                            "sensor-name" : "interfaces", 
                            "path" : "/interfaces/interface/state/admin-status"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "Interface admin status"
                    }, 
                    {
                        "field-name" : "flaps", 
                        "sensor" : [
                        {
                            "sensor-name" : "interfaces", 
                            "path" : "/interfaces/interface/state/counters/carrier-transitions"
                        }
                        ], 
                        "type" : "integer", 
                        "description" : "Number of interface flaps"
                    }, 
                    {
                        "field-name" : "flaps-threshold", 
                        "constant" : {
                            "value" : "{{flaps-threshold-variable}}"
                        }, 
                        "type" : "integer", 
                        "description" : "Flap count increase threshold"
                    }, 
                    {
                        "field-name" : "interface-name", 
                        "sensor" : [
                        {
                            "sensor-name" : "interfaces", 
                            "where" : [
                            {
                                "query" : "/interfaces/interface/@name =~ /{{interface-name-variable}}/"
                            }
                            ], 
                            "path" : "/interfaces/interface/@name"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "Interfaces to be monitored"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "link-flaps", 
                        "synopsis" : "Link flaps KPI", 
                        "description" : "Sets health based on the change in flap count", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-link-admin-down", 
                            "when" : {
                                "matches-with" : [
                                {
                                    "left-operand" : "$admin-state", 
                                    "right-operand" : "DOWN"
                                }
                                ]
                            }
                        }, 
                        {
                            "term-name" : "is-link-flapping-consistently", 
                            "when" : {
                                "increasing-at-least-by-value" : [
                                {
                                    "field-name" : "$flaps", 
                                    "value" : "$flaps-threshold", 
                                    "time-range" : "180s"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Flaps are increasing continuously on $interface-name, flap count is:$flaps"
                                }
                            }
                        }, 
                        {
                            "term-name" : "is-link-fluctuating", 
                            "when" : {
                                "increasing-at-least-by-value" : [
                                {
                                    "field-name" : "$flaps", 
                                    "value" : "$flaps-threshold"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "$interface-name flaps($flaps) are intermittent"
                                }
                            }
                        }, 
                        {
                            "term-name" : "is-link-stable", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "$interface-name is stable"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "flaps-threshold-variable", 
                        "value" : "1", 
                        "description" : "Interface flaps threshold: Number of flap increase between metrics, before we report anomaly", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "interface-name-variable", 
                        "value" : ".*", 
                        "description" : "Interface names to monitor, regular expression, eg 'ge-.*'", 
                        "type" : "string"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX9200"]
                                        }, 
                                        {
                                            "release-name" : "18.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX4650"]
                                        }, 
                                        {
                                            "release-name" : "18.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX4600"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "16.1R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["MX2010", "MX2020", "MX240", "MX480", "MX960"]
                                        }, 
                                        {
                                            "release-name" : "17.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["MX150"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["PTX1000", "PTX10000", "PTX5000"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX10000", "QFX5200"]
                                        }, 
                                        {
                                            "release-name" : "18.1R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX5100"]
                                        }, 
                                        {
                                            "release-name" : "18.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX5120-48Y"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }, 
                            "other-vendor" : [
                            {
                                "vendor-identifier" : "cisco-IOS-XR", 
                                "vendor-name" : "cisco", 
                                "operating-system" : "IOS-XR"
                            }
                            ]
                        }
                    }
                }, 
                {
                    "rule-name" : "check-interface-status", 
                    "keys" : ["interface-name"],
                    "synopsis" : "Tnterface state analyzer", 
                    "description" : "Collects interface link oper state periodically and notifies when neighbor sate is down", 
                    "sensor" : [
                    {
                        "sensor-name" : "interfaces", 
                        "synopsis" : "Interface open-config sensor definition", 
                        "description" : "Interfaces open-config sensor to collect telemetry data from network device", 
                        "open-config" : {
                            "sensor-name" : "/interfaces/", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "admin-state", 
                        "sensor" : [
                        {
                            "sensor-name" : "interfaces", 
                            "path" : "/interfaces/interface/state/admin-status"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "Interface admin status"
                    }, 
                    {
                        "field-name" : "interface-name", 
                        "sensor" : [
                        {
                            "sensor-name" : "interfaces", 
                            "where" : [
                            {
                                "query" : "/interfaces/interface/@name =~ /{{interface-name-variable}}/"
                            }
                            ], 
                            "path" : "/interfaces/interface/@name"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "Interfaces to be monitored"
                    }, 
                    {
                        "field-name" : "link-state", 
                        "sensor" : [
                        {
                            "sensor-name" : "interfaces", 
                            "path" : "/interfaces/interface/state/oper-status"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "Interfaces link operator status"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "link-state", 
                        "synopsis" : "link state kpi", 
                        "description" : "Sets health based on link state", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-link-admin-down", 
                            "when" : {
                                "matches-with" : [
                                {
                                    "left-operand" : "$admin-state", 
                                    "right-operand" : "DOWN"
                                }
                                ]
                            }
                        }, 
                        {
                            "term-name" : "is-link-down", 
                            "when" : {
                                "matches-with" : [
                                {
                                    "left-operand" : "$admin-state", 
                                    "right-operand" : "UP"
                                }, 
                                {
                                    "left-operand" : "$link-state", 
                                    "right-operand" : "DOWN"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "$interface-name link operator status is DOWN"
                                }
                            }
                        }, 
                        {
                            "term-name" : "link-up", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "$interface-name link operator status is UP"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "interface-name-variable", 
                        "value" : ".*", 
                        "description" : "Interface names to monitor, regular expression, e.g. 'ge-.*'", 
                        "type" : "string"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX9200"]
                                        }, 
                                        {
                                            "release-name" : "18.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX4650"]
                                        }, 
                                        {
                                            "release-name" : "18.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX4600"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "16.1R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["MX2010", "MX2020", "MX240", "MX480", "MX960"]
                                        }, 
                                        {
                                            "release-name" : "17.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["MX150"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["PTX1000", "PTX10000", "PTX5000"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX10000", "QFX5200"]
                                        }, 
                                        {
                                            "release-name" : "18.1R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX5100"]
                                        }, 
                                        {
                                            "release-name" : "18.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX5120-48Y"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }, 
                            "other-vendor" : [
                            {
                                "vendor-identifier" : "cisco-IOS-XR", 
                                "vendor-name" : "cisco", 
                                "operating-system" : "IOS-XR"
                            }
                            ]
                        }
                    }
                }, 
                {
                    "rule-name" : "check-neighbor-state", 
                    "keys" : ["interface-name"],
                    "synopsis" : "Interface neighbor state analyzer", 
                    "description" : "Collects interface neighbor state periodically and notifies when neighbor sate is unreachable", 
                    "sensor" : [
                    {
                        "sensor-name" : "interfaces", 
                        "synopsis" : "Interface open-config sensor definition", 
                        "description" : "Interfaces open-config sensor to collect telemetry data from network device", 
                        "open-config" : {
                            "sensor-name" : "/interfaces/", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "admin-state", 
                        "sensor" : [
                        {
                            "sensor-name" : "interfaces", 
                            "path" : "/interfaces/interface/state/admin-status"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "Interface admin status"
                    }, 
                    {
                        "field-name" : "interface-name", 
                        "sensor" : [
                        {
                            "sensor-name" : "interfaces", 
                            "where" : [
                            {
                                "query" : "/interfaces/interface/@name =~ /{{interface-name-variable}}/"
                            }
                            ], 
                            "path" : "/interfaces/interface/@name"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "Interfaces to be monitored"
                    }, 
                    {
                        "field-name" : "link-state", 
                        "sensor" : [
                        {
                            "sensor-name" : "interfaces", 
                            "path" : "/interfaces/interface/state/oper-status"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "Interface operation status"
                    }, 
                    {
                        "field-name" : "neighbor-state", 
                        "sensor" : [
                        {
                            "sensor-name" : "interfaces", 
                            "path" : "/interfaces/interface/subinterfaces/subinterface/ipv4/neighbors/neighbor/state/neighbor-state"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "Interface ipv4 neighbor state"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "neighbor-state", 
                        "synopsis" : "interface neighbor state kpi", 
                        "description" : "Sets health based on interface neighbor state", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-neighbor-admin-down", 
                            "when" : {
                                "matches-with" : [
                                {
                                    "left-operand" : "$admin-state", 
                                    "right-operand" : "DOWN"
                                }
                                ]
                            }
                        }, 
                        {
                            "term-name" : "is-link-state-down", 
                            "when" : {
                                "matches-with" : [
                                {
                                    "left-operand" : "$link-state", 
                                    "right-operand" : "DOWN"
                                }
                                ]
                            }
                        }, 
                        {
                            "term-name" : "neighbor-reachable", 
                            "when" : {
                                "matches-with" : [
                                {
                                    "left-operand" : "$link-state", 
                                    "right-operand" : "UP"
                                }, 
                                {
                                    "left-operand" : "$neighbor-state", 
                                    "right-operand" : "REACHABLE"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "$interface-name neighbor $neighbor-state"
                                }
                            }
                        }, 
                        {
                            "term-name" : "is-neighbor-unreachable", 
                            "when" : {
                                "matches-with" : [
                                {
                                    "left-operand" : "$neighbor-state", 
                                    "right-operand" : "NA"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "$interface-name neighbor $neighbor-state"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "interface-name-variable", 
                        "value" : ".*", 
                        "description" : "Interface names to monitor, regular expression, e.g. 'ge-.*'", 
                        "type" : "string"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX9200"]
                                        }, 
                                        {
                                            "release-name" : "18.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX4650"]
                                        }, 
                                        {
                                            "release-name" : "18.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX4600"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "16.1R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["MX2010", "MX2020", "MX240", "MX480", "MX960"]
                                        }, 
                                        {
                                            "release-name" : "17.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["MX150"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["PTX1000", "PTX10000", "PTX5000"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX10000", "QFX5200"]
                                        }, 
                                        {
                                            "release-name" : "18.1R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX5100"]
                                        }, 
                                        {
                                            "release-name" : "18.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX5120-48Y"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }
                    }
                }, 
                {
                    "rule-name" : "check-out-errors", 
                    "keys" : ["interface-name"],
                    "synopsis" : "Interface out-errors analyzer", 
                    "description" : "This rule collects interface output error (errors(all), drops, discards, timeouts and runts) periodically and notifies in case of anomalies", 
                    "sensor" : [
                    {
                        "sensor-name" : "interfaces", 
                        "synopsis" : "interface open-config sensor definition", 
                        "description" : "/interfaces open-config sensor to collect telemetry data from network device", 
                        "open-config" : {
                            "sensor-name" : "/interfaces/", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "interface-name", 
                        "sensor" : [
                        {
                            "sensor-name" : "interfaces", 
                            "where" : [
                            {
                                "query" : "/interfaces/interface/@name =~ /{{interface-name-variable}}/"
                            }
                            ], 
                            "path" : "/interfaces/interface/@name"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "Interfaces to be monitored"
                    }, 
                    {
                        "field-name" : "out-errors-count", 
                        "sensor" : [
                        {
                            "sensor-name" : "interfaces", 
                            "path" : "/interfaces/interface/state/counters/{{out-errors-stats-name-variable}}"
                        }
                        ], 
                        "type" : "integer", 
                        "description" : "This field shows interface field's value"
                    }, 
                    {
                        "field-name" : "out-errors-threshold", 
                        "constant" : {
                            "value" : "{{out-errors-threshold-variable}}"
                        }, 
                        "type" : "integer", 
                        "description" : "Out errors count increase threshold"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "out-errors", 
                        "synopsis" : "Interface out-errors kpi", 
                        "description" : "Sets health based on the change in out-errors count", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-interface-out-errors-abnormal", 
                            "when" : {
                                "increasing-at-least-by-value" : [
                                {
                                    "field-name" : "$out-errors-count", 
                                    "value" : "$out-errors-threshold", 
                                    "time-range" : "180s"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Out errors are increasing continuously on $interface-name, Error count is:$out-errors-count"
                                }
                            }
                        }, 
                        {
                            "term-name" : "is-interface-out-errors-median", 
                            "when" : {
                                "increasing-at-least-by-value" : [
                                {
                                    "field-name" : "$out-errors-count", 
                                    "value" : "$out-errors-threshold"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "$interface-name out errors ($out-errors-count) are intermittent"
                                }
                            }
                        }, 
                        {
                            "term-name" : "no-interface-out-errors", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "$interface-name is stable"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "interface-name-variable", 
                        "value" : ".*", 
                        "description" : "Interface names to monitor, regular expression, e.g. 'ge-.*'", 
                        "type" : "string"
                    }, 
                    {
                        "name" : "out-errors-stats-name-variable", 
                        "value" : "out-errors", 
                        "description" : "Error stats counter name out-errors which is cumulative of out-resource-errors, out-drops and out-discards", 
                        "type" : "string"
                    }, 
                    {
                        "name" : "out-errors-threshold-variable", 
                        "value" : "1", 
                        "description" : "Interface out errors threshold: Number of errors increase between metrics, before we report anomaly", 
                        "type" : "int"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX9200"]
                                        }, 
                                        {
                                            "release-name" : "18.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX4650"]
                                        }, 
                                        {
                                            "release-name" : "18.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX4600"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "16.1R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["MX2010", "MX2020", "MX240", "MX480", "MX960"]
                                        }, 
                                        {
                                            "release-name" : "17.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["MX150"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["PTX1000", "PTX10000", "PTX5000"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX10000", "QFX5200"]
                                        }, 
                                        {
                                            "release-name" : "18.1R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX5100"]
                                        }, 
                                        {
                                            "release-name" : "18.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX5120-48Y"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }, 
                            "other-vendor" : [
                            {
                                "vendor-identifier" : "cisco-IOS-XR", 
                                "vendor-name" : "cisco", 
                                "operating-system" : "IOS-XR"
                            }
                            ]
                        }
                    }
                }, 
                {
                    "rule-name" : "check-out-traffic", 
                    "keys" : ["interface-name"],
                    "synopsis" : "interface output traffic analyzer", 
                    "description" : "Collects output traffic(out-octets) periodically and notifies in case of traffic is above threshold", 
                    "sensor" : [
                    {
                        "sensor-name" : "interfaces", 
                        "synopsis" : "interface open-config sensor definition", 
                        "description" : "/interfaces open-config sensor to collect telemetry data from network device", 
                        "open-config" : {
                            "sensor-name" : "/interfaces/", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "high-threshold", 
                        "constant" : {
                            "value" : "{{out-octets-high-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "Output traffic high threshold"
                    }, 
                    {
                        "field-name" : "interface-name", 
                        "sensor" : [
                        {
                            "sensor-name" : "interfaces", 
                            "where" : [
                            {
                                "query" : "/interfaces/interface/@name =~ /{{interface-name-variable}}/"
                            }
                            ], 
                            "path" : "/interfaces/interface/@name"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "Interfaces to be monitored"
                    }, 
                    {
                        "field-name" : "low-threshold", 
                        "constant" : {
                            "value" : "{{out-octets-low-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "Output traffic low threshold"
                    }, 
                    {
                        "field-name" : "out-octets-stats-value", 
                        "sensor" : [
                        {
                            "sensor-name" : "interfaces", 
                            "path" : "/interfaces/interface/state/counters/{{out-octets-stats-name}}"
                        }
                        ], 
                        "type" : "integer", 
                        "description" : "Interface statistics counter (out-octets) value"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "out-traffic", 
                        "synopsis" : "Interface output traffic kpi", 
                        "description" : "Sets health based on output traffic exceed threshold", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-interface-stats-abnormal", 
                            "when" : {
                                "increasing-at-least-by-value" : [
                                {
                                    "field-name" : "$out-octets-stats-value", 
                                    "value" : "$high-threshold", 
                                    "time-range" : "180s"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "$interface-name output traffic is above high threshold($high-threshold octets)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "is-interface-stats-median", 
                            "when" : {
                                "increasing-at-least-by-value" : [
                                {
                                    "field-name" : "$out-octets-stats-value", 
                                    "value" : "$low-threshold", 
                                    "time-range" : "180s"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "$interface-name output traffic is in medium range(>=$low-threshold,<=$high-threshold octets)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "is-interface-stats-normal", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "$interface-name output traffic:$out-octets-stats-value is normal"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "interface-name-variable", 
                        "value" : ".*", 
                        "description" : "Interfaces to be monitored", 
                        "type" : "string"
                    }, 
                    {
                        "name" : "out-octets-high-threshold", 
                        "value" : "800000000", 
                        "description" : "Interface output traffic high threshold value in octets. Traffic rate of increase between metrics, before we report anomaly", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "out-octets-low-threshold", 
                        "value" : "500000000", 
                        "description" : "Interface output traffic low threshold value in octets. Traffic rate of increase between metrics, before we report anomaly", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "out-octets-stats-name", 
                        "value" : "out-octets", 
                        "description" : "Interface output traffic counter name", 
                        "type" : "string"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX9200"]
                                        }, 
                                        {
                                            "release-name" : "18.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX4650"]
                                        }, 
                                        {
                                            "release-name" : "18.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX4600"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "16.1R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["MX2010", "MX2020", "MX240", "MX480", "MX960"]
                                        }, 
                                        {
                                            "release-name" : "17.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["MX150"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["PTX1000", "PTX10000", "PTX5000"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX10000", "QFX5200"]
                                        }, 
                                        {
                                            "release-name" : "18.1R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX5100"]
                                        }, 
                                        {
                                            "release-name" : "18.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX5120-48Y"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }, 
                            "other-vendor" : [
                            {
                                "vendor-identifier" : "cisco-IOS-XR", 
                                "vendor-name" : "cisco", 
                                "operating-system" : "IOS-XR"
                            }
                            ]
                        }
                    }
                }
                ]
            }, 
            {
                "topic-name" : "linecard.cm-events", 
                "description" : "Monitors linecards and detect CM errors and alarms", 
                "synopsis" : "CM error finder", 
                "rule" : [
                {
                    "rule-name" : "check-cm-events", 
                    "keys" : ["cm-error-id"],
                    "synopsis" : "CM error analyzer", 
                    "description" : "Collects CM errors and count periodically and notifies when error count increases", 
                    "sensor" : [
                    {
                        "sensor-name" : "cm-events-sensor", 
                        "synopsis" : "CM error sensor definition", 
                        "description" : "/junos/system/cmerror/counters/ native GPB sensor to receive telemetry data from network device", 
                        "native-gpb" : {
                            "sensor-name" : "jnpr_cmerror_data_ext", 
                            "port" : 22000
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "cm-error-component-id", 
                        "sensor" : [
                        {
                            "sensor-name" : "cm-events-sensor", 
                            "path" : "error_item.component_id"
                        }
                        ], 
                        "type" : "integer", 
                        "description" : "CM error component ID"
                    }, 
                    {
                        "field-name" : "cm-error-description", 
                        "sensor" : [
                        {
                            "sensor-name" : "cm-events-sensor", 
                            "path" : "error_item.description"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "CM error detailed description"
                    }, 
                    {
                        "field-name" : "cm-error-id", 
                        "sensor" : [
                        {
                            "sensor-name" : "cm-events-sensor", 
                            "path" : "error_item.identifier"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "CM error ID to monitor"
                    }, 
                    {
                        "field-name" : "cm-error-module-id", 
                        "sensor" : [
                        {
                            "sensor-name" : "cm-events-sensor", 
                            "path" : "error_item.module_id"
                        }
                        ], 
                        "type" : "integer", 
                        "description" : "CM error module ID"
                    }, 
                    {
                        "field-name" : "cm-error-occur-count", 
                        "sensor" : [
                        {
                            "sensor-name" : "cm-events-sensor", 
                            "path" : "error_item.occur_count"
                        }
                        ], 
                        "type" : "integer", 
                        "description" : "CM error occur count"
                    }, 
                    {
                        "field-name" : "cm-error-threshold", 
                        "constant" : {
                            "value" : "{{cm-error-threshold-variable}}"
                        }, 
                        "type" : "integer", 
                        "description" : "CM error count increase threshold"
                    }, 
                    {
                        "field-name" : "fru-slot", 
                        "sensor" : [
                        {
                            "sensor-name" : "cm-events-sensor", 
                            "path" : "fru_slot"
                        }
                        ], 
                        "type" : "integer", 
                        "description" : "FRU slot number"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "cm-errors", 
                        "synopsis" : "CM error KPI", 
                        "description" : "Sets health based on the change in CM error count", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-cm-error-count-consistently-increasing", 
                            "when" : {
                                "increasing-at-least-by-value" : [
                                {
                                    "field-name" : "$cm-error-occur-count", 
                                    "value" : "$cm-error-threshold", 
                                    "time-range" : "3m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "CM errors are increasing continuously on fru:$fru-slot module:$cm-error-module-id component:$cm-error-component-id. $cm-error-description error count is:$cm-error-occur-count"
                                }
                            }
                        }, 
                        {
                            "term-name" : "is-cm-error-count-increasing", 
                            "when" : {
                                "increasing-at-least-by-value" : [
                                {
                                    "field-name" : "$cm-error-occur-count", 
                                    "value" : "$cm-error-threshold"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "CM errors are intermittent on fru:$fru-slot module:$cm-error-module-id component:$cm-error-component-id. $cm-error-description error count is:$cm-error-occur-count"
                                }
                            }
                        }, 
                        {
                            "term-name" : "is-cm-error-count-fine", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "$cm-error-description count not increasing"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "cm-error-threshold-variable", 
                        "value" : "1", 
                        "description" : "CM error threshold: Number of errors increase between metrics, before we report anomaly", 
                        "type" : "int"
                    }
                    ]
                }
                ]
            }, 
            {
                "topic-name" : "linecard.fpc", 
                "description" : "Monitors linecards memory & cpu and notifies anomalies", 
                "synopsis" : "Linecard health analyzer", 
                "rule" : [
                {
                    "rule-name" : "check-fpc-cpu", 
                    "keys" : ["fpc"],
                    "synopsis" : "FPC CPU analyzer", 
                    "description" : "Collects system FPC CPU statistics periodically and notifies anomalies when CPU utilization exceed threshold", 
                    "sensor" : [
                    {
                        "sensor-name" : "components", 
                        "synopsis" : "Chassis components open-config sensor definition", 
                        "description" : "/components open-config sensor path to collect telemetry data from network device", 
                        "open-config" : {
                            "sensor-name" : "/components/", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "fpc", 
                        "sensor" : [
                        {
                            "sensor-name" : "components", 
                            "where" : [
                            {
                                "query" : "/components/component/@name =~ /^FPC{{fpc-slot-no}}:CPU$/"
                            }
                            ], 
                            "path" : "/components/component/@name"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "FPC slot to monitor"
                    }, 
                    {
                        "field-name" : "fpc-cpu-utilization", 
                        "sensor" : [
                        {
                            "sensor-name" : "components", 
                            "where" : [
                            {
                                "query" : "/components/component/properties/property/@name == 'cpu-utilization-total'"
                            }
                            ], 
                            "path" : "/components/component/properties/property/state/value"
                        }
                        ], 
                        "type" : "integer", 
                        "description" : "FPC CPU utilization"
                    }, 
                    {
                        "field-name" : "high-threshold", 
                        "constant" : {
                            "value" : "{{fpc-cpu-high-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "FPC CPU utilization high threshold"
                    }, 
                    {
                        "field-name" : "low-threshold", 
                        "constant" : {
                            "value" : "{{fpc-cpu-low-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "FPC CPU utilization low threshold"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "fpc-cpu-utilization", 
                        "synopsis" : "FPC CPU utilization KPI", 
                        "description" : "Sets health based on increase in FPC CPU utilization", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-fpc-cpu-utilization-abnormal", 
                            "when" : {
                                "greater-than-or-equal-to" : [
                                {
                                    "left-operand" : "$fpc-cpu-utilization", 
                                    "right-operand" : "$high-threshold", 
                                    "time-range" : "3m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "$fpc utilization($fpc-cpu-utilization) exceed high threshold($high-threshold)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "is-fpc-cpu-utilization-median", 
                            "when" : {
                                "greater-than-or-equal-to" : [
                                {
                                    "left-operand" : "$fpc-cpu-utilization", 
                                    "right-operand" : "$low-threshold", 
                                    "time-range" : "3m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "$fpc utilization($fpc-cpu-utilization) exceed low threshold($low-threshold)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "fpc-cpu-utilization-normal", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "$fpc utilization($fpc-cpu-utilization) is normal"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "fpc-cpu-high-threshold", 
                        "value" : "80", 
                        "description" : "FPC CPU utilization high threshold: Utilization increase between metrics, before we report anomaly", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "fpc-cpu-low-threshold", 
                        "value" : "50", 
                        "description" : "FPC CPU utilization low threshold: Utilization increase between metrics, before we report anomaly", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "fpc-slot-no", 
                        "value" : "[0-9]*", 
                        "description" : "FPC slot to monitor, regular expression, e.g. '0-3'", 
                        "type" : "string"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX9200"]
                                        }, 
                                        {
                                            "release-name" : "18.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX4650"]
                                        }, 
                                        {
                                            "release-name" : "18.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX4600"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "16.1R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["MX2010", "MX2020", "MX240", "MX480", "MX960"]
                                        }, 
                                        {
                                            "release-name" : "17.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["MX150"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["PTX1000", "PTX10000", "PTX5000"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX10000", "QFX5200"]
                                        }, 
                                        {
                                            "release-name" : "18.1R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX5100"]
                                        }, 
                                        {
                                            "release-name" : "18.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX5120-48Y"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }
                    }
                }, 
                {
                    "rule-name" : "check-fpc-memory", 
                    "keys" : ["fpc"],
                    "synopsis" : "FPC memory analyzer", 
                    "description" : "Collects system FPC memory statistics periodically and notifies anomalies when heap and buffer utilization exceed threshold", 
                    "sensor" : [
                    {
                        "sensor-name" : "components", 
                        "synopsis" : "Chassis components sensor definition", 
                        "description" : "/components open-config sensor to collect telemetry data from network device", 
                        "open-config" : {
                            "sensor-name" : "/components/", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "buffer-high-threshold", 
                        "constant" : {
                            "value" : "{{fpc-buffer-high-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "FPC buffer utilization high threshold"
                    }, 
                    {
                        "field-name" : "buffer-low-threshold", 
                        "constant" : {
                            "value" : "{{fpc-buffer-low-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "FPC buffer utilization low threshold"
                    }, 
                    {
                        "field-name" : "fpc", 
                        "sensor" : [
                        {
                            "sensor-name" : "components", 
                            "where" : [
                            {
                                "query" : "/components/component/@name =~ /^FPC{{fpc-slot-no}}$/"
                            }
                            ], 
                            "path" : "/components/component/@name"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "FPC slot to monitor"
                    }, 
                    {
                        "field-name" : "fpc-memory-buffer", 
                        "sensor" : [
                        {
                            "sensor-name" : "components", 
                            "where" : [
                            {
                                "query" : "/components/component/properties/property/@name == 'memory-utilization-buffer'"
                            }
                            ], 
                            "path" : "/components/component/properties/property/state/value"
                        }
                        ], 
                        "type" : "integer", 
                        "description" : "FPC buffer memory utilization"
                    }, 
                    {
                        "field-name" : "fpc-memory-heap", 
                        "sensor" : [
                        {
                            "sensor-name" : "components", 
                            "where" : [
                            {
                                "query" : "/components/component/properties/property/@name == 'memory-utilization-heap'"
                            }
                            ], 
                            "path" : "/components/component/properties/property/state/value"
                        }
                        ], 
                        "type" : "integer", 
                        "description" : "FPC heap memory utilization"
                    }, 
                    {
                        "field-name" : "heap-high-threshold", 
                        "constant" : {
                            "value" : "{{fpc-heap-high-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "FPC heap utilization high threshold"
                    }, 
                    {
                        "field-name" : "heap-low-threshold", 
                        "constant" : {
                            "value" : "{{fpc-heap-low-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "FPC heap utilization low threshold"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "fpc-buffer-memory-utilization", 
                        "synopsis" : "FPC memory utilization KPI", 
                        "description" : "Sets health based on increase in fpc buffer memory utilization", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-fpc-buffer-memory-utilization-abnormal", 
                            "when" : {
                                "greater-than-or-equal-to" : [
                                {
                                    "left-operand" : "$fpc-memory-buffer", 
                                    "right-operand" : "$buffer-high-threshold", 
                                    "time-range" : "3m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "$fpc buffer memory utilization($fpc-memory-buffer) exceed high threshold($buffer-high-threshold)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "is-fpc-buffer-memory-utilization-median", 
                            "when" : {
                                "greater-than-or-equal-to" : [
                                {
                                    "left-operand" : "$fpc-memory-buffer", 
                                    "right-operand" : "$buffer-low-threshold", 
                                    "time-range" : "3m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "$fpc buffer memory utilization($fpc-memory-buffer) exceed low threshold($buffer-low-threshold)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "fpc-buffer-memory-utilization-normal", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "$fpc buffer memory utilization($fpc-memory-buffer) is normal"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "fpc-heap-memory-utilization", 
                        "synopsis" : "FPC heap memory utilization KPI", 
                        "description" : "Sets health based on increase in fpc heap memory utilization", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-fpc-heap-memory-utilization-abnormal", 
                            "when" : {
                                "greater-than-or-equal-to" : [
                                {
                                    "left-operand" : "$fpc-memory-heap", 
                                    "right-operand" : "$heap-high-threshold", 
                                    "time-range" : "3m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "$fpc heap utilization($fpc-memory-heap) exceed high threshold($heap-high-threshold)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "is-fpc-heap-memory-utilization-median", 
                            "when" : {
                                "greater-than-or-equal-to" : [
                                {
                                    "left-operand" : "$fpc-memory-heap", 
                                    "right-operand" : "$heap-low-threshold", 
                                    "time-range" : "3m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "$fpc heap utilization($fpc-memory-heap) exceed low threshold($heap-low-threshold)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "fpc-heap-memory-utilization-abnormal", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "$fpc heap utilization($fpc-memory-heap) is normal"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "fpc-buffer-high-threshold", 
                        "value" : "80", 
                        "description" : "FPC buffer utilization high threshold: Utilization increase between metrics, before we report anomaly", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "fpc-buffer-low-threshold", 
                        "value" : "50", 
                        "description" : "FPC buffer utilization low threshold: Utilization increase between metrics, before we report anomaly", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "fpc-heap-high-threshold", 
                        "value" : "80", 
                        "description" : "FPC heap utilization high threshold: Utilization increase between metrics, before we report anomaly", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "fpc-heap-low-threshold", 
                        "value" : "50", 
                        "description" : "FPC heap utilization low threshold: Utilization increase between metrics, before we report anomaly", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "fpc-slot-no", 
                        "value" : "[0-9]*", 
                        "description" : "FPC slot to monitor, regular expression, e.g. '0-3'", 
                        "type" : "string"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX9200"]
                                        }, 
                                        {
                                            "release-name" : "18.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX4650"]
                                        }, 
                                        {
                                            "release-name" : "18.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX4600"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "16.1R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["MX2010", "MX2020", "MX240", "MX480", "MX960"]
                                        }, 
                                        {
                                            "release-name" : "17.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["MX150"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["PTX1000", "PTX10000", "PTX5000"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX10000", "QFX5200"]
                                        }, 
                                        {
                                            "release-name" : "18.1R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX5100"]
                                        }, 
                                        {
                                            "release-name" : "18.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX5120-48Y"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }
                    }
                }, 
                {
                    "rule-name" : "fpc-memory", 
                    "keys" : ["id", "name", "target"],
                    "synopsis" : "FPC memory analyzer", 
                    "description" : "Monitors FPC memory usage percentage and notifies anomalies", 
                    "sensor" : [
                    {
                        "sensor-name" : "fpcmemory", 
                        "synopsis" : "FPC components open-config sensor definition", 
                        "description" : "FPC system open-config sensor to collect telemetry data from network device", 
                        "iAgent" : {
                            "file" : "fpc_memory.yml", 
                            "table" : "FpcMemory", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "memory-usage-percentage", 
                        "synopsis" : "PFE memory buffer utilization kpi", 
                        "description" : "Sets health based on increase in FPC memory buffer utilization", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "way-over-limit", 
                            "when" : {
                                "greater-than" : [
                                {
                                    "left-operand" : "$perc", 
                                    "right-operand" : "90"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "$name memory usage for $target is too high ($perc)!"
                                }
                            }
                        }, 
                        {
                            "term-name" : "over-limit", 
                            "when" : {
                                "greater-than" : [
                                {
                                    "left-operand" : "$perc", 
                                    "right-operand" : "80"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "$name memory usage for $target is high ($perc)!"
                                }
                            }
                        }, 
                        {
                            "term-name" : "normal", 
                            "when" : {
                                "matches-with" : [
                                {
                                    "left-operand" : "Any", 
                                    "right-operand" : "Any"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "$name memory usage for $target is normal ($perc)!"
                                }
                            }
                        }
                        ]
                    }
                    ]
                }
                ]
            }, 
            {
                "topic-name" : "linecard.jnh-exception-packets", 
                "description" : "Detects MPLS LSP blackhole", 
                "synopsis" : "MPLS blackhole detector", 
                "rule" : [
                {
                    "rule-name" : "check-drop-packets", 
                    "synopsis" : "Jnh exception traces analyzer", 
                    "description" : "Collects jnh exception traces from line cards and analyzes", 
                    "function" : [
                    {
                        "function-name" : "getlabel", 
                        "description" : "Function finds label which comes after pattern 8847 in any of the argument line", 
                        "path" : "mplslabel.py", 
                        "method" : "getmplslabel", 
                        "argument" : [
                        {
                            "argument-name" : "packet0"
                        }, 
                        {
                            "argument-name" : "packet1"
                        }, 
                        {
                            "argument-name" : "packet2"
                        }, 
                        {
                            "argument-name" : "packet3"
                        }, 
                        {
                            "argument-name" : "packet4"
                        }
                        ]
                    }
                    ], 
                    "sensor" : [
                    {
                        "sensor-name" : "ShowJnhExceptions", 
                        "synopsis" : "Netconf cli sensor definition", 
                        "description" : "Uses show jnh exceptions-traces cli command to get data from network devices", 
                        "iAgent" : {
                            "file" : "jnhexceptionpkt.yml", 
                            "table" : "ShowJnhExceptions", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "label", 
                        "formula" : {
                            "user-defined-function" : {
                                "function-name" : "getlabel", 
                                "argument" : [
                                {
                                    "argument" : "packet0", 
                                    "value" : "$packets_00"
                                }, 
                                {
                                    "argument" : "packet1", 
                                    "value" : "$packets_10"
                                }, 
                                {
                                    "argument" : "packet2", 
                                    "value" : "$packets_20"
                                }, 
                                {
                                    "argument" : "packet3", 
                                    "value" : "$packets_30"
                                }, 
                                {
                                    "argument" : "packet4", 
                                    "value" : "$packets_40"
                                }
                                ]
                            }
                        }, 
                        "description" : "Uses UDF to get label which comes after pattern 8847"
                    }, 
                    {
                        "field-name" : "name", 
                        "reference" : {
                            "path" : "/topic[topic-name='linecard.jnh-exception-packets']/rule[rule-name=check-rsvp]/field[label_in='$label']/name"
                        }, 
                        "description" : "Collecting label name from rule check-rsvp"
                    }, 
                    {
                        "field-name" : "source-address", 
                        "reference" : {
                            "path" : "/topic[topic-name='linecard.jnh-exception-packets']/rule[rule-name=check-rsvp]/field[label_in='$label']/source-address"
                        }, 
                        "description" : "Collecting RSVP session ip from rule check-rsvp"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "dropped-packets", 
                        "synopsis" : "Jnh packet drops KPI", 
                        "description" : "Sets health based jnh packet drop count increase", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "pktdrop", 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "dropping packet"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "ACX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "SRX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }, 
                        "helper-files" : [
                        {
                            "file-type" : "other", 
                            "list-of-files" : ["jnhexceptionpkt.yml", "mplslabel.py"]
                        }
                        ]
                    }
                }, 
                {
                    "rule-name" : "check-rsvp", 
                    "keys" : ["destination-address", "name", "source-address"],
                    "synopsis" : "RSVP statistics analyzer", 
                    "description" : "Collects RSVP statistics and analyzes", 
                    "sensor" : [
                    {
                        "sensor-name" : "RsvpSessionTable", 
                        "synopsis" : "Netconf rpc sensor definition", 
                        "description" : "Netconf sensor uses get-rsvp-session-information rpc", 
                        "iAgent" : {
                            "file" : "rsvpsession.yml", 
                            "table" : "RsvpSessionTable", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "rsvp-state", 
                        "synopsis" : "RSVP KPI", 
                        "description" : "Sets health based rsvp session statistics", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "rsvp", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "RSVP Session Captured. $label_in"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "ACX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "SRX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }, 
                        "helper-files" : [
                        {
                            "file-type" : "other", 
                            "list-of-files" : ["rsvpsession.yml"]
                        }
                        ]
                    }
                }
                ]
            }, 
            {
                "topic-name" : "linecard.ospf", 
                "description" : "This topic is to monitors and notify OSPF distributed denial of service counters collected from the linecards", 
                "synopsis" : "OSPF distributed denial of service statistics analyzer", 
                "rule" : [
                {
                    "rule-name" : "check-ddos-statistics", 
                    "keys" : ["group-name", "protocol-states-locale"],
                    "synopsis" : "OSPF distributed denial of service statistics analyzer", 
                    "description" : "Monitors ospf related distributed denial of service statistics", 
                    "sensor" : [
                    {
                        "sensor-name" : "ddosstats", 
                        "synopsis" : "ddos statistics sensor definition", 
                        "description" : "Netconf rpc get-ddos-ospf-information iAgent sensor to collect telemetry data from network device", 
                        "iAgent" : {
                            "file" : "ddos-statistics.yml", 
                            "table" : "ddosStats", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "ddos-arrival-rate-threshold", 
                        "constant" : {
                            "value" : "{{ddos-arrival-rate-threshold}}"
                        }, 
                        "description" : "This field is for ddos arive rate threshold"
                    }, 
                    {
                        "field-name" : "ddos-drop-count-threshold", 
                        "constant" : {
                            "value" : "{{ddos-drop-count-threshold}}"
                        }, 
                        "description" : "This field is for ddos drop count threshold"
                    }, 
                    {
                        "field-name" : "ddos-drop-rate-threshold", 
                        "constant" : {
                            "value" : "{{ddos-drop-rate-threshold}}"
                        }, 
                        "description" : "This field is for ddos drop rate threshold"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "ddos-drops", 
                        "synopsis" : "DDOS packet drops kpi", 
                        "description" : "Sets health based on DDOS packet drop rate", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-ddos-drops-increasing", 
                            "when" : {
                                "min-rate-of-increase" : [
                                {
                                    "field-name" : "$dropped-packets", 
                                    "rate" : "$ddos-drop-rate-threshold", 
                                    "time-range" : "5m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "DDOS packet drops ($dropped-packets) increasing"
                                }
                            }
                        }, 
                        {
                            "term-name" : "are-ddos-drops-over-threshold", 
                            "when" : {
                                "greater-than" : [
                                {
                                    "left-operand" : "$dropped-packets", 
                                    "right-operand" : "$ddos-drop-count-threshold"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "DDOS packet drops ($dropped-packets) over threshold ($ddos-drop-count-threshold)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "ddos-drops-not-increasing", 
                            "then" : {
                                "status" : {
                                    "color" : "green"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "ddos-packet-arrival-rate", 
                        "synopsis" : "DDOS packet arrival kpi", 
                        "description" : "Sets health based on DDOS packet arrival rate", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-max-packet-arrival-rate-greater-than-threshold", 
                            "when" : {
                                "greater-than-or-equal-to" : [
                                {
                                    "left-operand" : "$packet-arrival-rate-max", 
                                    "right-operand" : "$ddos-arrival-rate-threshold"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "DDOS packet max arrival rate is over threshold ($ddos-arrival-rate-threshold)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "max-packet-arrival-rate-less-than-threshold", 
                            "then" : {
                                "status" : {
                                    "color" : "green"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "ddos-packet-dropped-others", 
                        "synopsis" : "DDOS packet drop other kpi", 
                        "description" : "Sets health based on DDOS packet drop others", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-ddos-packet-dropped-others-increasing", 
                            "when" : {
                                "min-rate-of-increase" : [
                                {
                                    "field-name" : "$dropped-packets-others", 
                                    "rate" : "$ddos-drop-rate-threshold", 
                                    "time-range" : "5m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "DDOS packet dropped others ($dropped-packets-others) increasing"
                                }
                            }
                        }, 
                        {
                            "term-name" : "is-ddos-packet-drop-others-over-threshold", 
                            "when" : {
                                "greater-than" : [
                                {
                                    "left-operand" : "$dropped-packets-others", 
                                    "right-operand" : "$ddos-drop-count-threshold"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "DDOS packet dropped others ($dropped-packets-others) over threshold ($ddos-drop-count-threshold)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "ddos-packet-drop-others-not-increasing", 
                            "then" : {
                                "status" : {
                                    "color" : "green"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "ddos-arrival-rate-threshold", 
                        "value" : "1000", 
                        "description" : "DDOS arrival rate threshold value", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "ddos-drop-count-threshold", 
                        "value" : "0", 
                        "description" : "DDOS drop count threshold value", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "ddos-drop-rate-threshold", 
                        "value" : "1", 
                        "description" : "DDOS drop rate threshold value", 
                        "type" : "int"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "ACX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "SRX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }, 
                        "helper-files" : [
                        {
                            "file-type" : "other", 
                            "list-of-files" : ["ddos-statistics.yml"]
                        }
                        ]
                    }
                }
                ]
            }, 
            {
                "topic-name" : "linecard.statistics", 
                "description" : "Rules relevant to metrics on the line card", 
                "synopsis" : "Throttle statistics analyzer", 
                "rule" : [
                {
                    "rule-name" : "check-center-chip-fabric-in", 
                    "keys" : ["instance", "target"],
                    "synopsis" : "center chip fabric-in packets statistics analyzer", 
                    "description" : "Monitors the center chip fabric-in packets dropped ,error packets, received and sent packets", 
                    "sensor" : [
                    {
                        "sensor-name" : "center-chip-fabric-in", 
                        "synopsis" : "center chip fabric iAgent sensor definition", 
                        "description" : "Netconf command iAgent sensor to collect telemetry data from network device;", 
                        "iAgent" : {
                            "file" : "chip.yml", 
                            "table" : "CChipFiStatsTable", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "center-chip-fabric-in-dropped", 
                        "synopsis" : "center chip fabric kpi", 
                        "description" : "Sets health based on center chip fabric dropped packets ", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "are-center-chip-fabric-in-dropped-packets-increasing", 
                            "when" : {
                                "increasing-at-least-by-value" : [
                                {
                                    "field-name" : "$cchip-fi-packets-dropped", 
                                    "value" : "1", 
                                    "time-range" : "3m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Center chip fabric in dropped counters incrementing ($cchip-fi-packets-dropped)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "are-center-chip-fabric-in-dropped-packets-non-zero", 
                            "when" : {
                                "greater-than" : [
                                {
                                    "left-operand" : "$cchip-fi-packets-dropped", 
                                    "right-operand" : "0"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "Center chip fabric in dropped counters non-zero"
                                }
                            }
                        }, 
                        {
                            "term-name" : "center-chip-fabric-in-dropped-packets-not-increasing", 
                            "then" : {
                                "status" : {
                                    "color" : "green"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "center-chip-fabric-in-error", 
                        "synopsis" : "center chip fabric kpi", 
                        "description" : "Sets health based on center chip fabric in errors", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "are-center-chip-fabric-in-errors-present", 
                            "when" : {
                                "greater-than" : [
                                {
                                    "left-operand" : "$cchip-fi-packets-with-error", 
                                    "right-operand" : "0"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Center chip fabric in errors non-zero"
                                }
                            }
                        }, 
                        {
                            "term-name" : "center-chip-fabric-in-errors-not-present", 
                            "then" : {
                                "status" : {
                                    "color" : "green"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "center-chip-fabric-in-received", 
                        "synopsis" : "center chip fabric in received packets kpi", 
                        "description" : "Sets health based on center chip fabric in received packets", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "are-center-chip-fabric-in-received-packets-increasing", 
                            "when" : {
                                "increasing-at-least-by-value" : [
                                {
                                    "field-name" : "$cchip-fi-packets-received", 
                                    "value" : "1", 
                                    "time-range" : "3m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "green"
                                }
                            }
                        }, 
                        {
                            "term-name" : "center-chip-fabric-in-received-packets-not-increasing", 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Center chip fabric in received counters are NOT increasing"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "center-chip-fabric-in-sent-ok", 
                        "synopsis" : "center chip fabric in sent kpi", 
                        "description" : "Sets health based on center chip fabric in sent packets", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "are-center-chip-fabric-in-sent-ok-packets-increasing", 
                            "when" : {
                                "increasing-at-least-by-value" : [
                                {
                                    "field-name" : "$cchip-fi-packets-sent-ok", 
                                    "value" : "1", 
                                    "time-range" : "3m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "green"
                                }
                            }
                        }, 
                        {
                            "term-name" : "center-chip-fabric-in-sent-ok-packets-not-increasing", 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Center chip fabric in sent-ok counters are NOT increasing"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "ACX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "SRX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }, 
                        "helper-files" : [
                        {
                            "file-type" : "other", 
                            "list-of-files" : ["chip.yml"]
                        }
                        ]
                    }
                }, 
                {
                    "rule-name" : "check-center-chip-fabric-in-errors", 
                    "keys" : ["instance", "target"],
                    "synopsis" : "Center chip cell statistics analyzer", 
                    "description" : "Monitors the center chip cell fabric-in cell timeouts,crc error packets,late cells,error cells and malloc drops", 
                    "sensor" : [
                    {
                        "sensor-name" : "center-chip-fabric-in-errors", 
                        "synopsis" : "Center chip sensor definition", 
                        "description" : "Netconf command iAgent sensor to collect telemetry data from network device", 
                        "iAgent" : {
                            "file" : "chip.yml", 
                            "table" : "CChipFiErrTable", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "center-chip-fabric-in-cell-timeout", 
                        "synopsis" : "center chip fabric in cell timeout kpi", 
                        "description" : "Sets health based on center chip fabric in cell timeout.", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "are-center-chip-fabric-in-cell-timeout-present", 
                            "when" : {
                                "greater-than" : [
                                {
                                    "left-operand" : "$cchip-fi-cell-timeout", 
                                    "right-operand" : "0"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Center chip fabric in cell timeouts present ($cchip-fi-cell-timeout)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "center-chip-fabric-in-cell-timeout-not-present", 
                            "then" : {
                                "status" : {
                                    "color" : "green"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "center-chip-fabric-in-crc-error-packets", 
                        "synopsis" : "center chip fabric in crc error kpi", 
                        "description" : "Sets health based on center chip fabric in crc error.", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "are-center-chip-fabric-in-crc-error-packets-present", 
                            "when" : {
                                "greater-than" : [
                                {
                                    "left-operand" : "$cchip-fi-crc-error-packets", 
                                    "right-operand" : "0"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Center chip fabric in crc error packets present ($cchip-fi-crc-error-packets)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "center-chip-fabric-in-crc-error-packets-not-present", 
                            "then" : {
                                "status" : {
                                    "color" : "green"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "center-chip-fabric-in-error-cells", 
                        "synopsis" : "center chip fabric in error cells kpi", 
                        "description" : "Sets health based on center chip fabric in error cells.", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "are-center-chip-fabric-in-error-cells-present", 
                            "when" : {
                                "greater-than" : [
                                {
                                    "left-operand" : "$cchip-fi-error-cells", 
                                    "right-operand" : "0"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Center chip fabric in error cells present ($cchip-fi-error-cells)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "center-chip-fabric-in-error-cells-not-present", 
                            "then" : {
                                "status" : {
                                    "color" : "green"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "center-chip-fabric-in-late-cells", 
                        "synopsis" : "center chip fabric in late cells kpi", 
                        "description" : "Sets health based on center chip fabric in late cells.", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "are-center-chip-fabric-in-late-cells-present", 
                            "when" : {
                                "greater-than" : [
                                {
                                    "left-operand" : "$cchip-fi-late-cells", 
                                    "right-operand" : "0"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Center chip fabric in late cells present ($cchip-fi-late-cells)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "center-chip-fabric-in-late-cells-not-present", 
                            "then" : {
                                "status" : {
                                    "color" : "green"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "center-chip-fabric-in-malloc-drops", 
                        "synopsis" : "center chip fabric in malloc drops kpi", 
                        "description" : "Sets health based on center chip fabric in malloc drops.", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "are-center-chip-fabric-in-malloc-drops-present", 
                            "when" : {
                                "greater-than" : [
                                {
                                    "left-operand" : "$cchip-fi-malloc-drops", 
                                    "right-operand" : "0"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Center chip fabric in malloc drops present ($cchip-fi-malloc-drops)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "center-chip-fabric-in-malloc-drops-not-present", 
                            "then" : {
                                "status" : {
                                    "color" : "green"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "ACX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "SRX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }, 
                        "helper-files" : [
                        {
                            "file-type" : "other", 
                            "list-of-files" : ["chip.yml"]
                        }
                        ]
                    }
                }, 
                {
                    "rule-name" : "check-center-chip-host-path", 
                    "keys" : ["instance", "target"],
                    "synopsis" : "Center chip hostpath analyzer", 
                    "description" : "Monitors the center chip hostpath drops", 
                    "sensor" : [
                    {
                        "sensor-name" : "center-chip-host-path", 
                        "synopsis" : "Center chip sensor definition", 
                        "description" : "Netconf command iAgent sensor to collect telemetry data from network device", 
                        "iAgent" : {
                            "file" : "chip.yml", 
                            "table" : "CChipHostDropTable", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "center-chip-host-path-drops", 
                        "synopsis" : "Chip host path drops kpi", 
                        "description" : "Sets health based on chip host path drops", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "are-center-chip-host-path-drops-increasing", 
                            "when" : {
                                "min-rate-of-increase" : [
                                {
                                    "field-name" : "$cchip-host-path-drops", 
                                    "rate" : "1", 
                                    "time-range" : "300s"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Center chip host path drops incrementing ($cchip-host-path-drops)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "center-chip-host-path-drops-not-increasing", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "Center chip host path drops not incrementing"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "ACX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "SRX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }, 
                        "helper-files" : [
                        {
                            "file-type" : "other", 
                            "list-of-files" : ["chip.yml"]
                        }
                        ]
                    }
                }, 
                {
                    "rule-name" : "check-center-chip-lookup-in", 
                    "keys" : ["target"],
                    "synopsis" : "Center chip lookup analyzer", 
                    "description" : "Monitors center chip lookup in interrupts counters", 
                    "sensor" : [
                    {
                        "sensor-name" : "center-chip-lookup-in", 
                        "synopsis" : "iAgent sensor definition", 
                        "description" : "Netconf command  iAgent sensor to collect telemetry data from network device", 
                        "iAgent" : {
                            "file" : "chip.yml", 
                            "table" : "CChipLiInterruptStatsTable", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "center-chip-lookup-in-interrupts", 
                        "synopsis" : "Center chip lookup kpi", 
                        "description" : "Sets health based on center chip lookup interrupts", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "are-center-chip-lookup-in-interrupts-non-zero", 
                            "when" : {
                                "greater-than" : [
                                {
                                    "left-operand" : "$cchip-errors-from-lookup-chip", 
                                    "right-operand" : "0"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Center chip lookup in interrupts counters are non-zero"
                                }
                            }
                        }, 
                        {
                            "term-name" : "center-chip-lookup-in-interrupts-zero", 
                            "then" : {
                                "status" : {
                                    "color" : "green"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "ACX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "SRX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }, 
                        "helper-files" : [
                        {
                            "file-type" : "other", 
                            "list-of-files" : ["chip.yml"]
                        }
                        ]
                    }
                }, 
                {
                    "rule-name" : "check-center-chip-lookup-out", 
                    "keys" : ["target"],
                    "synopsis" : "Center chip lookup analyzer", 
                    "description" : "This topic is to monitors and notify Center chip lookup out error", 
                    "sensor" : [
                    {
                        "sensor-name" : "center-chip-lookup-out", 
                        "synopsis" : "iAgent sensor definition", 
                        "description" : "Netconf command iAgent sensor to collect telemetry data from network device", 
                        "iAgent" : {
                            "file" : "chip.yml", 
                            "table" : "CChipLoStatsTable", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "center-chip-lookup-out-errors", 
                        "synopsis" : "Center chip lookup out error kpi", 
                        "description" : "Sets health based on center chip lookup out error", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "are-center-chip-lookup-out-errors-non-zero", 
                            "when" : {
                                "greater-than" : [
                                {
                                    "left-operand" : "$cchip-lookup-out-errors", 
                                    "right-operand" : "0"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Center chip lookup out error counters non-zero"
                                }
                            }
                        }, 
                        {
                            "term-name" : "center-chip-lookup-out-errors-zero", 
                            "then" : {
                                "status" : {
                                    "color" : "green"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "ACX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "SRX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }, 
                        "helper-files" : [
                        {
                            "file-type" : "other", 
                            "list-of-files" : ["chip.yml"]
                        }
                        ]
                    }
                }, 
                {
                    "rule-name" : "check-center-chip-pt-entries", 
                    "keys" : ["target"],
                    "synopsis" : "Center chip packet statistics analyzer", 
                    "description" : "Monitors the center chip packet table wan & fabric entries", 
                    "sensor" : [
                    {
                        "sensor-name" : "center-chip-pt-entries", 
                        "synopsis" : "iAgent sensor definition", 
                        "description" : "Netconf command iAgent sensor to collect telemetry data from network device", 
                        "iAgent" : {
                            "file" : "chip.yml", 
                            "table" : "CChipPTStatTable", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "center-chip-packet-table-fabric-entries", 
                        "synopsis" : "Center chip packet table fabric entries depleted kpi", 
                        "description" : "Sets health based on center chip packet table fabric entries depleted", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "are-check-center-chip-packet-table-fabric-entries-depleted", 
                            "when" : {
                                "less-than" : [
                                {
                                    "left-operand" : "$cchip-free-internal-packet-table-fabric", 
                                    "right-operand" : "1000"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Center chip packet table fabric entries depleted ($cchip-free-internal-packet-table-fabric)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "center-chip-packet-table-fabric-entries-not-depleted", 
                            "then" : {
                                "status" : {
                                    "color" : "green"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "center-chip-packet-table-wan-entries", 
                        "synopsis" : "Center chip packet table wan entries depleted kpi", 
                        "description" : "Sets health based on center chip packet table wan entries depleted", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "are-center-chip-packet-table-wan-entries-depleted", 
                            "when" : {
                                "less-than" : [
                                {
                                    "left-operand" : "$cchip-free-internal-packet-table-wan", 
                                    "right-operand" : "1000"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Center chip packet table wan entries depleted ($cchip-free-internal-packet-table-wan)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "center-chip-packet-table-wan-entries-not-depleted", 
                            "then" : {
                                "status" : {
                                    "color" : "green"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "ACX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "SRX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }, 
                        "helper-files" : [
                        {
                            "file-type" : "other", 
                            "list-of-files" : ["chip.yml"]
                        }
                        ]
                    }
                }, 
                {
                    "rule-name" : "check-center-chip-wan-out", 
                    "keys" : ["target"],
                    "synopsis" : "Center chip wan out statistics analyzer", 
                    "description" : "Monitors the center chip wan out transmitted packets", 
                    "sensor" : [
                    {
                        "sensor-name" : "center-chip-wan-out", 
                        "synopsis" : "iAgent sensor definition", 
                        "description" : "Netconf command iAgent sensor to collect telemetry data from network device", 
                        "iAgent" : {
                            "file" : "chip.yml", 
                            "table" : "CChipWoStatsTable", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "center-chip-wan-out-packets-sent", 
                        "synopsis" : "Center chip wan out packets kpi", 
                        "description" : "Sets health based on center chip wan out packets", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "are-center-chip-wan-out-packets-sent-increasing", 
                            "when" : {
                                "min-rate-of-increase" : [
                                {
                                    "field-name" : "$cchip-wo-packets-sent", 
                                    "rate" : "1", 
                                    "time-range" : "300s"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "Center chip wan out packets sent incrementing ($cchip-wo-packets-sent)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "center-chip-wan-out-packets-sent-not-increasing", 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Center chip wan out packets sent not incrementing"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "ACX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "SRX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }, 
                        "helper-files" : [
                        {
                            "file-type" : "other", 
                            "list-of-files" : ["chip.yml"]
                        }
                        ]
                    }
                }, 
                {
                    "rule-name" : "check-cm-error-table", 
                    "keys" : ["module", "target"],
                    "synopsis" : "CM error analyzer", 
                    "description" : "This rule collects CM error statistics periodically and notifies in case of anomalies", 
                    "sensor" : [
                    {
                        "sensor-name" : "cm-error-table", 
                        "synopsis" : "cm error iAgent sensor definition", 
                        "description" : "Netconf command show cmerror module brief iAgent sensor to collect telemetry data from network device", 
                        "iAgent" : {
                            "file" : "cm-error.yml", 
                            "table" : "CMErrorTable", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "cm-errors-active", 
                        "synopsis" : "cm error kpi", 
                        "description" : "Sets health based on cm errors on the system.", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "are-cm-errors-active", 
                            "when" : {
                                "greater-than" : [
                                {
                                    "left-operand" : "$errors", 
                                    "right-operand" : "0"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Linecard Chassis Manager for $name has active errors"
                                }
                            }
                        }, 
                        {
                            "term-name" : "cm-errors-not-active", 
                            "then" : {
                                "status" : {
                                    "color" : "green"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "ACX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "SRX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }, 
                        "helper-files" : [
                        {
                            "file-type" : "other", 
                            "list-of-files" : ["cm-error.yml"]
                        }
                        ]
                    }
                }, 
                {
                    "rule-name" : "check-fpc-cpu-scheduler-info", 
                    "keys" : ["target"],
                    "synopsis" : "FPC CPU statistics analyzer", 
                    "description" : "Monitors FPC CPU utilization", 
                    "sensor" : [
                    {
                        "sensor-name" : "fpc-cpu-scheduler", 
                        "synopsis" : "iAgent sensor definition", 
                        "description" : "Netconf command show sched iAgent sensor to collect telemetry data from network device", 
                        "iAgent" : {
                            "file" : "scheduler-info.yml", 
                            "table" : "SchedulerCpuTable", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "configured-cputhreshold", 
                        "constant" : {
                            "value" : "{{fpc-cpu-threshold}}"
                        }, 
                        "description" : "This field is for cpu threshold"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "fpc-scheduler-info-five-seconds", 
                        "synopsis" : "Five seconds CPU threshold kpi", 
                        "description" : "Sets health based on five seconds FPC CPU statistics", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-utilization-over-5-seconds-greater-than-threshold", 
                            "when" : {
                                "greater-than" : [
                                {
                                    "left-operand" : "$cpu-5-seconds", 
                                    "right-operand" : "$configured-cputhreshold", 
                                    "time-range" : "300s"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "FPC 5-second CPU average utilization ($cpu-5-seconds) over threshold ($configured-cputhreshold)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "utilization-over-5-seconds-is-under-threshold", 
                            "then" : {
                                "status" : {
                                    "color" : "green"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "fpc-scheduler-info-one-minute", 
                        "synopsis" : "One minute CPU threshold kpi", 
                        "description" : "Sets health based on one minute FPC CPU statistics", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-utilization-over-1-minute-greater-than-threshold", 
                            "when" : {
                                "greater-than" : [
                                {
                                    "left-operand" : "$cpu-1-minute", 
                                    "right-operand" : "$configured-cputhreshold", 
                                    "time-range" : "300s"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "FPC 1-minute CPU average utilization ($cpu-1-minute) over threshold ($configured-cputhreshold)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "utilization-over-1-minute-is-less-than-threshold", 
                            "then" : {
                                "status" : {
                                    "color" : "green"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "fpc-scheduler-info-one-second", 
                        "synopsis" : "One second CPU threshold kpi", 
                        "description" : "Sets health based on one second FPC CPU statistics", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-utilization-over-1-second-greater-than-threshold", 
                            "when" : {
                                "greater-than" : [
                                {
                                    "left-operand" : "$cpu-1-second", 
                                    "right-operand" : "$configured-cputhreshold", 
                                    "time-range" : "300s"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "FPC 1-second CPU average utilization ($cpu-1-second) over threshold ($configured-cputhreshold)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "utilization-over-1-second-is-less-than-threshold", 
                            "then" : {
                                "status" : {
                                    "color" : "green"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "fpc-scheduler-info-ten-seconds", 
                        "synopsis" : "Ten seconds CPU threshold kpi", 
                        "description" : "Sets health based on ten seconds  CPU statistics", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-utilization-over-10-seconds-greater-than-threshold", 
                            "when" : {
                                "greater-than" : [
                                {
                                    "left-operand" : "$cpu-10-seconds", 
                                    "right-operand" : "$configured-cputhreshold", 
                                    "time-range" : "300s"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "FPC 10-second CPU average utilization ($cpu-10-seconds) over threshold ($configured-cputhreshold)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "utilization-over-10-seconds-is-less-than-threshold", 
                            "then" : {
                                "status" : {
                                    "color" : "green"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "fpc-cpu-threshold", 
                        "value" : "80", 
                        "description" : "FPC Used CPU threshold value", 
                        "type" : "int"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "ACX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "SRX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }, 
                        "helper-files" : [
                        {
                            "file-type" : "other", 
                            "list-of-files" : ["scheduler-info.yml"]
                        }
                        ]
                    }
                }, 
                {
                    "rule-name" : "check-fpc-threads", 
                    "keys" : ["Name", "target"],
                    "synopsis" : "Linecard CPU usage analyzer", 
                    "description" : "Monitors the CPU utilization by FPC threads", 
                    "sensor" : [
                    {
                        "sensor-name" : "fpc-threads", 
                        "synopsis" : "iAgent sensor definition", 
                        "description" : "Netconf show threads command iAgent sensor to collect telemetry data from network device", 
                        "iAgent" : {
                            "file" : "fpc-threads.yml", 
                            "table" : "FPCThread", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "linecard-cpu-usage-threshold", 
                        "constant" : {
                            "value" : "{{fpc-cpu-usage-threshold}}"
                        }, 
                        "description" : "This field is for linecard CPU usage threshold"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "fpc-threads-cpu-utilization", 
                        "synopsis" : "Linecard cpu usage kpi", 
                        "description" : "detects anamoly dynamically using linecard usage threshold", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-cpu-utilization-greater-than-threshold", 
                            "when" : {
                                "greater-than" : [
                                {
                                    "left-operand" : "$cpu", 
                                    "right-operand" : "$linecard-cpu-usage-threshold"
                                }
                                ], 
                                "does-not-match-with" : [
                                {
                                    "left-operand" : "$Name", 
                                    "right-operand" : "Idle"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "FPC thread CPU utilization for $Name ($cpu) is over threshold ($linecard-cpu-usage-threshold)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "cpu-utilization-is-less-than-threshold", 
                            "then" : {
                                "status" : {
                                    "color" : "green"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "fpc-cpu-usage-threshold", 
                        "value" : "80", 
                        "description" : "Linecard CPU usage threshold value", 
                        "type" : "int"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "ACX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "SRX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }, 
                        "helper-files" : [
                        {
                            "file-type" : "other", 
                            "list-of-files" : ["fpc-threads.yml"]
                        }
                        ]
                    }
                }, 
                {
                    "rule-name" : "check-fpc-utilization-information", 
                    "keys" : ["slot"],
                    "synopsis" : "Linecard FPC, heap and CPU analyzer", 
                    "description" : "Monitors FPC buffer, heap and cpu utilization", 
                    "sensor" : [
                    {
                        "sensor-name" : "fpccpuheaputilizationtable", 
                        "synopsis" : "iAgent sensor definition", 
                        "description" : "Netconf rpc get-fpc-information iAgent sensor to collect telemetry data from network device", 
                        "iAgent" : {
                            "file" : "fpc-utilization.yml", 
                            "table" : "FPCCPUHEAPutilizationTable", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "linecard-buffer-usage-threshold", 
                        "constant" : {
                            "value" : "{{fpc-buffer-usage-threshold}}"
                        }, 
                        "description" : "This field is for buffer usage threshold"
                    }, 
                    {
                        "field-name" : "linecard-cpu-usage-threshold", 
                        "constant" : {
                            "value" : "{{fpc-cpu-usage-threshold}}"
                        }, 
                        "description" : "This field is for linecard cpu usage threshold"
                    }, 
                    {
                        "field-name" : "linecard-heap-usage-threshold", 
                        "constant" : {
                            "value" : "{{fpc-heap-usage-threshold}}"
                        }, 
                        "description" : "This field is for linecard heap usage threshold"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "fpc-buffer-memory-utilization", 
                        "synopsis" : "Linecard buffer memory kpi", 
                        "description" : "Sets health based on linecard buffer memory", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-buffer-memory-utilization-greater-than-threshold", 
                            "when" : {
                                "greater-than" : [
                                {
                                    "left-operand" : "$memory-buffer-utilization", 
                                    "right-operand" : "$linecard-buffer-usage-threshold"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "FPC buffer memory utilization ($memory-buffer-utilization) is over threshold ($linecard-buffer-usage-threshold)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "buffer-utilization-less-than-threshold", 
                            "then" : {
                                "status" : {
                                    "color" : "green"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "fpc-cpu-utilization", 
                        "synopsis" : "Linecard cpu utilization kpi", 
                        "description" : "Sets health based on linecard cpu utilization", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-cpu-utilization-greater-than-80", 
                            "when" : {
                                "greater-than" : [
                                {
                                    "left-operand" : "$cpu-total", 
                                    "right-operand" : "$linecard-cpu-usage-threshold", 
                                    "time-range" : "180s"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "FPC CPU utilization ($cpu-total) is over threshold ($linecard-cpu-usage-threshold)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "cpu-utilization-less-than-threshold", 
                            "then" : {
                                "status" : {
                                    "color" : "green"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "fpc-heap-memory-utilization", 
                        "synopsis" : "Linecard heap memory kpi", 
                        "description" : "Sets health based on linecard heap memory utilization", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-heap-memory-utilization-greater-than-threshold", 
                            "when" : {
                                "greater-than" : [
                                {
                                    "left-operand" : "$memory-heap-utilization", 
                                    "right-operand" : "$linecard-heap-usage-threshold"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "FPC heap memory utilization ($memory-heap-utilization) is over threshold ($linecard-heap-usage-threshold)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "heap-memory-utilization-less-than-threshold", 
                            "then" : {
                                "status" : {
                                    "color" : "green"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "fpc-buffer-usage-threshold", 
                        "value" : "80", 
                        "description" : "Linecard Buffer Memory usage threshold value", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "fpc-cpu-usage-threshold", 
                        "value" : "80", 
                        "description" : "Linecard CPU usage threshold value", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "fpc-heap-usage-threshold", 
                        "value" : "80", 
                        "description" : "Linecard Heap Memory usage threshold value", 
                        "type" : "int"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "ACX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "11.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "11.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "SRX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }, 
                        "helper-files" : [
                        {
                            "file-type" : "other", 
                            "list-of-files" : ["fpc-utilization.yml"]
                        }
                        ]
                    }
                }, 
                {
                    "rule-name" : "check-ithrottle", 
                    "keys" : ["Name", "target"],
                    "synopsis" : "iThrottle statistics analyzer", 
                    "description" : "Monitors interrupt throttle configuration, state and usage", 
                    "sensor" : [
                    {
                        "sensor-name" : "ithrottle", 
                        "synopsis" : "iAgent sensor definition", 
                        "description" : "Netconf command show ithrottle iAgent sensor to collect telemetry data from network device", 
                        "iAgent" : {
                            "file" : "ithrottle.yml", 
                            "table" : "IthrottleTable", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "ithrottle-state-ok", 
                        "constant" : {
                            "value" : "{{fpc-ithrottle-state-ok}}"
                        }, 
                        "description" : "This field is for iThrottle state"
                    }, 
                    {
                        "field-name" : "ithrottle-usage-threshold", 
                        "constant" : {
                            "value" : "{{fpc-ithrottle-usage-threshold}}"
                        }, 
                        "description" : "This field is for iThrottle usage"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "configuration-state", 
                        "synopsis" : "Configuration state kpi", 
                        "description" : "Sets health based on configuration state", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-configuration-state-not-ok", 
                            "when" : {
                                "not-equal-to" : [
                                {
                                    "left-operand" : "$configuration-state", 
                                    "right-operand" : "$ithrottle-state-ok"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "iThrottle configuration state is not OK"
                                }
                            }
                        }, 
                        {
                            "term-name" : "configuration-state-is-ok", 
                            "then" : {
                                "status" : {
                                    "color" : "green"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "operating-state", 
                        "synopsis" : "Operating state kpi", 
                        "description" : "Sets health based on operating state", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-operating-state-not-ok", 
                            "when" : {
                                "not-equal-to" : [
                                {
                                    "left-operand" : "$operating-state", 
                                    "right-operand" : "$ithrottle-state-ok"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Operating state is not OK"
                                }
                            }
                        }, 
                        {
                            "term-name" : "operating-state-is-ok", 
                            "then" : {
                                "status" : {
                                    "color" : "green"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "usage-percentage", 
                        "synopsis" : "Usage percentage kpi", 
                        "description" : "Sets health based on usage percentage", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-usage-percentage-greater-than-threshold", 
                            "when" : {
                                "greater-than" : [
                                {
                                    "left-operand" : "$usage", 
                                    "right-operand" : "$ithrottle-usage-threshold"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Usage ($usage) is greater than threshold ($ithrottle-usage-threshold)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "usage-percentage-less-than-threshold", 
                            "then" : {
                                "status" : {
                                    "color" : "green"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "fpc-ithrottle-state-ok", 
                        "value" : "1", 
                        "description" : "Linecard Interrupt Throttle OK state value", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "fpc-ithrottle-usage-threshold", 
                        "value" : "80", 
                        "description" : "Linecard Interrupt Throttle usage threshold value", 
                        "type" : "int"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "ACX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "SRX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }, 
                        "helper-files" : [
                        {
                            "file-type" : "other", 
                            "list-of-files" : ["ithrottle.yml"]
                        }
                        ]
                    }
                }, 
                {
                    "rule-name" : "check-ithrottle-statistics", 
                    "keys" : ["id", "target"],
                    "synopsis" : "Throttle statistics analyzer", 
                    "description" : "Monitors throttle statistics such as adjacency ups and downs, starts and stops, disables and enables", 
                    "sensor" : [
                    {
                        "sensor-name" : "ithrottle-id", 
                        "synopsis" : "iAgent sensor definition", 
                        "description" : "Netconf command show ithrottle iAgent sensor to collect telemetry data from network device", 
                        "iAgent" : {
                            "file" : "ithrottle.yml", 
                            "table" : "IthrottleIDTable", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "ithrottle-higher-rate-threshold", 
                        "constant" : {
                            "value" : "{{fpc-ithrottle-higher-rate}}"
                        }, 
                        "description" : "This field is for ithrottle higher threshold"
                    }, 
                    {
                        "field-name" : "ithrottle-lower-rate-threshold", 
                        "constant" : {
                            "value" : "{{fpc-ithrottle-lower-rate}}"
                        }, 
                        "description" : "This field is forithrottle lower threshold"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "adjacency-down", 
                        "synopsis" : "Adjacency down kpi", 
                        "description" : "Sets health based on adjacency down", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-adjacency-down-increasing", 
                            "when" : {
                                "min-rate-of-increase" : [
                                {
                                    "field-name" : "$AdjDown", 
                                    "rate" : "$ithrottle-higher-rate-threshold", 
                                    "time-range" : "300s"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Adjaceny down ($AdjDown) increasing rapidly"
                                }
                            }
                        }, 
                        {
                            "term-name" : "adjacency-down-not-increasing", 
                            "then" : {
                                "status" : {
                                    "color" : "green"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "adjacency-up", 
                        "synopsis" : "Adjacency up kpi", 
                        "description" : "Sets health based on adjacency up", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-adjacency-up-increasing", 
                            "when" : {
                                "min-rate-of-increase" : [
                                {
                                    "field-name" : "$AdjUp", 
                                    "rate" : "$ithrottle-higher-rate-threshold", 
                                    "time-range" : "300s"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Adjaceny up ($AdjUp) increasing rapidly"
                                }
                            }
                        }, 
                        {
                            "term-name" : "adjacency-up-not-increasing", 
                            "then" : {
                                "status" : {
                                    "color" : "green"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "checks", 
                        "synopsis" : "ithrottle rate of increase kpi", 
                        "description" : "Sets health based on ithrottle rate of increaes", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "are-checks-increasing", 
                            "when" : {
                                "min-rate-of-increase" : [
                                {
                                    "field-name" : "$Checks", 
                                    "rate" : "$ithrottle-lower-rate-threshold", 
                                    "time-range" : "300s"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Checks ($Checks) increasing"
                                }
                            }
                        }, 
                        {
                            "term-name" : "checks-not-increasing", 
                            "then" : {
                                "status" : {
                                    "color" : "green"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "disables", 
                        "synopsis" : "iThrottle disable kpi", 
                        "description" : "Sets health based on ithrottle disable", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "are-disables-increasing", 
                            "when" : {
                                "min-rate-of-increase" : [
                                {
                                    "field-name" : "$Disables", 
                                    "rate" : "$ithrottle-higher-rate-threshold", 
                                    "time-range" : "300s"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Disables ($Disables) increasing rapidly"
                                }
                            }
                        }, 
                        {
                            "term-name" : "disable-not-increasing", 
                            "then" : {
                                "status" : {
                                    "color" : "green"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "enables", 
                        "synopsis" : "iThrottle enable kpi", 
                        "description" : "Sets health based on ithrottle enable", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "are-enables-increasing", 
                            "when" : {
                                "min-rate-of-increase" : [
                                {
                                    "field-name" : "$Enables", 
                                    "rate" : "$ithrottle-higher-rate-threshold", 
                                    "time-range" : "300s"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Enables ($Enables) increasing rapidly"
                                }
                            }
                        }, 
                        {
                            "term-name" : "enables-not-increasing", 
                            "then" : {
                                "status" : {
                                    "color" : "green"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "starts", 
                        "synopsis" : "iThrottle starts kpi", 
                        "description" : "Sets health based on ithrottle starts", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "are-starts-increasing", 
                            "when" : {
                                "min-rate-of-increase" : [
                                {
                                    "field-name" : "$Starts", 
                                    "rate" : "$ithrottle-lower-rate-threshold", 
                                    "time-range" : "300s"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Starts ($Starts) increasing"
                                }
                            }
                        }, 
                        {
                            "term-name" : "starts-are-not-increasing", 
                            "then" : {
                                "status" : {
                                    "color" : "green"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "stops", 
                        "synopsis" : "iThrottle stops kpi", 
                        "description" : "Sets health based on ithrottle stops", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "are-stops-increasing", 
                            "when" : {
                                "min-rate-of-increase" : [
                                {
                                    "field-name" : "$Stops", 
                                    "rate" : "$ithrottle-lower-rate-threshold", 
                                    "time-range" : "300s"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Stops ($Stops) increasing"
                                }
                            }
                        }, 
                        {
                            "term-name" : "stops-not-increasing", 
                            "then" : {
                                "status" : {
                                    "color" : "green"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "fpc-ithrottle-higher-rate", 
                        "value" : "5", 
                        "description" : "Linecard interrupt throttle HIGH threshold value", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "fpc-ithrottle-lower-rate", 
                        "value" : "1", 
                        "description" : "Linecard interrupt throttle LOW threshold value", 
                        "type" : "int"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "ACX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "SRX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }, 
                        "helper-files" : [
                        {
                            "file-type" : "other", 
                            "list-of-files" : ["ithrottle.yml"]
                        }
                        ]
                    }
                }, 
                {
                    "rule-name" : "check-jnh-exceptions", 
                    "keys" : ["jnh_instance", "reason", "target"],
                    "synopsis" : "JNH packet drop analyzer", 
                    "description" : "Monitors the jnh exception packets", 
                    "sensor" : [
                    {
                        "sensor-name" : "showjnhexceptions", 
                        "synopsis" : "iAgent sensor definition", 
                        "description" : "Netconf command show jnh  iAgent sensor to collect telemetry data from network device", 
                        "iAgent" : {
                            "file" : "jnh-exceptions.yml", 
                            "table" : "ShowJnhExceptions", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "exception-increase-rate", 
                        "constant" : {
                            "value" : "{{exception-increase-rate-input}}"
                        }, 
                        "type" : "integer", 
                        "description" : "This field initializes the exception increase rate"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "jnh-packet-drops", 
                        "synopsis" : "JNH packet drop kpi", 
                        "description" : "Sets health based on JNH packet drop", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "are-jnh-packet-drops-increasing", 
                            "when" : {
                                "min-rate-of-increase" : [
                                {
                                    "field-name" : "$packets", 
                                    "rate" : "$exception-increase-rate", 
                                    "time-range" : "300s"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "JNH exception $reason is increasing"
                                }
                            }
                        }, 
                        {
                            "term-name" : "jnh-packet-drops-not-increasing", 
                            "then" : {
                                "status" : {
                                    "color" : "green"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "exception-increase-rate-input", 
                        "value" : "5", 
                        "description" : "Exception increase rate", 
                        "type" : "int"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "ACX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "SRX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }, 
                        "helper-files" : [
                        {
                            "file-type" : "other", 
                            "list-of-files" : ["jnh-exceptions.yml"]
                        }
                        ]
                    }
                }, 
                {
                    "rule-name" : "check-jnh-interface-statistics", 
                    "keys" : ["counter", "ifd", "target"],
                    "synopsis" : "JNH IFD stream kpi", 
                    "description" : "Monitors the jnh ifd stream", 
                    "sensor" : [
                    {
                        "sensor-name" : "showjnhifdstream", 
                        "synopsis" : "iAgent sensor definition", 
                        "description" : "Netconf command show jnh ifd iAgent sensor to collect telemetry data from network device", 
                        "iAgent" : {
                            "file" : "jnh-ifd-stream.yml", 
                            "table" : "ShowJnhIfdStream", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "linecard-jnh-ifd-stream-increase-rate", 
                        "constant" : {
                            "value" : "{{fpc-jnh-ifd-stream-increase-rate}}"
                        }, 
                        "type" : "integer", 
                        "description" : "This field is for JNH ifd stream increase rate"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "jnh-ifd-stream-packets", 
                        "synopsis" : "JNH IFD stream kpi", 
                        "description" : "Sets health based on JNH ifd stream increase rate", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "are-jnh-ifd-stream-packets-increasing-over-threshold", 
                            "when" : {
                                "does-not-match-with" : [
                                {
                                    "left-operand" : "$counter", 
                                    "right-operand" : "rx."
                                }
                                ], 
                                "min-rate-of-increase" : [
                                {
                                    "field-name" : "$packets", 
                                    "rate" : "$linecard-jnh-ifd-stream-increase-rate", 
                                    "time-range" : "300s"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "JNH ifd stream packets ($packets) increasing over threshold ($linecard-jnh-ifd-stream-increase-rate)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "jnh-ifd-stream-packets-not-increasing", 
                            "then" : {
                                "status" : {
                                    "color" : "green"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "fpc-jnh-ifd-stream-increase-rate", 
                        "value" : "1", 
                        "description" : "Linecard JNH IFD Stream Increase Rate Threshold Value", 
                        "type" : "int"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "ACX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "SRX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }, 
                        "helper-files" : [
                        {
                            "file-type" : "other", 
                            "list-of-files" : ["jnh-ifd-stream.yml"]
                        }
                        ]
                    }
                }, 
                {
                    "rule-name" : "check-linecard-ethernet-statistics", 
                    "keys" : ["name", "target"],
                    "synopsis" : "Linecard ethernet statistics kpi", 
                    "description" : "This rule collects linecard ethernet statistics periodically and notifies in case of anomalies", 
                    "sensor" : [
                    {
                        "sensor-name" : "linecard-ethernet-statistics", 
                        "synopsis" : "iAgent sensor definition", 
                        "description" : "Netconf command show devices local iAgent sensor to collect telemetry data from network device", 
                        "iAgent" : {
                            "file" : "linecard-ethernet-statistics.yml", 
                            "table" : "EthernetDevicesStatistics", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "linecard-ethernet-port-errors", 
                        "synopsis" : "Linecard ethernet port error kpi", 
                        "description" : "Sets health based on linecard ethernet port error", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "are-any-errors-increasing", 
                            "when" : {
                                "min-rate-of-increase" : [
                                {
                                    "field-name" : "@all-error-counters", 
                                    "rate" : "1", 
                                    "time-range" : "360s", 
                                    "any" : [null]
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Ethernet port errors incrementing"
                                }
                            }
                        }, 
                        {
                            "term-name" : "no-errors-increasing", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "No ethernet port errors incrementing"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "vector" : [
                    {
                        "vector-name" : "all-error-counters", 
                        "path" : ["$rx_err_allign", "$rx_err_carrier_sense", "$rx_err_code", "$rx_err_ctrl_frames", "$rx_err_drops", "$rx_err_fcs", "$rx_err_frags", "$rx_err_frame_len", "$rx_err_jabbers", "$rx_err_oversize_pkts", "$rx_err_pause_frames", "$rx_err_undersize_pkts", "$rx_err_unkn_opcodes", "$status_err_collisions", "$status_err_eberr", "$status_err_kernel_dropped", "$status_err_rx_babr", "$status_err_rx_bsy", "$status_err_rx_crc_errors", "$status_err_rx_crcerr", "$status_err_rx_errors", "$status_err_rx_frame_errors", "$status_err_rx_large", "$status_err_rx_length_errors", "$status_err_rx_nonoctet", "$status_err_rx_overrun", "$status_err_rx_short", "$status_err_rx_trunc", "$status_err_tx_aborted_errors", "$status_err_tx_babt", "$status_err_tx_timeout", "$status_err_tx_underrun", "$status_err_tx_window_errors", "$status_resets", "$tx_err_ctrl_frames", "$tx_err_deferral_pkts", "$tx_err_drop_frames", "$tx_err_excessive_coll_pkts", "$tx_err_excessive_deferral_pkts", "$tx_err_fcs", "$tx_err_frag_frames", "$tx_err_jabber_frames", "$tx_err_late_coll_pkts", "$tx_err_multiple_coll_pkts", "$tx_err_oversize_frames", "$tx_err_pause_frames", "$tx_err_singel_coll_pkts", "$tx_err_total_coll_pkts", "$tx_err_undersize_frames"]
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "ACX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "SRX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }, 
                        "helper-files" : [
                        {
                            "file-type" : "other", 
                            "list-of-files" : ["linecard-ethernet-statistics.yml"]
                        }
                        ]
                    }
                }, 
                {
                    "rule-name" : "check-pci-error-counters", 
                    "keys" : ["pci-address", "pci-controller-number", "status-type", "target"],
                    "synopsis" : "PCI invalid status analyzer", 
                    "description" : "Monitors the PCI link status", 
                    "sensor" : [
                    {
                        "sensor-name" : "showpcierrorstable", 
                        "synopsis" : "iAgent sensor definition", 
                        "description" : "Netconf command show pci errors iAgent sensor to collect telemetry data from network device", 
                        "iAgent" : {
                            "file" : "pci-error.yml", 
                            "table" : "ShowPciErrorsTable", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "pci-invalid-status", 
                        "synopsis" : "PCI invalid status kpi", 
                        "description" : "Sets health based on PCI invalid status", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-pci-valid-status", 
                            "when" : {
                                "matches-with" : [
                                {
                                    "left-operand" : "$status-type", 
                                    "right-operand" : "Link"
                                }, 
                                {
                                    "left-operand" : "$status", 
                                    "right-operand" : "0x00000001"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "green"
                                }
                            }
                        }, 
                        {
                            "term-name" : "pci-invalid-status", 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "PCI Link status error"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "ACX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "SRX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }, 
                        "helper-files" : [
                        {
                            "file-type" : "other", 
                            "list-of-files" : ["pci-error.yml"]
                        }
                        ]
                    }
                }, 
                {
                    "rule-name" : "check-pfe-traffic-statistics", 
                    "synopsis" : "Linecard drops, discards and ospf hello analyzer", 
                    "description" : "Monitors PFE traffic statistics such as fabric drops, host path hardware drops, info cell discards, OSPF hello counts", 
                    "sensor" : [
                    {
                        "sensor-name" : "pfestats", 
                        "synopsis" : "PFE traffic statistics iAgent sensor definition", 
                        "description" : "Netconf rpc get-pfe-statistics to collect data from network device", 
                        "iAgent" : {
                            "file" : "pfe-traffic-statistics.yml", 
                            "table" : "pfeStats", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "pfe-drop-count-threshold", 
                        "constant" : {
                            "value" : "{{pfe-drop-count-threshold-input}}"
                        }, 
                        "description" : "Linecard PFE drop count threshold"
                    }, 
                    {
                        "field-name" : "pfe-drop-rate-threshold", 
                        "constant" : {
                            "value" : "{{pfe-drop-rate-threshold-input}}"
                        }, 
                        "description" : "Linecard PFE drop rate threshold"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "fabric-drops", 
                        "synopsis" : "Linecard fabric drops kpi", 
                        "description" : "sets system health based on fabric drops", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "are-fabric-drops-increasing", 
                            "when" : {
                                "min-rate-of-increase" : [
                                {
                                    "field-name" : "$fabric-drops", 
                                    "rate" : "$pfe-drop-rate-threshold", 
                                    "time-range" : "300s"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Fabric drops ($fabric-drops) increasing"
                                }
                            }
                        }, 
                        {
                            "term-name" : "are-fabric-drops-over-threshold", 
                            "when" : {
                                "greater-than" : [
                                {
                                    "left-operand" : "$fabric-drops", 
                                    "right-operand" : "$pfe-drop-count-threshold"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "Fabric drops ($fabric-drops) over threshold ($pfe-drop-count-threshold)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "fabric-drops-not-increasing", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "Fabric drops not increasing"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "host-path-hardware-drops", 
                        "synopsis" : "Linecard hardware drops kpi", 
                        "description" : "sets system health based on linecard hardware drops", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "are-host-path-drops-increasing", 
                            "when" : {
                                "min-rate-of-increase" : [
                                {
                                    "field-name" : "$host-path-hardware-drops", 
                                    "rate" : "$pfe-drop-rate-threshold", 
                                    "time-range" : "300s"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Host path hardware input drops ($host-path-hardware-drops) increasing"
                                }
                            }
                        }, 
                        {
                            "term-name" : "are-host-path-drops-over-threshold", 
                            "when" : {
                                "greater-than" : [
                                {
                                    "left-operand" : "$host-path-hardware-drops", 
                                    "right-operand" : "$pfe-drop-count-threshold"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "Host path hardware input drops ($host-path-hardware-drops) over threshold ($pfe-drop-count-threshold)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "host-path-drops-not-increasing", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "Host path hardware input drops not increasing"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "info-cell-discard", 
                        "synopsis" : "Linecard cell discords kpi", 
                        "description" : "sets system health based on linecard cell discards", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "are-info-cell-discards-increasing", 
                            "when" : {
                                "min-rate-of-increase" : [
                                {
                                    "field-name" : "$info-cell-discards", 
                                    "rate" : "$pfe-drop-rate-threshold", 
                                    "time-range" : "300s"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Info cell discards ($info-cell-discards) increasing"
                                }
                            }
                        }, 
                        {
                            "term-name" : "are-info-cell-discards-over-threshold", 
                            "when" : {
                                "greater-than" : [
                                {
                                    "left-operand" : "$info-cell-discards", 
                                    "right-operand" : "$pfe-drop-count-threshold"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "Info cell discards ($info-cell-discards) over threshold ($pfe-drop-count-threshold)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "info-cell-discards-not-increasing", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "Info cell discards not increasing"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "ospf-hello-count", 
                        "synopsis" : "OSPF protocols kpi", 
                        "description" : "sets system health based on ospf hello count", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "are-ospf-hello-counts-increasing", 
                            "when" : {
                                "min-rate-of-increase" : [
                                {
                                    "field-name" : "$ospf-hello-count", 
                                    "rate" : "$pfe-drop-rate-threshold", 
                                    "time-range" : "300s"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "OSPF hello count ($ospf-hello-count) increasing"
                                }
                            }
                        }, 
                        {
                            "term-name" : "are-ospf-hello-counts-not-increasing", 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "OSPF hello count ($ospf-hello-count) not increasing"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "pfe-drop-count-threshold-input", 
                        "value" : "0", 
                        "description" : "PFE Statistics drop counter threshold value", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "pfe-drop-rate-threshold-input", 
                        "value" : "1", 
                        "description" : "PFE Statistics drop counter rate threshold value", 
                        "type" : "int"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "ACX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "11.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "11.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "SRX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }, 
                        "helper-files" : [
                        {
                            "file-type" : "other", 
                            "list-of-files" : ["pfe-traffic-statistics.yml"]
                        }
                        ]
                    }
                }, 
                {
                    "rule-name" : "check-pre-classifier-dropped-packets", 
                    "keys" : ["id", "port", "precl_index", "target"],
                    "synopsis" : "Pre-classifier packer drop analyzer", 
                    "description" : "Monitors the rate of increase of packets dropped by the pre-classifier", 
                    "sensor" : [
                    {
                        "sensor-name" : "preclstatstable", 
                        "synopsis" : "pre-classifier iAgent sensor definition", 
                        "description" : "CLI show precl-eng to collect data from network device", 
                        "iAgent" : {
                            "file" : "pre-classifier.yml", 
                            "table" : "PreClStatsTable", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "linecard-pre-classifier-count-threshold", 
                        "constant" : {
                            "value" : "{{fpc-preclassifier-count-threshold}}"
                        }, 
                        "description" : "Linecard pre-classifier count threshold value"
                    }, 
                    {
                        "field-name" : "linecard-pre-classifier-rate-threshold", 
                        "constant" : {
                            "value" : "{{fpc-preclassifier-rate-threshold}}"
                        }, 
                        "description" : "Linecard pre-classifier rate threshold value"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "pre-classifier-packet-drops", 
                        "synopsis" : "pre-classifier kpi", 
                        "description" : "sets health based on pre-classifier packet drop", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-packet-drop-increasing", 
                            "when" : {
                                "min-rate-of-increase" : [
                                {
                                    "field-name" : "$dropped-packets", 
                                    "rate" : "$linecard-pre-classifier-rate-threshold", 
                                    "time-range" : "300s"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Pre-classifier dropped packets ($dropped-packets) increasing"
                                }
                            }
                        }, 
                        {
                            "term-name" : "is-packet-drop-non-zero", 
                            "when" : {
                                "greater-than" : [
                                {
                                    "left-operand" : "$dropped-packets", 
                                    "right-operand" : "$linecard-pre-classifier-count-threshold"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "Pre-classifier dropped packets counter ($dropped-packets) larger than threshold ($linecard-pre-classifier-count-threshold)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "packet-drops-not-increasing", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "Pre-classifier packet drops not increasing"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "fpc-preclassifier-count-threshold", 
                        "value" : "1", 
                        "description" : "Linecard Pre-Classifier drop count threshold value", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "fpc-preclassifier-rate-threshold", 
                        "value" : "1", 
                        "description" : "Linecard Pre-Classifier drop rate threshold value", 
                        "type" : "int"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "ACX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "SRX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }, 
                        "helper-files" : [
                        {
                            "file-type" : "other", 
                            "list-of-files" : ["pre-classifier.yml"]
                        }
                        ]
                    }
                }, 
                {
                    "rule-name" : "check-traffic-offload-engine-status", 
                    "keys" : ["asic_instance", "asic_type", "pfe_instance", "stream_id", "target", "toe_instance"],
                    "synopsis" : "TOE packets analyzer", 
                    "description" : "Monitors  TOE packets, Asic blocks, Wedge declaration, Wedge window size, Ucode, Hostpath app status", 
                    "sensor" : [
                    {
                        "sensor-name" : "ospf-traffic-offload-engine-status", 
                        "synopsis" : "iAgent sensor description", 
                        "description" : "Netconf command show toe pfe  iAgent sensor to collect telemetry data from network device", 
                        "iAgent" : {
                            "file" : "toe-pfe.yml", 
                            "table" : "ShowToePfeTable", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "toe-hostpath-app-status", 
                        "synopsis" : "TOE host path app status kpi", 
                        "description" : "Sets health based on toe host path app status", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-toe-hostpath-app-running", 
                            "when" : {
                                "matches-with" : [
                                {
                                    "left-operand" : "$toe-driver-host-path-app-running", 
                                    "right-operand" : "true"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "TOE driver host path app is running"
                                }
                            }
                        }, 
                        {
                            "term-name" : "toe-hostpath-app-not-running", 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "TOE driver host path app not running"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "toe-packet-reception", 
                        "synopsis" : "TOE packet reception kpi", 
                        "description" : "Sets health based on TOE packet reception", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "are-toe-packets-received", 
                            "when" : {
                                "matches-with" : [
                                {
                                    "left-operand" : "$toe-packets-received", 
                                    "right-operand" : "true"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "TOE packets are being received"
                                }
                            }
                        }, 
                        {
                            "term-name" : "toe-packets-not-received", 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "TOE packets are NOT being received"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "toe-to-asic-blockage", 
                        "synopsis" : "TOE asic blockage kpi", 
                        "description" : "Sets health based on asic blockage", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-asic-to-not-blocked", 
                            "when" : {
                                "matches-with" : [
                                {
                                    "left-operand" : "$to-asic-not-blocked", 
                                    "right-operand" : "true"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "TOE to-asic is not blocked "
                                }
                            }
                        }, 
                        {
                            "term-name" : "toe-to-asic-blocked", 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "TOE to-asic is blocked"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "toe-ucode-status", 
                        "synopsis" : "TOE ucode status kpi", 
                        "description" : "Sets health based on TOE ucode status", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "has-toe-ucode-not-halted", 
                            "when" : {
                                "matches-with" : [
                                {
                                    "left-operand" : "$toe-ucode-not-halted", 
                                    "right-operand" : "true"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "TOE ucode has not halted"
                                }
                            }
                        }, 
                        {
                            "term-name" : "toe-ucode-halted", 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "TOE ucode has halted"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "toe-wedge-declaration", 
                        "synopsis" : "TOE wedge declaration kpi", 
                        "description" : "Sets health based on TOE wedge declaration", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "has-wedge-not-been-declared", 
                            "when" : {
                                "matches-with" : [
                                {
                                    "left-operand" : "$wedge-not-declared", 
                                    "right-operand" : "true"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "TOE is operating normally with no wedge declared"
                                }
                            }
                        }, 
                        {
                            "term-name" : "toe-wedge-declared", 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "TOE wedge declared."
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "wedge-window-size", 
                        "synopsis" : "TOE wedge window size kpi", 
                        "description" : "Sets health based on TOE wedge window size", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-wedge-window-size-0", 
                            "when" : {
                                "matches-with" : [
                                {
                                    "left-operand" : "$wedge-window-size-0", 
                                    "right-operand" : "true"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "TOE wedge window size is 0"
                                }
                            }
                        }, 
                        {
                            "term-name" : "wedge-window-size-not-0", 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "TOE wedge is suspected"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "ACX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "SRX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }, 
                        "helper-files" : [
                        {
                            "file-type" : "other", 
                            "list-of-files" : ["toe-pfe.yml"]
                        }
                        ]
                    }
                }, 
                {
                    "rule-name" : "sync-ospf-fpc", 
                    "synopsis" : "ospf session state analyzer", 
                    "description" : "This rule collects ospf statistics periodically and notifies in case of anomalies;", 
                    "sensor" : [
                    {
                        "sensor-name" : "sync-ospf", 
                        "synopsis" : "ospf iAgent sensor definition", 
                        "description" : "Netconf command iAgent sensor to collect telemetry data from network device;", 
                        "iAgent" : {
                            "file" : "sync-ospf-fpc.yml", 
                            "table" : "SyncOspfFpc", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "ACX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "SRX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }, 
                        "helper-files" : [
                        {
                            "file-type" : "other", 
                            "list-of-files" : ["sync-ospf-fpc.yml"]
                        }
                        ]
                    }
                }, 
                {
                    "rule-name" : "update-online-fpc", 
                    "synopsis" : "collects online fpc using udf and updates dependent rules sensor table", 
                    "description" : "collects online fpc using udf and updates dependent rules sensor table", 
                    "sensor" : [
                    {
                        "sensor-name" : "online-fpc", 
                        "iAgent" : {
                            "file" : "online_fpc.yml", 
                            "table" : "UpdateTable", 
                            "frequency" : "1m"
                        }
                    }
                    ]
                }
                ]
            }, 
            {
                "topic-name" : "protocol.bgp", 
                "description" : "Detects ipv4 and ipv6 bgp route hijacks", 
                "synopsis" : "Bgp route hijack detector", 
                "rule" : [
                {
                    "rule-name" : "check-bgp-advertised-routes", 
                    "keys" : ["address-table", "neighbor-address"],
                    "synopsis" : "BGP advertised routes analyzer", 
                    "description" : "Collects BGP session advertised routes count periodically and notifies anomaly when advertised route count exceed threshold", 
                    "sensor" : [
                    {
                        "sensor-name" : "bgp-sensor", 
                        "synopsis" : "BGP open-config sensor definition", 
                        "description" : "/protocol/bgp open-config sensor to collect telemetry data from network device", 
                        "open-config" : {
                            "sensor-name" : "/network-instances/network-instance/protocols/protocol/bgp/neighbors", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "address-table", 
                        "sensor" : [
                        {
                            "sensor-name" : "bgp-sensor", 
                            "where" : [
                            {
                                "query" : "/network-instances/network-instance/protocols/protocol/bgp/neighbors/neighbor/afi-safis/afi-safi/@afi-safi-name =~ /{{addr-table}}/"
                            }
                            ], 
                            "path" : "/network-instances/network-instance/protocols/protocol/bgp/neighbors/neighbor/afi-safis/afi-safi/@afi-safi-name"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "Address-table to find table specific prefixes"
                    }, 
                    {
                        "field-name" : "advertised-route-count-threshold", 
                        "constant" : {
                            "value" : "{{max-advertised-route-count-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "Advertised routes count increase threshold"
                    }, 
                    {
                        "field-name" : "advertised-routes", 
                        "sensor" : [
                        {
                            "sensor-name" : "bgp-sensor", 
                            "path" : "/network-instances/network-instance/protocols/protocol/bgp/neighbors/neighbor/afi-safis/afi-safi/state/prefixes/sent"
                        }
                        ], 
                        "type" : "integer", 
                        "description" : "Number of advertised routes"
                    }, 
                    {
                        "field-name" : "advertised-routes-dynamic-threshold", 
                        "formula" : {
                            "dynamic-threshold" : {
                                "algorithm" : "k-means", 
                                "learning-period" : "7d", 
                                "pattern-periodicity" : "1h", 
                                "field-name" : "$advertised-routes"
                            }
                        }, 
                        "type" : "integer", 
                        "description" : "Dynamically sets threshold using kmeans algorithm"
                    }, 
                    {
                        "field-name" : "instance-name", 
                        "sensor" : [
                        {
                            "sensor-name" : "bgp-sensor", 
                            "where" : [
                            {
                                "query" : "/network-instances/network-instance/@instance-name =~ /{{routing-instance}}/"
                            }
                            ], 
                            "path" : "/network-instances/network-instance/@instance-name"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "Routing instance to find neighbor's parent instance"
                    }, 
                    {
                        "field-name" : "neighbor-address", 
                        "sensor" : [
                        {
                            "sensor-name" : "bgp-sensor", 
                            "where" : [
                            {
                                "query" : "/network-instances/network-instance/protocols/protocol/bgp/neighbors/neighbor/@neighbor-address =~ /{{neighbors}}/"
                            }
                            ], 
                            "path" : "/network-instances/network-instance/protocols/protocol/bgp/neighbors/neighbor/@neighbor-address"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "BGP neighbor addresses to monitor"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "advertised-routes", 
                        "synopsis" : "BGP max advertised routes KPI", 
                        "description" : "Sets health based on increase in advertised routes on neighbor session", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "above-static-threshold", 
                            "when" : {
                                "greater-than-or-equal-to" : [
                                {
                                    "left-operand" : "$advertised-routes", 
                                    "right-operand" : "$advertised-route-count-threshold"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Advertised route count($advertised-routes) exceed static threshold"
                                }
                            }
                        }, 
                        {
                            "term-name" : "above-dynamic-threshold", 
                            "when" : {
                                "equal-to" : [
                                {
                                    "left-operand" : "$advertised-routes-dynamic-threshold", 
                                    "right-operand" : "1", 
                                    "time-range" : "5m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "Advertised route count($advertised-routes) exceed dynamic threshold"
                                }
                            }
                        }, 
                        {
                            "term-name" : "route-count-normal", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "Advertised route count($advertised-routes) is normal"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "addr-table", 
                        "value" : ".+", 
                        "description" : "Address table specific routes, regular expression, e.g. 'IPV4_UNICAST'", 
                        "type" : "string"
                    }, 
                    {
                        "name" : "max-advertised-route-count-threshold", 
                        "value" : "10000", 
                        "description" : "BGP neighbor session advertised routes threshold: Number of advertised route count increase between metrics, before we report anomaly", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "neighbors", 
                        "value" : ".*", 
                        "description" : "BGP neighbor addresses to monitor, regular expression, e.g. '172.16.*'", 
                        "type" : "string"
                    }, 
                    {
                        "name" : "routing-instance", 
                        "value" : ".*", 
                        "description" : "Routing instance specific neighbors, regular expression, e.g. 'master'", 
                        "type" : "string"
                    }
                    ]
                }, 
                {
                    "rule-name" : "check-bgp-neighbor-flaps", 
                    "keys" : ["neighbor-address"],
                    "synopsis" : "BGP neighbor flaps detector", 
                    "description" : "Collects BGP session carrier-transitions count periodically and notify anomalies when flap count increases", 
                    "sensor" : [
                    {
                        "sensor-name" : "bgp-sensor", 
                        "synopsis" : "BGP open-config sensor definition", 
                        "description" : "/protocol/bgp open-config sensor to collect telemetry data from network device", 
                        "open-config" : {
                            "sensor-name" : "/network-instances/network-instance/protocols/protocol/bgp/", 
                            "frequency" : "30s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "established-transitions", 
                        "sensor" : [
                        {
                            "sensor-name" : "bgp-sensor", 
                            "path" : "/network-instances/network-instance/protocols/protocol/bgp/neighbors/neighbor/state/established-transitions"
                        }
                        ], 
                        "type" : "integer", 
                        "description" : "Number of neighbor session flaps"
                    }, 
                    {
                        "field-name" : "flap-count-threshold", 
                        "constant" : {
                            "value" : "{{flaps-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "Flap count increase threshold"
                    }, 
                    {
                        "field-name" : "last-established", 
                        "sensor" : [
                        {
                            "sensor-name" : "bgp-sensor", 
                            "path" : "/network-instances/network-instance/protocols/protocol/bgp/neighbors/neighbor/state/last-established"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "BGP session last established time"
                    }, 
                    {
                        "field-name" : "neighbor-address", 
                        "sensor" : [
                        {
                            "sensor-name" : "bgp-sensor", 
                            "where" : [
                            {
                                "query" : "/network-instances/network-instance/protocols/protocol/bgp/neighbors/neighbor/@neighbor-address =~ /{{neighbors}}/"
                            }
                            ], 
                            "path" : "/network-instances/network-instance/protocols/protocol/bgp/neighbors/neighbor/@neighbor-address"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "BGP neighbor addresses to monitor"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "neigbor-flap", 
                        "synopsis" : "BGP neighbor session flaps KPI", 
                        "description" : "Sets health based on increase in bgp neighbor session flaps", 
                        "frequency" : "30s", 
                        "term" : [
                        {
                            "term-name" : "is-session-flapping", 
                            "when" : {
                                "min-rate-of-increase" : [
                                {
                                    "field-name" : "$established-transitions", 
                                    "rate" : "$flap-count-threshold", 
                                    "time-range" : "60s"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Neighbor session flapping, last-established:$last-established"
                                }
                            }
                        }, 
                        {
                            "term-name" : "is-session-inconsistent", 
                            "when" : {
                                "min-rate-of-increase" : [
                                {
                                    "field-name" : "$established-transitions", 
                                    "rate" : "$flap-count-threshold"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "Neighbor session inconsistent, last-established:$last-established"
                                }
                            }
                        }, 
                        {
                            "term-name" : "is-session-stable", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "Neighbor session stable, last-established:$last-established"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "flaps-threshold", 
                        "value" : "1", 
                        "description" : "BGP neighbor session flaps threshold: Number of flap increase between metrics, before we report anomaly", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "neighbors", 
                        "value" : ".*", 
                        "description" : "BGP neighbor addresses to monitor, regular expression, e.g. '172.16.*'", 
                        "type" : "string"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX9200"]
                                        }, 
                                        {
                                            "release-name" : "18.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX4650"]
                                        }, 
                                        {
                                            "release-name" : "18.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX4600"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["MX2010", "MX2020", "MX240", "MX480", "MX960"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["PTX1000", "PTX10000", "PTX5000"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX10000", "QFX5200"]
                                        }, 
                                        {
                                            "release-name" : "17.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX5110"]
                                        }, 
                                        {
                                            "release-name" : "18.1R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX5100"]
                                        }, 
                                        {
                                            "release-name" : "18.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX5120-48Y"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }, 
                            "other-vendor" : [
                            {
                                "vendor-identifier" : "cisco-IOS-XR", 
                                "vendor-name" : "cisco", 
                                "operating-system" : "IOS-XR"
                            }
                            ]
                        }
                    }
                }, 
                {
                    "rule-name" : "check-bgp-received-routes", 
                    "keys" : ["address-table", "neighbor-address"],
                    "synopsis" : "BGP received routes analyzer", 
                    "description" : "Collects BGP session received routes count periodically and notifies anomaly when received route count exceed threshold", 
                    "sensor" : [
                    {
                        "sensor-name" : "bgp-sensor", 
                        "synopsis" : "BGP open-config sensor definition", 
                        "description" : "/protocol/bgp open-config sensor to collect telemetry data from network device", 
                        "open-config" : {
                            "sensor-name" : "/network-instances/network-instance/protocols/protocol/bgp/neighbors", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "address-table", 
                        "sensor" : [
                        {
                            "sensor-name" : "bgp-sensor", 
                            "where" : [
                            {
                                "query" : "/network-instances/network-instance/protocols/protocol/bgp/neighbors/neighbor/afi-safis/afi-safi/@afi-safi-name =~ /{{addr-table}}/"
                            }
                            ], 
                            "path" : "/network-instances/network-instance/protocols/protocol/bgp/neighbors/neighbor/afi-safis/afi-safi/@afi-safi-name"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "Address-table to find table specific prefixes"
                    }, 
                    {
                        "field-name" : "instance-name", 
                        "sensor" : [
                        {
                            "sensor-name" : "bgp-sensor", 
                            "where" : [
                            {
                                "query" : "/network-instances/network-instance/@instance-name =~ /{{routing-instance}}/"
                            }
                            ], 
                            "path" : "/network-instances/network-instance/@instance-name"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "Routing instance to find neighbor's parent instance"
                    }, 
                    {
                        "field-name" : "neighbor-address", 
                        "sensor" : [
                        {
                            "sensor-name" : "bgp-sensor", 
                            "where" : [
                            {
                                "query" : "/network-instances/network-instance/protocols/protocol/bgp/neighbors/neighbor/@neighbor-address =~ /{{neighbors}}/"
                            }
                            ], 
                            "path" : "/network-instances/network-instance/protocols/protocol/bgp/neighbors/neighbor/@neighbor-address"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "BGP neighbor addresses to monitor"
                    }, 
                    {
                        "field-name" : "received-route-count-threshold", 
                        "constant" : {
                            "value" : "{{max-received-route-count-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "Received routes count increase threshold"
                    }, 
                    {
                        "field-name" : "received-routes", 
                        "sensor" : [
                        {
                            "sensor-name" : "bgp-sensor", 
                            "path" : "/network-instances/network-instance/protocols/protocol/bgp/neighbors/neighbor/afi-safis/afi-safi/state/prefixes/received"
                        }
                        ], 
                        "type" : "integer", 
                        "description" : "Number of received routes"
                    }, 
                    {
                        "field-name" : "received-routes-dynamic-threshold", 
                        "formula" : {
                            "dynamic-threshold" : {
                                "algorithm" : "k-means", 
                                "learning-period" : "7d", 
                                "pattern-periodicity" : "1h", 
                                "field-name" : "$received-routes"
                            }
                        }, 
                        "type" : "integer", 
                        "description" : "Dynamically sets threshold using kmeans algorithm"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "received-routes", 
                        "synopsis" : "BGP max received routes KPI", 
                        "description" : "Sets health based on increase in received routes on neighbor session", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "above-static-threshold", 
                            "when" : {
                                "greater-than-or-equal-to" : [
                                {
                                    "left-operand" : "$received-routes", 
                                    "right-operand" : "$received-route-count-threshold"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Received route count($received-routes) exceed static threshold"
                                }
                            }
                        }, 
                        {
                            "term-name" : "above-dynamic-threshold", 
                            "when" : {
                                "equal-to" : [
                                {
                                    "left-operand" : "$received-routes-dynamic-threshold", 
                                    "right-operand" : "1", 
                                    "time-range" : "5m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "Received route count($received-routes) exceed dynamic threshold"
                                }
                            }
                        }, 
                        {
                            "term-name" : "route-count-normal", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "Received route count($received-routes) is normal"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "addr-table", 
                        "value" : ".+", 
                        "description" : "Address table specific routes, regular expression, e.g. 'IPV4_UNICAST'", 
                        "type" : "string"
                    }, 
                    {
                        "name" : "max-received-route-count-threshold", 
                        "value" : "10000", 
                        "description" : "BGP neighbor session received routes threshold: Number of received route count increase between metrics, before we report anomaly", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "neighbors", 
                        "value" : ".*", 
                        "description" : "BGP neighbor addresses to monitor, regular expression, e.g. '172.16.*'", 
                        "type" : "string"
                    }, 
                    {
                        "name" : "routing-instance", 
                        "value" : ".*", 
                        "description" : "Routing instance specific neighbors, regular expression, e.g. 'master'", 
                        "type" : "string"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX9200"]
                                        }, 
                                        {
                                            "release-name" : "18.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX4650"]
                                        }, 
                                        {
                                            "release-name" : "18.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX4600"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["MX2010", "MX2020", "MX240", "MX480", "MX960"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["PTX1000", "PTX10000", "PTX5000"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX10000", "QFX5200"]
                                        }, 
                                        {
                                            "release-name" : "17.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX5110"]
                                        }, 
                                        {
                                            "release-name" : "18.1R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX5100"]
                                        }, 
                                        {
                                            "release-name" : "18.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX5120-48Y"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }, 
                            "other-vendor" : [
                            {
                                "vendor-identifier" : "cisco-IOS-XR", 
                                "vendor-name" : "cisco", 
                                "operating-system" : "IOS-XR"
                            }
                            ]
                        }
                    }
                }, 
                {
                    "rule-name" : "check-bgp-session-state", 
                    "keys" : ["neighbor-address"],
                    "synopsis" : "BGP session state analyzer", 
                    "description" : "Collects BGP session state periodically and notify anomalies when neighbor session down", 
                    "sensor" : [
                    {
                        "sensor-name" : "bgp-sensor", 
                        "synopsis" : "BGP open-config sensor definition", 
                        "description" : "/protocol/bgp open-config sensor to collect telemetry data from network device", 
                        "open-config" : {
                            "sensor-name" : "/network-instances/network-instance/protocols/protocol/bgp/neighbors", 
                            "frequency" : "30s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "neighbor-address", 
                        "sensor" : [
                        {
                            "sensor-name" : "bgp-sensor", 
                            "where" : [
                            {
                                "query" : "/network-instances/network-instance/protocols/protocol/bgp/neighbors/neighbor/@neighbor-address =~ /{{neighbors}}/"
                            }
                            ], 
                            "path" : "/network-instances/network-instance/protocols/protocol/bgp/neighbors/neighbor/@neighbor-address"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "BGP neighbor addresses to monitor"
                    }, 
                    {
                        "field-name" : "session-state", 
                        "sensor" : [
                        {
                            "sensor-name" : "bgp-sensor", 
                            "path" : "/network-instances/network-instance/protocols/protocol/bgp/neighbors/neighbor/state/session-state"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "BGP session status"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "neigbor-state", 
                        "synopsis" : "BGP session state KPI", 
                        "description" : "Sets health based on change in BGP neighbor session state", 
                        "frequency" : "30s", 
                        "term" : [
                        {
                            "term-name" : "is-neighbor-up", 
                            "when" : {
                                "matches-with" : [
                                {
                                    "left-operand" : "$session-state", 
                                    "right-operand" : "ESTABLISHED"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "Neighbor($neighbor-address) session up"
                                }
                            }
                        }, 
                        {
                            "term-name" : "neighbor-down", 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Neighbor($neighbor-address) session down"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "neighbors", 
                        "value" : ".*", 
                        "description" : "BGP neighbor addresses to monitor, regular expression, e.g. '172.16.*'", 
                        "type" : "string"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX9200"]
                                        }, 
                                        {
                                            "release-name" : "18.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX4650"]
                                        }, 
                                        {
                                            "release-name" : "18.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX4600"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["MX2010", "MX2020", "MX240", "MX480", "MX960"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["PTX1000", "PTX10000", "PTX5000"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX10000", "QFX5200"]
                                        }, 
                                        {
                                            "release-name" : "17.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX5110"]
                                        }, 
                                        {
                                            "release-name" : "18.1R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX5100"]
                                        }, 
                                        {
                                            "release-name" : "18.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX5120-48Y"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }, 
                            "other-vendor" : [
                            {
                                "vendor-identifier" : "cisco-IOS-XR", 
                                "vendor-name" : "cisco", 
                                "operating-system" : "IOS-XR"
                            }
                            ]
                        }
                    }
                }, 
                {
                    "rule-name" : "check-route-hijacking-v4", 
                    "keys" : ["prefix"],
                    "synopsis" : "IPv4 bgp route hijack detector", 
                    "description" : "Checks bgp ipv4 route hijack", 
                    "sensor" : [
                    {
                        "sensor-name" : "bgp-v4", 
                        "synopsis" : "BGP openconfig sensor", 
                        "description" : "Sensor configuration to get bgp data from network devices", 
                        "open-config" : {
                            "sensor-name" : "/bgp-rib/afi-safis/afi-safi/ipv4-unicast/loc-rib/", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "as-path", 
                        "sensor" : [
                        {
                            "sensor-name" : "bgp-v4", 
                            "path" : "/bgp-rib/afi-safis/afi-safi/ipv4-unicast/loc-rib/routes/route/attributes/as-path"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "As-path information"
                    }, 
                    {
                        "field-name" : "as-path-expr", 
                        "constant" : {
                            "value" : "{{ipv4-as-path}}"
                        }, 
                        "type" : "string", 
                        "description" : "As-path-expression to match and compare"
                    }, 
                    {
                        "field-name" : "community", 
                        "sensor" : [
                        {
                            "sensor-name" : "bgp-v4", 
                            "path" : "/bgp-rib/afi-safis/afi-safi/ipv4-unicast/loc-rib/routes/route/attributes/community"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "Route BGP community information"
                    }, 
                    {
                        "field-name" : "community-expr", 
                        "constant" : {
                            "value" : "{{ipv4-community}}"
                        }, 
                        "type" : "string", 
                        "description" : "community-expression to match and compare"
                    }, 
                    {
                        "field-name" : "prefix", 
                        "sensor" : [
                        {
                            "sensor-name" : "bgp-v4", 
                            "path" : "/bgp-rib/afi-safis/afi-safi/ipv4-unicast/loc-rib/routes/route/prefix"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "IPv4 route prefix information"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "route-hijacking", 
                        "synopsis" : "BGP IPv4 route hijack KPI", 
                        "description" : "Sets health based on the expected as-path and community information of received routes", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "hijacking-v4", 
                            "when" : {
                                "does-not-match-with" : [
                                {
                                    "left-operand" : "$as-path", 
                                    "right-operand" : "$as-path-expr"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Detected route hijacking"
                                }
                            }
                        }, 
                        {
                            "term-name" : "more-specific-route-v4", 
                            "when" : {
                                "matches-with" : [
                                {
                                    "left-operand" : "$community", 
                                    "right-operand" : "$community-expr"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "Seen more specific routes"
                                }
                            }
                        }, 
                        {
                            "term-name" : "normal", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "All well"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "ipv4-as-path", 
                        "value" : "[null]", 
                        "description" : "Enter ipv4 as-path that is expected, e.g. 6451[23]$", 
                        "type" : "string"
                    }, 
                    {
                        "name" : "ipv4-community", 
                        "value" : "[null]", 
                        "description" : "Enter community that is expected, e.g ^64512:9999$", 
                        "type" : "string"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX9200"]
                                        }, 
                                        {
                                            "release-name" : "18.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX4650"]
                                        }, 
                                        {
                                            "release-name" : "18.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX4600"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["MX2010", "MX2020", "MX240", "MX480", "MX960"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["PTX1000", "PTX10000", "PTX5000"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX10000", "QFX5200"]
                                        }, 
                                        {
                                            "release-name" : "17.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX5110"]
                                        }, 
                                        {
                                            "release-name" : "18.1R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX5100"]
                                        }, 
                                        {
                                            "release-name" : "18.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX5120-48Y"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }, 
                            "other-vendor" : [
                            {
                                "vendor-identifier" : "cisco-IOS-XR", 
                                "vendor-name" : "cisco", 
                                "operating-system" : "IOS-XR"
                            }
                            ]
                        }
                    }
                }, 
                {
                    "rule-name" : "check-route-hijacking-v6", 
                    "keys" : ["prefix"],
                    "synopsis" : "IPv4 bgp route hijack detector", 
                    "description" : "Checks bgp ipv6 route hijacks", 
                    "sensor" : [
                    {
                        "sensor-name" : "bgp-v6", 
                        "synopsis" : "BGP openconfig sensor", 
                        "description" : "Sensor configuration to get bgp data from network devices", 
                        "open-config" : {
                            "sensor-name" : "/bgp-rib/afi-safis/afi-safi/ipv6-unicast/loc-rib/", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "as-path", 
                        "sensor" : [
                        {
                            "sensor-name" : "bgp-v6", 
                            "path" : "/bgp-rib/afi-safis/afi-safi/ipv6-unicast/loc-rib/routes/route/attributes/as-path"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "As-path information"
                    }, 
                    {
                        "field-name" : "as-path-expr", 
                        "constant" : {
                            "value" : "{{ipv6-as-path}}"
                        }, 
                        "type" : "string", 
                        "description" : "As-path-expression to match and compare"
                    }, 
                    {
                        "field-name" : "community", 
                        "sensor" : [
                        {
                            "sensor-name" : "bgp-v6", 
                            "path" : "/bgp-rib/afi-safis/afi-safi/ipv6-unicast/loc-rib/routes/route/attributes/community"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "Route BGP community information"
                    }, 
                    {
                        "field-name" : "community-expr", 
                        "constant" : {
                            "value" : "{{ipv6-community}}"
                        }, 
                        "type" : "string", 
                        "description" : "community-expression to match and compare"
                    }, 
                    {
                        "field-name" : "prefix", 
                        "sensor" : [
                        {
                            "sensor-name" : "bgp-v6", 
                            "path" : "/bgp-rib/afi-safis/afi-safi/ipv6-unicast/loc-rib/routes/route/prefix"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "IPv6 route prefix information"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "route-hijacking", 
                        "synopsis" : "BGP IPv6 route hijack KPI", 
                        "description" : "Sets health based on the expected as-path and community information of received routes", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "hijacking", 
                            "when" : {
                                "does-not-match-with" : [
                                {
                                    "left-operand" : "$as-path", 
                                    "right-operand" : "$as-path-expr"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Detected route hijacking"
                                }
                            }
                        }, 
                        {
                            "term-name" : "more-specific-route-v6", 
                            "when" : {
                                "matches-with" : [
                                {
                                    "left-operand" : "$community", 
                                    "right-operand" : "$community-expr"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "Seen more specific v6 routes"
                                }
                            }
                        }, 
                        {
                            "term-name" : "normal", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "All well"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "ipv6-as-path", 
                        "value" : "[null]", 
                        "description" : "Enter ipv4 as-path that is expected, e.g. 6451[23]$", 
                        "type" : "string"
                    }, 
                    {
                        "name" : "ipv6-community", 
                        "value" : "[null]", 
                        "description" : "Enter community that is expected, e.g ^64512:9999$", 
                        "type" : "string"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX9200"]
                                        }, 
                                        {
                                            "release-name" : "18.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX4650"]
                                        }, 
                                        {
                                            "release-name" : "18.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX4600"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["MX2010", "MX2020", "MX240", "MX480", "MX960"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["PTX1000", "PTX10000", "PTX5000"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX10000", "QFX5200"]
                                        }, 
                                        {
                                            "release-name" : "17.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX5110"]
                                        }, 
                                        {
                                            "release-name" : "18.1R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX5100"]
                                        }, 
                                        {
                                            "release-name" : "18.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX5120-48Y"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }, 
                            "other-vendor" : [
                            {
                                "vendor-identifier" : "cisco-IOS-XR", 
                                "vendor-name" : "cisco", 
                                "operating-system" : "IOS-XR"
                            }
                            ]
                        }
                    }
                }
                ]
            }, 
            {
                "topic-name" : "protocol.icmp", 
                "description" : "Sends ICMP probes to destination host and notify anomalies", 
                "synopsis" : "ICMP response analyzer", 
                "rule" : [
                {
                    "rule-name" : "check-icmp-statistics", 
                    "keys" : ["host"],
                    "function" : [
                    {
                        "function-name" : "micro-milli", 
                        "description" : "This function converts microseconds to milliseconds", 
                        "path" : "micro_milli.py", 
                        "method" : "rtt_micro_milli", 
                        "argument" : [
                        {
                            "argument-name" : "micros", 
                            "mandatory" : [null]
                        }
                        ]
                    }
                    ], 
                    "sensor" : [
                    {
                        "sensor-name" : "icmp", 
                        "synopsis" : "iAgent sensor definition", 
                        "description" : "Ping rpc to collect data from network device", 
                        "iAgent" : {
                            "file" : "icmp_statistics.yml", 
                            "table" : "pingTable", 
                            "frequency" : "60s", 
                            "args" : [
                            {
                                "arg-name" : "count", 
                                "arg-value" : "{{count-var}}"
                            }, 
                            {
                                "arg-name" : "host", 
                                "arg-value" : "{{host-var}}"
                            }
                            ]
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "dt-response-time", 
                        "formula" : {
                            "dynamic-threshold" : {
                                "algorithm" : "k-means", 
                                "learning-period" : "7d", 
                                "pattern-periodicity" : "1h", 
                                "field-name" : "$rtt-average-ms"
                            }
                        }, 
                        "type" : "integer", 
                        "description" : "Dynamic threshold for field rtt-average-ms"
                    }, 
                    {
                        "field-name" : "rtt-average-ms", 
                        "formula" : {
                            "user-defined-function" : {
                                "function-name" : "micro-milli", 
                                "argument" : [
                                {
                                    "argument" : "micros", 
                                    "value" : "$rtt-average"
                                }
                                ]
                            }
                        }, 
                        "type" : "float", 
                        "description" : "Round trip time"
                    }, 
                    {
                        "field-name" : "rtt-threshold", 
                        "constant" : {
                            "value" : "{{rtt-threshold-var}}"
                        }, 
                        "type" : "string", 
                        "description" : "RTT response time static threshold"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "packet-loss", 
                        "synopsis" : "ICMP packet loss KPI", 
                        "description" : "Sets health based on the packet loss", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-device-not-reachable", 
                            "when" : {
                                "equal-to" : [
                                {
                                    "left-operand" : "$packet-loss", 
                                    "right-operand" : "100", 
                                    "time-range" : "2m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Host $host not reachable"
                                }
                            }
                        }, 
                        {
                            "term-name" : "is-device-up", 
                            "when" : {
                                "greater-than" : [
                                {
                                    "left-operand" : "$packet-loss", 
                                    "right-operand" : "0", 
                                    "time-range" : "2m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "Host $host reachable and  $packet-loss % packet loss"
                                }
                            }
                        }, 
                        {
                            "term-name" : "no-packet-loss", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "Host $host reachable and  $packet-loss % packet loss"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "round-trip-time", 
                        "synopsis" : "Round trip time KPI", 
                        "description" : "Sets health based on the RTT", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-rtt-fine", 
                            "when" : {
                                "greater-than-or-equal-to" : [
                                {
                                    "left-operand" : "$rtt-average-ms", 
                                    "right-operand" : "$rtt-threshold"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Round trip time($rtt-average-ms ms) to $host is above static threshold"
                                }
                            }
                        }, 
                        {
                            "term-name" : "is-rtt-medium", 
                            "when" : {
                                "equal-to" : [
                                {
                                    "left-operand" : "$dt-response-time", 
                                    "right-operand" : "1"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "Round trip time($rtt-average-ms ms) to $host is above dynamic threshold"
                                }
                            }
                        }, 
                        {
                            "term-name" : "rtt-normal", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "Round trip time($rtt-average-ms ms) to $host is normal"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "count-var", 
                        "value" : "1", 
                        "description" : "Input ICMP probe count", 
                        "type" : "sensor-argument"
                    }, 
                    {
                        "name" : "host-var", 
                        "description" : "Input Destination host", 
                        "type" : "sensor-argument"
                    }, 
                    {
                        "name" : "rtt-threshold-var", 
                        "value" : "1", 
                        "description" : "Input RTT response static threshold in milli seconds", 
                        "type" : "int"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 1, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "2.0.0", 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "11.4", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }
                    }
                }, 
                {
                    "rule-name" : "check-outlier", 
                    "synopsis" : "ICMP outlier analyzer", 
                    "description" : "Detects ICMP outlier response time and notify anomalies", 
                    "rule-frequency" : "60s", 
                    "network-rule" : [null], 
                    "field" : [
                    {
                        "field-name" : "rtt-ol", 
                        "formula" : {
                            "outlier-detection" : {
                                "algorithm" : {
                                    "dbscan" : {
                                        "sensitivity" : {
                                            "level" : "low"
                                        }, 
                                        "learning-period" : "30m"
                                    }
                                }, 
                                "dataset" : "{{rtt-xpath}}"
                            }
                        }, 
                        "type" : "string", 
                        "description" : "Outlier detection of devices in a group using xpath"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "icmp-outlier-detection", 
                        "synopsis" : "ICMP outlier KPI", 
                        "description" : "Sets health based on the RTT average response time across devices", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-outlier-detected", 
                            "when" : {
                                "equal-to" : [
                                {
                                    "left-operand" : "$rtt-ol-is-outlier", 
                                    "right-operand" : "1"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Outlier detected on $rtt-ol-device"
                                }
                            }
                        }, 
                        {
                            "term-name" : "no-outlier", 
                            "when" : {
                                "equal-to" : [
                                {
                                    "left-operand" : "$rtt-ol-is-outlier", 
                                    "right-operand" : "0"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "No outlier detected on $rtt-ol-device"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "rtt-xpath", 
                        "value" : ".*", 
                        "description" : "Input xpath of devices to be in outlier detection format e.g. /device-group[device-group-name=core]/device[device-id=R0]/topic[topic-name=protocol.icmp]/rule[rule-name=check-icmp-statistics]/rtt-average-ms,/device-group[device-group-name=core]/device[device-id=R1]/topic[topic-name=protocol.icmp]/rule[rule-name=check-icmp-statistics]/rtt-average-ms,/device-group[device-group-name=core]/device[device-id=R2]/topic[topic-name=protocol.icmp]/rule[rule-name=check-icmp-statistics]/rtt-average-ms", 
                        "type" : "string"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 1, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "2.0.0", 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "11.4", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }
                    }
                }
                ]
            }, 
            {
                "topic-name" : "protocol.infra", 
                "description" : "Rules relevant to protocol daemon infrastructure", 
                "synopsis" : "Task memory statistics analyzer", 
                "rule" : [
                {
                    "rule-name" : "check-task-io-drops", 
                    "keys" : ["task-name"],
                    "synopsis" : "Task I/O statistics analyzer", 
                    "description" : "Monitors the task IO drops", 
                    "sensor" : [
                    {
                        "sensor-name" : "task-io-drops", 
                        "synopsis" : "show task io sensor definition", 
                        "description" : "Netconfig command show task io iAgent sensor to collect telemetry data from network device", 
                        "iAgent" : {
                            "file" : "task-io.yml", 
                            "table" : "TaskIOTable", 
                            "frequency" : "10s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "io-drops-threshold", 
                        "constant" : {
                            "value" : "{{io-drops-hreshold}}"
                        }, 
                        "description" : "This field is for IO drops threshold"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "task-io-drops", 
                        "synopsis" : "task io drops kpi", 
                        "description" : "Sets health based on task ip drops threshold value", 
                        "term" : [
                        {
                            "term-name" : "are-task-io-drops-increasing", 
                            "when" : {
                                "min-rate-of-increase" : [
                                {
                                    "field-name" : "$dropped", 
                                    "rate" : "$io-drops-threshold", 
                                    "time-range" : "50s"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Task IO drops ($dropped) increasing"
                                }
                            }
                        }, 
                        {
                            "term-name" : "are-task-io-drops-non-zero", 
                            "when" : {
                                "greater-than" : [
                                {
                                    "left-operand" : "$dropped", 
                                    "right-operand" : "0"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "Task IO drops ($dropped) non-zero"
                                }
                            }
                        }, 
                        {
                            "term-name" : "task-io-drops-not-increasing", 
                            "then" : {
                                "status" : {
                                    "color" : "green"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "io-drops-hreshold", 
                        "value" : "1", 
                        "description" : "RPD Task Memory threshold value", 
                        "type" : "int"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "ACX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "11.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "11.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "SRX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }, 
                        "helper-files" : [
                        {
                            "file-type" : "other", 
                            "list-of-files" : ["task-io.yml"]
                        }
                        ]
                    }
                }, 
                {
                    "rule-name" : "check-task-memory-usage", 
                    "keys" : ["task-memory-overall-report"],
                    "synopsis" : "task memory in use analyzer", 
                    "description" : "This rule collects task memory in use count periodically and notifies in case of anomalies", 
                    "sensor" : [
                    {
                        "sensor-name" : "task-memory-usage", 
                        "synopsis" : "rpc get-task-memory-information iAgent sensor definition", 
                        "description" : "Netconfig rpc get-task-memory-information iAgent sensor to collect telemetry data from network device", 
                        "iAgent" : {
                            "file" : "task-memory.yml", 
                            "table" : "taskMemory", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "configured-threshold", 
                        "constant" : {
                            "value" : "{{memory-threshold}}"
                        }, 
                        "description" : "This field is for task memory threshold"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "percentage-of-task-memory-in-use", 
                        "synopsis" : "Task memory in use kpi", 
                        "description" : "Sets health based on task memory in use", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-task-memory-in-use-above-threshold", 
                            "when" : {
                                "greater-than-or-equal-to" : [
                                {
                                    "left-operand" : "$in-use-percent", 
                                    "right-operand" : "memory-threshold"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Routing Protocol Daemon in use task memory ($in-use-percent) greater than configured threshold($configured-threshold)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "task-memory-in-use-normal", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "Routing Protocol Daemon in user task memory ($in-use-percent) lower than configured threshold($configured-threshold)"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "memory-threshold", 
                        "value" : "80", 
                        "description" : "RPD Task Memory threshold value", 
                        "type" : "string"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "ACX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "11.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "11.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "SRX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }, 
                        "helper-files" : [
                        {
                            "file-type" : "other", 
                            "list-of-files" : ["task-memory.yml"]
                        }
                        ]
                    }
                }
                ]
            }, 
            {
                "topic-name" : "protocol.isis", 
                "description" : "Monitors isis statitics i.e. adjacency state& statistics and notify anomalies", 
                "synopsis" : "ISIS session statistics analyzer", 
                "rule" : [
                {
                    "rule-name" : "check-isis-adjacencies", 
                    "keys" : ["instance-id", "interface-id", "system-id"],
                    "synopsis" : "ISIS session state analyzer", 
                    "description" : "Collects ISIS adjacency state periodically and notify anomaly when state is down", 
                    "sensor" : [
                    {
                        "sensor-name" : "isis-sensor", 
                        "synopsis" : "ISIS open-config sensor definition", 
                        "description" : "open-config sensor to collect telemetry data from network device", 
                        "open-config" : {
                            "sensor-name" : "/network-instances/network-instance/protocols/protocol/isis/interfaces/interface/", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "adjacency-state", 
                        "sensor" : [
                        {
                            "sensor-name" : "isis-sensor", 
                            "path" : "/network-instances/network-instance/protocols/protocol/isis/interfaces/interface/levels/level/adjacencies/adjacency/state/adjacency-state"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "ISIS adjacency state"
                    }, 
                    {
                        "field-name" : "instance-id", 
                        "sensor" : [
                        {
                            "sensor-name" : "isis-sensor", 
                            "where" : [
                            {
                                "query" : "/network-instances/network-instance/@instance-name =~ /{{instance-name}}/"
                            }
                            ], 
                            "path" : "/network-instances/network-instance/@instance-name"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "ISIS adjacencies belong to routing instance to be monitored"
                    }, 
                    {
                        "field-name" : "interface-id", 
                        "sensor" : [
                        {
                            "sensor-name" : "isis-sensor", 
                            "where" : [
                            {
                                "query" : "/network-instances/network-instance/protocols/protocol/isis/interfaces/interface/@interface-id =~ /{{interface-name}}/"
                            }
                            ], 
                            "path" : "/network-instances/network-instance/protocols/protocol/isis/interfaces/interface/@interface-id"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "ISIS interfaces to be monitored"
                    }, 
                    {
                        "field-name" : "system-id", 
                        "sensor" : [
                        {
                            "sensor-name" : "isis-sensor", 
                            "where" : [
                            {
                                "query" : "/network-instances/network-instance/protocols/protocol/isis/interfaces/interface/levels/level/adjacencies/adjacency/@system-id =~ /{{system-name}}/"
                            }
                            ], 
                            "path" : "/network-instances/network-instance/protocols/protocol/isis/interfaces/interface/levels/level/adjacencies/adjacency/@system-id"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "ISIS adjacencies to be monitored based on system-id"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "isis-adjacency-state", 
                        "synopsis" : "ISIS adjacency state KPI", 
                        "description" : "Sets health based on ISIS adjacency state changes and notify anomaly.", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-adjacency-ip", 
                            "when" : {
                                "matches-with" : [
                                {
                                    "left-operand" : "$adjacency-state", 
                                    "right-operand" : "up"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : " ISIS adjacency state of routing-instance $instance-id, interface $interface-id and system-id $system-id  is $adjacency-state"
                                }
                            }
                        }, 
                        {
                            "term-name" : "is-adjacency-state-down", 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : " ISIS adjacency state of routing-instance $instance-id, interface $interface-id and system-id $system-id  is $adjacency-state"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "instance-name", 
                        "value" : ".*", 
                        "description" : "ISIS ajdacencies belong to routing instance to monitor, regular expression, eg 'master|RI1'", 
                        "type" : "string"
                    }, 
                    {
                        "name" : "interface-name", 
                        "value" : ".*", 
                        "description" : "ISIS interface names to monitor, regular expression, eg 'ge-.*'", 
                        "type" : "string"
                    }, 
                    {
                        "name" : "system-name", 
                        "value" : ".*", 
                        "description" : "ISIS system-ids to monitor, regular expression, eg 'router1|router2'", 
                        "type" : "string"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["MX2010", "MX2020", "MX240", "MX480", "MX960"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["PTX1000", "PTX10000", "PTX5000"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }
                    }
                }, 
                {
                    "rule-name" : "check-isis-statistics", 
                    "keys" : ["interface-name"],
                    "synopsis" : "ISIS adjacency statistics analyzer", 
                    "description" : "Collects ISIS session statistics(lsp, csnp, esh, iih, ish, psnp and unknown drops) periodically and notify anomaly when breaches threshold", 
                    "sensor" : [
                    {
                        "sensor-name" : "isis-sensor", 
                        "synopsis" : "ISIS open-config sensor definition", 
                        "description" : "Open-config sensor to collect telemetry data from network device", 
                        "open-config" : {
                            "sensor-name" : "/network-instances/network-instance/protocols/protocol/isis/interfaces/interface/", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "csnp-drops", 
                        "sensor" : [
                        {
                            "sensor-name" : "isis-sensor", 
                            "where" : [
                            {
                                "query" : "/network-instances/network-instance/protocols/protocol/isis/interfaces/interface/@interface-id =~ /{{interface-name}}/"
                            }
                            ], 
                            "path" : "/network-instances/network-instance/protocols/protocol/isis/interfaces/interface/packet-counters/csnp/state/dropped"
                        }
                        ], 
                        "type" : "integer", 
                        "description" : "Number of csnp drops"
                    }, 
                    {
                        "field-name" : "esh-drops", 
                        "sensor" : [
                        {
                            "sensor-name" : "isis-sensor", 
                            "where" : [
                            {
                                "query" : "/network-instances/network-instance/protocols/protocol/isis/interfaces/interface/@interface-id =~ /{{interface-name}}/"
                            }
                            ], 
                            "path" : "/network-instances/network-instance/protocols/protocol/isis/interfaces/interface/packet-counters/esh/state/dropped"
                        }
                        ], 
                        "type" : "integer", 
                        "description" : "Number of esh drops"
                    }, 
                    {
                        "field-name" : "iih-drops", 
                        "sensor" : [
                        {
                            "sensor-name" : "isis-sensor", 
                            "where" : [
                            {
                                "query" : "/network-instances/network-instance/protocols/protocol/isis/interfaces/interface/@interface-id =~ /{{interface-name}}/"
                            }
                            ], 
                            "path" : "/network-instances/network-instance/protocols/protocol/isis/interfaces/interface/packet-counters/iih/state/dropped"
                        }
                        ], 
                        "type" : "integer", 
                        "description" : "Number of iih drops"
                    }, 
                    {
                        "field-name" : "interface-name", 
                        "sensor" : [
                        {
                            "sensor-name" : "isis-sensor", 
                            "where" : [
                            {
                                "query" : "/network-instances/network-instance/protocols/protocol/isis/interfaces/interface/@interface-id =~ /{{interface-name}}/"
                            }
                            ], 
                            "path" : "/network-instances/network-instance/protocols/protocol/isis/interfaces/interface/@interface-id"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "Interfaces to be monitored"
                    }, 
                    {
                        "field-name" : "ish-drops", 
                        "sensor" : [
                        {
                            "sensor-name" : "isis-sensor", 
                            "where" : [
                            {
                                "query" : "/network-instances/network-instance/protocols/protocol/isis/interfaces/interface/@interface-id =~ /{{interface-name}}/"
                            }
                            ], 
                            "path" : "/network-instances/network-instance/protocols/protocol/isis/interfaces/interface/packet-counters/ish/state/dropped"
                        }
                        ], 
                        "type" : "integer", 
                        "description" : "Number of ish drops"
                    }, 
                    {
                        "field-name" : "lsp-drops", 
                        "sensor" : [
                        {
                            "sensor-name" : "isis-sensor", 
                            "where" : [
                            {
                                "query" : "/network-instances/network-instance/protocols/protocol/isis/interfaces/interface/@interface-id =~ /{{interface-name}}/"
                            }
                            ], 
                            "path" : "/network-instances/network-instance/protocols/protocol/isis/interfaces/interface/packet-counters/lsp/state/dropped"
                        }
                        ], 
                        "type" : "integer", 
                        "description" : "Number of lsp drops"
                    }, 
                    {
                        "field-name" : "psnp-drops", 
                        "sensor" : [
                        {
                            "sensor-name" : "isis-sensor", 
                            "where" : [
                            {
                                "query" : "/network-instances/network-instance/protocols/protocol/isis/interfaces/interface/@interface-id =~ /{{interface-name}}/"
                            }
                            ], 
                            "path" : "/network-instances/network-instance/protocols/protocol/isis/interfaces/interface/packet-counters/psnp/state/dropped"
                        }
                        ], 
                        "type" : "integer", 
                        "description" : "Number of psnp drops"
                    }, 
                    {
                        "field-name" : "threshold", 
                        "constant" : {
                            "value" : "{{drops-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "Packet drops threshold"
                    }, 
                    {
                        "field-name" : "unknown-drops", 
                        "sensor" : [
                        {
                            "sensor-name" : "isis-sensor", 
                            "where" : [
                            {
                                "query" : "/network-instances/network-instance/protocols/protocol/isis/interfaces/interface/@interface-id =~ /{{interface-name}}/"
                            }
                            ], 
                            "path" : "/network-instances/network-instance/protocols/protocol/isis/interfaces/interface/packet-counters/unknown/state/dropped"
                        }
                        ], 
                        "type" : "integer", 
                        "description" : "Number of unknown drops"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "csnp-drops", 
                        "synopsis" : "ISIS csnp drops kpi", 
                        "description" : "Sets health based on increase in ISIS session's csnp drop count and notify anomaly", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "csnp-drops-increasing", 
                            "when" : {
                                "increasing-at-least-by-value" : [
                                {
                                    "field-name" : "$csnp-drops", 
                                    "value" : "$threshold", 
                                    "time-range" : "3m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "CSNP packet drops $lsp-drops are increasing on $interface-name"
                                }
                            }
                        }, 
                        {
                            "term-name" : "csnp-drops-normal", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "CSNP packet drops $lsp-drops are not increasing on $interface-name"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "esh-drops", 
                        "synopsis" : "ISIS esh drops kpi", 
                        "description" : "Sets health based on increase in ISIS session's esh drop count and notify anomaly", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "lsp-drops-increasing", 
                            "when" : {
                                "increasing-at-least-by-value" : [
                                {
                                    "field-name" : "$esh-drops", 
                                    "value" : "$threshold", 
                                    "time-range" : "3m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "ESH packet drops $esh-drops are increasing on $interface-name"
                                }
                            }
                        }, 
                        {
                            "term-name" : "lsp-drops-normal", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "ESH packet drops $esh-drops are not increasing on $interface-name"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "iih-drops", 
                        "synopsis" : "ISIS iih drops kpi", 
                        "description" : "Sets health based on increase in ISIS session's iih drop count and notify anomaly", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "lsp-drops-increasing", 
                            "when" : {
                                "increasing-at-least-by-value" : [
                                {
                                    "field-name" : "$iih-drops", 
                                    "value" : "$threshold", 
                                    "time-range" : "3m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "IIH packet drops $iih-drops are increasing on $interface-name"
                                }
                            }
                        }, 
                        {
                            "term-name" : "lsp-drops-normal", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "IIH packet drops $iih-drops are not increasing on $interface-name"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "ish-drops", 
                        "synopsis" : "ISIS ish drops kpi", 
                        "description" : "Sets health based on increase in ISIS session's ish drop count and notify anomaly", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "lsp-drops-increasing", 
                            "when" : {
                                "increasing-at-least-by-value" : [
                                {
                                    "field-name" : "$ish-drops", 
                                    "value" : "$threshold", 
                                    "time-range" : "3m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "ISH packet drops $ish-drops are increasing on $interface-name"
                                }
                            }
                        }, 
                        {
                            "term-name" : "lsp-drops-normal", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "ISH packet drops $ish-drops are not increasing on $interface-name"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "lsp-drops", 
                        "synopsis" : "ISIS lsp drops kpi", 
                        "description" : "Sets health based on increase in ISIS session's lsp drop count and notify anomaly", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "lsp-drops-increasing", 
                            "when" : {
                                "increasing-at-least-by-value" : [
                                {
                                    "field-name" : "$lsp-drops", 
                                    "value" : "$threshold", 
                                    "time-range" : "3m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "LSP packet drops $lsp-drops are increasing on $interface-name"
                                }
                            }
                        }, 
                        {
                            "term-name" : "lsp-drops-normal", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "LSP packet drops $lsp-drops are not increasing on $interface-name"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "psnp-drops", 
                        "synopsis" : "ISIS psnp drops kpi", 
                        "description" : "Sets health based on increase in ISIS session's psnp drop count and notify anomaly", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "lsp-drops-increasing", 
                            "when" : {
                                "increasing-at-least-by-value" : [
                                {
                                    "field-name" : "$psnp-drops", 
                                    "value" : "$threshold", 
                                    "time-range" : "3m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "PSNP packet drops $psnp-drops are increasing on $interface-name"
                                }
                            }
                        }, 
                        {
                            "term-name" : "lsp-drops-normal", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "PSNP packet drops $psnp-drops are not increasing on $interface-name"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "unknown-drops", 
                        "synopsis" : "ISIS unknown drops kpi", 
                        "description" : "Sets health based on increase in ISIS session's unknown drop count and notify anomaly", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "lsp-drops-increasing", 
                            "when" : {
                                "increasing-at-least-by-value" : [
                                {
                                    "field-name" : "$unknown-drops", 
                                    "value" : "$threshold", 
                                    "time-range" : "3m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Unknown packet drops $unknown-drops are increasing on $interface-name"
                                }
                            }
                        }, 
                        {
                            "term-name" : "lsp-drops-normal", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "Unknown packet drops $unknown-drops are not increasing on $interface-name"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "drops-threshold", 
                        "value" : "1", 
                        "description" : "Packet drops threshold: Increase between metrics, before we report anomaly", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "interface-name", 
                        "value" : ".*", 
                        "description" : "Interface names to monitor, regular expression, eg 'ge-.*'", 
                        "type" : "string"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["MX2010", "MX2020", "MX240", "MX480", "MX960"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["PTX1000", "PTX10000", "PTX5000"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }
                    }
                }
                ]
            }, 
            {
                "topic-name" : "protocol.l3vpn", 
                "description" : "Collect routing instance and interfaces stats and notify anomalies", 
                "synopsis" : "L3VPN session state analyzer", 
                "rule" : [
                {
                    "rule-name" : "check-l3vpn-state", 
                    "synopsis" : "L3VPN session state detector", 
                    "description" : "Refer L3VPN peer state, CE and PE interface states from rule get-routing-instance-details & get-interface-details and notify anomalies when flap count increases", 
                    "rule-frequency" : "75s", 
                    "network-rule" : [null], 
                    "field" : [
                    {
                        "field-name" : "ce-router-name", 
                        "constant" : {
                            "value" : "{{ce-device-name}}"
                        }, 
                        "type" : "string", 
                        "description" : "CE router name to monitor"
                    }, 
                    {
                        "field-name" : "instance-ifl-no", 
                        "reference" : {
                            "path" : "/device-group[device-group-name={{pe-device-group}}]/device[device-id={{pe-device-name}}]/topic[topic-name='protocol.l3vpn']/rule[rule-name=get-interface-details]/field[sub-interface-index='{{pe-ifl-number}}' and interface-name='{{pe-interface-name}}']/sub-interface-index"
                        }, 
                        "type" : "integer", 
                        "description" : "Routing instance IFL number"
                    }, 
                    {
                        "field-name" : "instance-interface-name", 
                        "reference" : {
                            "path" : "/device-group[device-group-name={{pe-device-group}}]/device[device-id={{pe-device-name}}]/topic[topic-name='protocol.l3vpn']/rule[rule-name=get-interface-details]/field[interface-name='{{pe-interface-name}}']/interface-name"
                        }, 
                        "type" : "string", 
                        "description" : "Routing instance interface name"
                    }, 
                    {
                        "field-name" : "instance-interface-status", 
                        "reference" : {
                            "path" : "/device-group[device-group-name={{pe-device-group}}]/device[device-id={{pe-device-name}}]/topic[topic-name='protocol.l3vpn']/rule[rule-name=get-interface-details]/field[sub-interface-index='{{pe-ifl-number}}' and interface-name='{{pe-interface-name}}']/link-state"
                        }, 
                        "type" : "string", 
                        "description" : "Routing instance interface status"
                    }, 
                    {
                        "field-name" : "neighbor-session", 
                        "reference" : {
                            "path" : "/device-group[device-group-name={{pe-device-group}}]/device[device-id={{pe-device-name}}]/topic[topic-name='protocol.l3vpn']/rule[rule-name=get-routing-instance-details]/field[neighbor-address='{{customer-neighbor-address}}']/neighbor-address"
                        }, 
                        "type" : "string", 
                        "description" : "Protocol neighbor address"
                    }, 
                    {
                        "field-name" : "pe-router-name", 
                        "constant" : {
                            "value" : "{{pe-device-name}}"
                        }, 
                        "type" : "string", 
                        "description" : "PE router name to monitor"
                    }, 
                    {
                        "field-name" : "remote-ifl-no", 
                        "reference" : {
                            "path" : "/device-group[device-group-name={{ce-device-group}}]/device[device-id={{ce-device-name}}]/topic[topic-name='protocol.l3vpn']/rule[rule-name=get-interface-details]/field[sub-interface-index='{{ce-ifl-number}}' and interface-name='{{ce-interface-name}}']/sub-interface-index"
                        }, 
                        "type" : "integer", 
                        "description" : "CE IFL number"
                    }, 
                    {
                        "field-name" : "remote-interface-name", 
                        "reference" : {
                            "path" : "/device-group[device-group-name={{ce-device-group}}]/device[device-id={{ce-device-name}}]/topic[topic-name='protocol.l3vpn']/rule[rule-name=get-interface-details]/field[interface-name='{{ce-interface-name}}']/interface-name"
                        }, 
                        "type" : "string", 
                        "description" : "CE interface name"
                    }, 
                    {
                        "field-name" : "remote-interface-status", 
                        "reference" : {
                            "path" : "/device-group[device-group-name={{ce-device-group}}]/device[device-id={{ce-device-name}}]/topic[topic-name='protocol.l3vpn']/rule[rule-name=get-interface-details]/field[sub-interface-index='{{ce-ifl-number}}' and interface-name='{{ce-interface-name}}']/link-state"
                        }, 
                        "type" : "string", 
                        "description" : "CE interface status"
                    }, 
                    {
                        "field-name" : "vpn-name", 
                        "reference" : {
                            "path" : "/device-group[device-group-name={{pe-device-group}}]/device[device-id={{pe-device-name}}]/topic[topic-name='protocol.l3vpn']/rule[rule-name=get-routing-instance-details]/field[instance-name='{{customer-vpn-name}}']/instance-name"
                        }, 
                        "type" : "string", 
                        "description" : "VRF name"
                    }, 
                    {
                        "field-name" : "vpn-state", 
                        "reference" : {
                            "path" : "/device-group[device-group-name={{pe-device-group}}]/device[device-id={{pe-device-name}}]/topic[topic-name='protocol.l3vpn']/rule[rule-name=get-routing-instance-details]/field[neighbor-address='{{customer-neighbor-address}}']/session-state"
                        }, 
                        "type" : "string", 
                        "description" : "VRF peer state"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "l3vpn-ce-interface-state", 
                        "frequency" : "75s", 
                        "term" : [
                        {
                            "term-name" : "is-ce-interface-up", 
                            "when" : {
                                "matches-with" : [
                                {
                                    "left-operand" : "$remote-interface-status", 
                                    "right-operand" : "UP"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "CE interface $remote-interface-name.$remote-ifl-no of router $ce-router-name is UP"
                                }
                            }
                        }, 
                        {
                            "term-name" : "vpn-interface-down", 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "CE interface $remote-interface-name.$remote-ifl-no of router $ce-router-name is $remote-interface-status"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "l3vpn-pe-interface-state", 
                        "frequency" : "75s", 
                        "term" : [
                        {
                            "term-name" : "is-pe-interface-up", 
                            "when" : {
                                "matches-with" : [
                                {
                                    "left-operand" : "$instance-interface-status", 
                                    "right-operand" : "UP"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "PE interface $instance-interface-name.$instance-ifl-no of VPN:$vpn-name on router $pe-router-name is UP"
                                }
                            }
                        }, 
                        {
                            "term-name" : "is-pe-interface-down", 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "PE interface $instance-interface-name.$instance-ifl-no of VPN:$vpn-name on router $pe-router-name is $instance-interface-status"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "l3vpn-state", 
                        "synopsis" : "L3VPN session status KPI", 
                        "description" : "Sets health based on state change in L3VPN peer, CE interface and PE interface state.", 
                        "frequency" : "75s", 
                        "term" : [
                        {
                            "term-name" : "is-vpn-session-up", 
                            "when" : {
                                "matches-with" : [
                                {
                                    "left-operand" : "$vpn-state", 
                                    "right-operand" : "ESTABLISHED"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "L3VPN:$vpn-name neighbor:$neighbor-session of $pe-router-name is UP"
                                }
                            }
                        }, 
                        {
                            "term-name" : "is-vpn-session-down", 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "L3VPN:$vpn-name neighbor:$neighbor-session of $pe-router-name is $vpn-state"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "ce-device-group", 
                        "description" : "Router group to monitor, regular expression, e.g. 'edge.*'", 
                        "type" : "device-group"
                    }, 
                    {
                        "name" : "ce-device-name", 
                        "description" : "Router name to monitor, regular expression, e.g. 'edge-router.*'", 
                        "type" : "device"
                    }, 
                    {
                        "name" : "ce-ifl-number", 
                        "description" : "CE sub interface number to monitor, regular expression, e.g. '1-10'", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "ce-interface-name", 
                        "description" : "CE interface to monitor, regular expression, e.g. 'ge-.*'", 
                        "type" : "string"
                    }, 
                    {
                        "name" : "customer-neighbor-address", 
                        "description" : "BGP neighbor addresses to monitor, regular expression, e.g. '172.16.*'", 
                        "type" : "string"
                    }, 
                    {
                        "name" : "customer-vpn-name", 
                        "description" : "VRF name to monitor, regular expression, e.g. 'customer*'", 
                        "type" : "string"
                    }, 
                    {
                        "name" : "pe-device-group", 
                        "description" : "Router group to monitor, regular expression, e.g. 'edge.*'", 
                        "type" : "device-group"
                    }, 
                    {
                        "name" : "pe-device-name", 
                        "description" : "Router name to monitor, regular expression, e.g. 'edge-router.*'", 
                        "type" : "device"
                    }, 
                    {
                        "name" : "pe-ifl-number", 
                        "description" : "PE IFL to monitor, regular expression, e.g. '1-10'", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "pe-interface-name", 
                        "description" : "PE interface to monitor, regular expression, e.g. 'ge-.*'", 
                        "type" : "string"
                    }
                    ]
                }, 
                {
                    "rule-name" : "get-interface-details", 
                    "keys" : ["interface-name", "sub-interface-index"],
                    "synopsis" : "Interface details collector.", 
                    "description" : "Collects interface and IFL status periodically", 
                    "sensor" : [
                    {
                        "sensor-name" : "interfaces", 
                        "synopsis" : "Interface open-config sensor definition", 
                        "description" : "Interfaces open-config sensor to collect telemetry data from network device", 
                        "open-config" : {
                            "sensor-name" : "/interfaces/", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "interface-name", 
                        "sensor" : [
                        {
                            "sensor-name" : "interfaces", 
                            "where" : [
                            {
                                "query" : "/interfaces/interface/@name =~ /{{ifd-name}}/"
                            }
                            ], 
                            "path" : "/interfaces/interface/@name"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "Interfaces to be monitored"
                    }, 
                    {
                        "field-name" : "link-state", 
                        "sensor" : [
                        {
                            "sensor-name" : "interfaces", 
                            "path" : "/interfaces/interface/subinterfaces/subinterface/state/oper-status"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "Sub Interface oper status."
                    }, 
                    {
                        "field-name" : "sub-interface-index", 
                        "sensor" : [
                        {
                            "sensor-name" : "interfaces", 
                            "where" : [
                            {
                                "query" : "/interfaces/interface/subinterfaces/subinterface/@index =~ /{{ifl-no}}/"
                            }
                            ], 
                            "path" : "/interfaces/interface/subinterfaces/subinterface/@index"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "IFL to be monitored"
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "ifd-name", 
                        "value" : ".*", 
                        "description" : "Interfaces to be monitored, regular expression, eg 'ge-.*';", 
                        "type" : "string"
                    }, 
                    {
                        "name" : "ifl-no", 
                        "value" : ".*", 
                        "description" : "Sub interfaces index to be monitored, regular expression, eg '0-10'", 
                        "type" : "string"
                    }
                    ]
                }, 
                {
                    "rule-name" : "get-routing-instance-details", 
                    "keys" : ["instance-name", "neighbor-address"],
                    "synopsis" : "Routing details collector.", 
                    "description" : "Collects routing instance bgp peer status periodically", 
                    "sensor" : [
                    {
                        "sensor-name" : "vpn-sensor", 
                        "synopsis" : "Routing instance sensor definition", 
                        "description" : "Open-config sensor to collect telemetry data from network device", 
                        "open-config" : {
                            "sensor-name" : "/network-instances/network-instance", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "instance-name", 
                        "sensor" : [
                        {
                            "sensor-name" : "vpn-sensor", 
                            "where" : [
                            {
                                "query" : "/network-instances/network-instance/@instance-name =~ /{{instance}}/"
                            }
                            ], 
                            "path" : "/network-instances/network-instance/@instance-name"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "Routing Instance to be monitored"
                    }, 
                    {
                        "field-name" : "neighbor-address", 
                        "sensor" : [
                        {
                            "sensor-name" : "vpn-sensor", 
                            "where" : [
                            {
                                "query" : "/network-instances/network-instance/protocols/protocol/bgp/neighbors/neighbor/@neighbor-address =~ /{{neighbors}}/"
                            }
                            ], 
                            "path" : "/network-instances/network-instance/protocols/protocol/bgp/neighbors/neighbor/@neighbor-address"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "Routing instance neighbor to be monitored"
                    }, 
                    {
                        "field-name" : "session-state", 
                        "sensor" : [
                        {
                            "sensor-name" : "vpn-sensor", 
                            "path" : "/network-instances/network-instance/protocols/protocol/bgp/neighbors/neighbor/state/session-state"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "Routing instance neighbor state"
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "instance", 
                        "value" : ".*", 
                        "description" : "Routing instance to be monitored, regular expression, eg 'VPN*'", 
                        "type" : "string"
                    }, 
                    {
                        "name" : "neighbors", 
                        "value" : ".*", 
                        "description" : "BGP neighbor addresses to monitor, regular expression, e.g. '172.16.*'", 
                        "type" : "string"
                    }
                    ]
                }
                ]
            }, 
            {
                "topic-name" : "protocol.lldp", 
                "description" : "Monitors lldp statitics i.e. neighbor state, frame discards, frame errors, tlv discards & unknown tlvs and notify anomalies", 
                "synopsis" : "LLDP session statistics analyzer", 
                "rule" : [
                {
                    "rule-name" : "check-lldp-session", 
                    "keys" : ["interface-name"],
                    "synopsis" : "LLDP session state analyzer", 
                    "description" : "Collects lldp session state periodically and notify anomaly when state is down", 
                    "sensor" : [
                    {
                        "sensor-name" : "lldp-sensor", 
                        "synopsis" : "LLDP open-config sensor definition", 
                        "description" : "/lldp open-config sensor to collect telemetry data from network device", 
                        "open-config" : {
                            "sensor-name" : "/lldp/", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "if-lldp-state", 
                        "sensor" : [
                        {
                            "sensor-name" : "lldp-sensor", 
                            "path" : "/lldp/interfaces/interface/state/enabled"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "Local interface LLDP state"
                    }, 
                    {
                        "field-name" : "interface-name", 
                        "sensor" : [
                        {
                            "sensor-name" : "lldp-sensor", 
                            "where" : [
                            {
                                "query" : "/lldp/interfaces/interface/@name =~ /{{if-name}}/"
                            }
                            ], 
                            "path" : "/lldp/interfaces/interface/@name"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "Interfaces to be monitored"
                    }, 
                    {
                        "field-name" : "neighbor-state", 
                        "reference" : {
                            "path" : "/topic[topic-name='protocol.lldp']/rule[rule-name='get-lldp-state']/field[interface-name='$interface-name']/neighbor-capability-state", 
                            "time-range" : "60s"
                        }, 
                        "type" : "string", 
                        "description" : "LLDP neighbor state"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "lldp-session-state", 
                        "synopsis" : "LLDP state KPI", 
                        "description" : "Sets health based on lldp session state changes and notify anomaly.", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-lldp-session-up", 
                            "when" : {
                                "matches-with" : [
                                {
                                    "left-operand" : "$neighbor-state", 
                                    "right-operand" : "true"
                                }, 
                                {
                                    "left-operand" : "$if-lldp-state", 
                                    "right-operand" : "true"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "Interface $interface-name llpd session is up"
                                }
                            }
                        }, 
                        {
                            "term-name" : "lldp-session-down", 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Interface-$interface-name llpd session down"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "if-name", 
                        "value" : ".*", 
                        "description" : "Interface names to monitor, regular expression, eg 'ge-.*'", 
                        "type" : "string"
                    }
                    ]
                }, 
                {
                    "rule-name" : "check-lldp-session-statistics", 
                    "keys" : ["interface-name"],
                    "synopsis" : "LLDP session statistics analyzer", 
                    "description" : "Collects LLDP session statistics(frame& TLV discards, frame-in&out errors and unknown TLVs) periodically and notify anomaly when breaches threshold", 
                    "sensor" : [
                    {
                        "sensor-name" : "lldp-sensor", 
                        "synopsis" : "LLDP open-config sensor definition", 
                        "description" : "/lldp open-config sensor to collect telemetry data from network device", 
                        "open-config" : {
                            "sensor-name" : "/lldp/", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "frame-discards", 
                        "sensor" : [
                        {
                            "sensor-name" : "lldp-sensor", 
                            "path" : "/lldp/interfaces/interface/state/counters/frame-discard"
                        }
                        ], 
                        "type" : "integer", 
                        "description" : "Number of frame discards"
                    }, 
                    {
                        "field-name" : "frame-discards-threshold", 
                        "constant" : {
                            "value" : "{{frame-discards-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "Frame discards threshold"
                    }, 
                    {
                        "field-name" : "frame-error-in", 
                        "sensor" : [
                        {
                            "sensor-name" : "lldp-sensor", 
                            "path" : "/lldp/interfaces/interface/state/counters/frame-error-in"
                        }
                        ], 
                        "type" : "integer", 
                        "description" : "Number of frame in errors"
                    }, 
                    {
                        "field-name" : "frame-error-in-threshold", 
                        "constant" : {
                            "value" : "{{frame-error-in-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "Frame in errors threshold"
                    }, 
                    {
                        "field-name" : "frame-error-out", 
                        "sensor" : [
                        {
                            "sensor-name" : "lldp-sensor", 
                            "path" : "/lldp/interfaces/interface/state/counters/frame-error-out"
                        }
                        ], 
                        "type" : "integer", 
                        "description" : "Number of frame out errors"
                    }, 
                    {
                        "field-name" : "frame-error-out-threshold", 
                        "constant" : {
                            "value" : "{{frame-error-out-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "Frame out errors threshold"
                    }, 
                    {
                        "field-name" : "if-lldp-state", 
                        "sensor" : [
                        {
                            "sensor-name" : "lldp-sensor", 
                            "path" : "/lldp/interfaces/interface/state/enabled"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "Local interface LLDP state"
                    }, 
                    {
                        "field-name" : "interface-name", 
                        "sensor" : [
                        {
                            "sensor-name" : "lldp-sensor", 
                            "where" : [
                            {
                                "query" : "/lldp/interfaces/interface/@name =~ /{{if-name}}/"
                            }
                            ], 
                            "path" : "/lldp/interfaces/interface/@name"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "Interfaces to be monitored"
                    }, 
                    {
                        "field-name" : "tlv-discards", 
                        "sensor" : [
                        {
                            "sensor-name" : "lldp-sensor", 
                            "path" : "/lldp/interfaces/interface/state/counters/tlv-discard"
                        }
                        ], 
                        "type" : "integer", 
                        "description" : "Number of TLV discards"
                    }, 
                    {
                        "field-name" : "tlvs-discards-threshold", 
                        "constant" : {
                            "value" : "{{tlv-discards-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "TLV discards threshold"
                    }, 
                    {
                        "field-name" : "unknown-tlvs", 
                        "sensor" : [
                        {
                            "sensor-name" : "lldp-sensor", 
                            "path" : "/lldp/interfaces/interface/state/counters/tlv-unknown"
                        }
                        ], 
                        "type" : "integer", 
                        "description" : "Number of unknown TLVs"
                    }, 
                    {
                        "field-name" : "unknown-tlvs-threshold", 
                        "constant" : {
                            "value" : "{{unknown-tlvs-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "Unknown TLV discards threshold"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "frame-discards", 
                        "synopsis" : "LLDP frame-discards kpi", 
                        "description" : "Sets health based on increase in LLDP session's frame discards count and notify anomaly", 
                        "frequency" : "3m", 
                        "term" : [
                        {
                            "term-name" : "skip-lldp-disabled", 
                            "when" : {
                                "does-not-match-with" : [
                                {
                                    "left-operand" : "$if-lldp-state", 
                                    "right-operand" : "true"
                                }
                                ]
                            }
                        }, 
                        {
                            "term-name" : "are-frame-discars-incrementing", 
                            "when" : {
                                "min-rate-of-increase" : [
                                {
                                    "field-name" : "$frame-discards", 
                                    "rate" : "$frame-discards-threshold", 
                                    "time-range" : "3m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "frame-discards count($frame-discards) increasing continuously"
                                }
                            }
                        }, 
                        {
                            "term-name" : "no-frame-discards", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "frame-discards count is:$frame-discards"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "frame-error-in", 
                        "synopsis" : "LLDP frame input errors kpi", 
                        "description" : "Sets health based on increase in LLDP session's frame in error count and notify anomaly", 
                        "frequency" : "3m", 
                        "term" : [
                        {
                            "term-name" : "skip-lldp-disabled", 
                            "when" : {
                                "does-not-match-with" : [
                                {
                                    "left-operand" : "$if-lldp-state", 
                                    "right-operand" : "true"
                                }
                                ]
                            }
                        }, 
                        {
                            "term-name" : "are-frame-error-in-increasing", 
                            "when" : {
                                "min-rate-of-increase" : [
                                {
                                    "field-name" : "$frame-error-in", 
                                    "rate" : "$frame-error-in-threshold", 
                                    "time-range" : "3m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "frame-error-in count ($frame-error-in) increasing continuously"
                                }
                            }
                        }, 
                        {
                            "term-name" : "no-frame-error-in", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "frame-error-in count is:$frame-error-in"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "frame-error-out", 
                        "synopsis" : "LLDP frame output errors kpi", 
                        "description" : "Sets health based on increase in LLDP session's frame out error count and notify anomaly", 
                        "frequency" : "3m", 
                        "term" : [
                        {
                            "term-name" : "skip-lldp-disabled", 
                            "when" : {
                                "does-not-match-with" : [
                                {
                                    "left-operand" : "$if-lldp-state", 
                                    "right-operand" : "true"
                                }
                                ]
                            }
                        }, 
                        {
                            "term-name" : "are-frame-error-out-increasing", 
                            "when" : {
                                "min-rate-of-increase" : [
                                {
                                    "field-name" : "$frame-error-out", 
                                    "rate" : "$frame-error-out-threshold", 
                                    "time-range" : "3m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "frame-error-out count ($frame-error-out) increasing continuously"
                                }
                            }
                        }, 
                        {
                            "term-name" : "no-frame-error-out", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "frame-error-out count is:$frame-error-out"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "tlv-discards", 
                        "synopsis" : "LLDP TLV discards trigger", 
                        "description" : "Sets health based increase in LLDP session TLVs discard count and notify anomaly", 
                        "frequency" : "3m", 
                        "term" : [
                        {
                            "term-name" : "skip-lldp-disabled", 
                            "when" : {
                                "does-not-match-with" : [
                                {
                                    "left-operand" : "$if-lldp-state", 
                                    "right-operand" : "true"
                                }
                                ]
                            }
                        }, 
                        {
                            "term-name" : "are-tlv-discards-increasing", 
                            "when" : {
                                "min-rate-of-increase" : [
                                {
                                    "field-name" : "$tlv-discards", 
                                    "rate" : "$tlvs-discards-threshold", 
                                    "time-range" : "3m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "tlv-discards count($tlv-discards) increasing continuously"
                                }
                            }
                        }, 
                        {
                            "term-name" : "no-tlv-discards", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "tlv-discards count is:$tlv-discards"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "unknown-tlvs", 
                        "synopsis" : "LLDP unknown TLVs count kpi", 
                        "description" : "Sets health based increase in LLDP session's Luvs discard count and notify anomaly", 
                        "frequency" : "3m", 
                        "term" : [
                        {
                            "term-name" : "skip-lldp-disabled", 
                            "when" : {
                                "does-not-match-with" : [
                                {
                                    "left-operand" : "$if-lldp-state", 
                                    "right-operand" : "true"
                                }
                                ]
                            }
                        }, 
                        {
                            "term-name" : "are-unknown-tlvs-increasing", 
                            "when" : {
                                "min-rate-of-increase" : [
                                {
                                    "field-name" : "$unknown-tlvs", 
                                    "rate" : "$unknown-tlvs-threshold", 
                                    "time-range" : "3m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "unknown-tlvs count($unknown-tlvs) increasing continuously"
                                }
                            }
                        }, 
                        {
                            "term-name" : "no-unknown-tlvs", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "unknown-tlvs count is:$unknown-tlvs"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "frame-discards-threshold", 
                        "value" : "1", 
                        "description" : "Frame discards threshold: Increase between metrics, before we report anomaly", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "frame-error-in-threshold", 
                        "value" : "1", 
                        "description" : "Frame in error threshold: Increase between metrics, before we report anomaly", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "frame-error-out-threshold", 
                        "value" : "1", 
                        "description" : "Frame out error threshold: Increase between metrics, before we report anomaly", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "if-name", 
                        "value" : ".*", 
                        "description" : "Interface names to monitor, regular expression, eg 'ge-.*'", 
                        "type" : "string"
                    }, 
                    {
                        "name" : "tlv-discards-threshold", 
                        "value" : "1", 
                        "description" : "TLV discard threshold: Increase between metrics, before we report anomaly", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "unknown-tlvs-threshold", 
                        "value" : "1", 
                        "description" : "Unknown TLVs threshold: Increase between metrics, before we report anomaly", 
                        "type" : "int"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX9200"]
                                        }, 
                                        {
                                            "release-name" : "18.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX4650"]
                                        }, 
                                        {
                                            "release-name" : "18.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX4600"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["MX2010", "MX2020", "MX240", "MX480", "MX960"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["PTX1000", "PTX10000", "PTX5000"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX10000", "QFX5110", "QFX5200"]
                                        }, 
                                        {
                                            "release-name" : "18.1R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX5100"]
                                        }, 
                                        {
                                            "release-name" : "18.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX5120-48Y"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }
                    }
                }, 
                {
                    "rule-name" : "get-lldp-state", 
                    "keys" : ["interface-name"],
                    "synopsis" : "LLDP neighbor state collector", 
                    "description" : "Collects lldp session state periodically", 
                    "sensor" : [
                    {
                        "sensor-name" : "lldp-sensor", 
                        "synopsis" : "LLDP open-config sensor definition", 
                        "description" : "/lldp open-config sensor to collect telemetry data from network device", 
                        "open-config" : {
                            "sensor-name" : "/lldp/", 
                            "frequency" : "55s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "interface-name", 
                        "sensor" : [
                        {
                            "sensor-name" : "lldp-sensor", 
                            "where" : [
                            {
                                "query" : "/lldp/interfaces/interface/@name =~ /{{if-name}}/"
                            }
                            ], 
                            "path" : "/lldp/interfaces/interface/@name"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "Interfaces to be monitored"
                    }, 
                    {
                        "field-name" : "neighbor-capability-state", 
                        "sensor" : [
                        {
                            "sensor-name" : "lldp-sensor", 
                            "path" : "/lldp/interfaces/interface/neighbors/neighbor/capabilities/capability/state/enabled"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "Remote LLDP neighbor state"
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "if-name", 
                        "value" : ".*", 
                        "description" : "Interface names to monitor, regular expression, eg 'ge-.*'", 
                        "type" : "string"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX9200"]
                                        }, 
                                        {
                                            "release-name" : "18.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX4650"]
                                        }, 
                                        {
                                            "release-name" : "18.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX4600"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["MX2010", "MX2020", "MX240", "MX480", "MX960"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["PTX1000", "PTX10000", "PTX5000"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX10000", "QFX5110", "QFX5200"]
                                        }, 
                                        {
                                            "release-name" : "18.1R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX5100"]
                                        }, 
                                        {
                                            "release-name" : "18.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX5120-48Y"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }
                    }
                }
                ]
            }, 
            {
                "topic-name" : "protocol.ospf", 
                "description" : "This topic is to monitor ospf neigbor state", 
                "synopsis" : "ospf neighbor status check", 
                "rule" : [
                {
                    "rule-name" : "check-ospf-forwarding-table", 
                    "keys" : ["table-name"],
                    "synopsis" : "ospf session state analyzer", 
                    "description" : "Checks if the route destination and next hop are correct", 
                    "sensor" : [
                    {
                        "sensor-name" : "protocol-ospf-forwarding-table", 
                        "synopsis" : "ospf session state sensor definition", 
                        "description" : "Netconf rpc get-forwarding-table-information iAgent sensor to collect telemetry data from network device", 
                        "iAgent" : {
                            "file" : "ospf-kernel-route.yml", 
                            "table" : "ForwardingTableRouteTable", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "protocol-ospf-forwarding-table-route-destination", 
                        "synopsis" : "ospf protocol state kpi", 
                        "description" : "Sets health based on ospf forwarding table route destination", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-protocol-ospf-forwarding-table-route-destination-correct", 
                            "when" : {
                                "matches-with" : [
                                {
                                    "left-operand" : "$route-destination", 
                                    "right-operand" : "224.0.0.5/32"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "Protocol OSPF forwarding-table Multicast destination is correct"
                                }
                            }
                        }, 
                        {
                            "term-name" : "protocol-ospf-forwarding-table-route-destination-incorrect", 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Protocol OSPF forwarding-table Multicast destination is incorrect"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "protocol-ospf-forwarding-table-route-next-hop", 
                        "synopsis" : "ospf protocol state kpi", 
                        "description" : "Sets health based on ospf forwarding table route next hop", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-protocol-ospf-forwarding-table-route-next-hop-correct", 
                            "when" : {
                                "matches-with" : [
                                {
                                    "left-operand" : "$next-hop-type", 
                                    "right-operand" : "mcst"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "Protocol OSPF forwarding-table route next-hop is of correct type - Multicast"
                                }
                            }
                        }, 
                        {
                            "term-name" : "protocol-ospf-forwarding-table-route-next-hop-incorrect", 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Protocol OSPF forwarding-table route next-hop type is incorrect"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "ACX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "11.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "11.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "SRX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }, 
                        "helper-files" : [
                        {
                            "file-type" : "other", 
                            "list-of-files" : ["ospf-kernel-route.yml"]
                        }
                        ]
                    }
                }, 
                {
                    "rule-name" : "check-ospf-io-statistics-information", 
                    "keys" : ["packets-read"],
                    "synopsis" : "OSPF IO statistics analyzer", 
                    "description" : "Monitors OSPF's I/O statistics", 
                    "sensor" : [
                    {
                        "sensor-name" : "protocol-ospf-io-statistics-information", 
                        "synopsis" : "OSPF iAgent sensor definition", 
                        "description" : "Netconfig rpc get-ospf-neighbor-information iAgent sensor to collect telemetry data from network device", 
                        "iAgent" : {
                            "file" : "ospf.yml", 
                            "table" : "OspfIoStat", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "protocol-ospf-io-statistics-information-ospf-error-count", 
                        "synopsis" : "ospf io statistics kpi", 
                        "description" : "Sets health based on ospf io errors", 
                        "term" : [
                        {
                            "term-name" : "no-ospf-error-reported", 
                            "when" : {
                                "matches-with" : [
                                {
                                    "left-operand" : "$ospf-error", 
                                    "right-operand" : "no-error"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "RPD OSPF IO is not reporting any errors"
                                }
                            }
                        }, 
                        {
                            "term-name" : "is-ospf-error-reported", 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "RPD OSPF IO is reporting errors"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "protocol-ospf-io-statistics-information-packet-read", 
                        "synopsis" : "ospf io statistics kpi", 
                        "description" : "Sets health based on ospf io packet read errors", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-ospf-io-packet-read-increasing", 
                            "when" : {
                                "min-rate-of-increase" : [
                                {
                                    "field-name" : "$packets-read", 
                                    "rate" : "1", 
                                    "time-range" : "5m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "RPD OSPF IO module is functioning "
                                }
                            }
                        }, 
                        {
                            "term-name" : "ospf-io-packet-read-not-increasing", 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "RPD OSPF IO module is not functioning"
                                }
                            }
                        }
                        ]
                    }
                    ]
                }, 
                {
                    "rule-name" : "check-ospf-neighbor-information", 
                    "keys" : ["interface-name", "neighbor-id"],
                    "synopsis" : "OSPF session state analyzer", 
                    "description" : "Monitors the OPSF neighbor states", 
                    "sensor" : [
                    {
                        "sensor-name" : "protocol-ospf-neighbor-information", 
                        "synopsis" : "OSPF iAgent sensor definition", 
                        "description" : "Netconfig rpc get-ospf-neighbor-information iAgent sensor to collect telemetry data from network device", 
                        "iAgent" : {
                            "file" : "ospf.yml", 
                            "table" : "OspfNeighborTable", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "ospf-neighbor-state", 
                        "synopsis" : "ospf neigbor state kpi", 
                        "description" : "Sets health based on ospf neighbor state", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-neighbor-state-full", 
                            "when" : {
                                "matches-with" : [
                                {
                                    "left-operand" : "$ospf-neighbor-state", 
                                    "right-operand" : "Full"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "OSPF neighbor is in Full state"
                                }
                            }
                        }, 
                        {
                            "term-name" : "ospf-neighbor-state-notfull", 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "OSPF neighbor is in down state"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "ospf-neighbor-state-exstart", 
                        "synopsis" : "ospf neigbor state kpi", 
                        "description" : "Sets health based on ospf neighbor state", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-state-exstart", 
                            "when" : {
                                "matches-with" : [
                                {
                                    "left-operand" : "$ospf-neighbor-state", 
                                    "right-operand" : "ExStart"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "OSPF neighbor is in ExStart state- check the MTU on OSPF interface"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "ospf-neighbor-state-twoway", 
                        "synopsis" : "ospf neigbor state kpi", 
                        "description" : "Sets health based on ospf neighbor state", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-neighbor-state-2way", 
                            "when" : {
                                "matches-with" : [
                                {
                                    "left-operand" : "$ospf-neighbor-state", 
                                    "right-operand" : "2Way"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "OSPF neighbor is in 2Way state- check the MTU on OSPF interface"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "ACX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "11.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "11.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "SRX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }, 
                        "helper-files" : [
                        {
                            "file-type" : "other", 
                            "list-of-files" : ["ospf.yml"]
                        }
                        ]
                    }
                }, 
                {
                    "rule-name" : "check-ospf-neighbor-state", 
                    "keys" : ["Address"],
                    "synopsis" : "ospf session state analyzer", 
                    "description" : "This rule collects ospf session state periodically and notifies in case of anomalies", 
                    "sensor" : [
                    {
                        "sensor-name" : "ospf-neighbor", 
                        "synopsis" : "ospf netconf based iAgent sensor definition", 
                        "description" : "iAgent sensor defined in yml file using netconf rpc/cli command and defined fields using pyez tables&views to collect data from network device", 
                        "iAgent" : {
                            "file" : "ospf-neighbor.yml", 
                            "table" : "OspfNeighborTable", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "neighbor-address-expr", 
                        "constant" : {
                            "value" : "{{aeighbor-address}}"
                        }, 
                        "type" : "string", 
                        "description" : "This filed is for ospf neighbor address"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "ospf-neighbor-state", 
                        "synopsis" : "ospf neighbor state kpi", 
                        "description" : "Sets health based on ospf neighbor state.", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-neighbor-full", 
                            "when" : {
                                "matches-with" : [
                                {
                                    "left-operand" : "$neighbor_state", 
                                    "right-operand" : "Full"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "Ospf neighbor $neighbor_address state is $neighbor_state"
                                }
                            }
                        }, 
                        {
                            "term-name" : "is-neighbor-not-full", 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Ospf neighbor $neighbor_address state is $neighbor_state"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "aeighbor-address", 
                        "value" : ".*", 
                        "description" : "Enter required ospf neighbor ids to be monitored using regular expression", 
                        "type" : "string"
                    }
                    ]
                }, 
                {
                    "rule-name" : "check-ospf-statistics-information", 
                    "keys" : ["ospf-packet-type"],
                    "synopsis" : "ospf hello statistics analyzer", 
                    "description" : "Monitors the transmission and reception of hello packets", 
                    "sensor" : [
                    {
                        "sensor-name" : "protocol-ospf-statistics-information", 
                        "synopsis" : "OSPF iAgent sensor definition", 
                        "description" : "Netconfig rpc get-ospf-neighbor-information iAgent sensor to collect telemetry data from network device", 
                        "iAgent" : {
                            "file" : "ospf.yml", 
                            "table" : "OspfStats", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "protocol-ospf-statistics-information-hello-received", 
                        "synopsis" : "ospf hello received statistics kpi", 
                        "description" : "Sets health based on ospf hello received statistics", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-ospf-hello-receive-increasing", 
                            "when" : {
                                "min-rate-of-increase" : [
                                {
                                    "field-name" : "$hello-received", 
                                    "rate" : "1", 
                                    "time-range" : "5m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "RPD OSPF receive module is functioning"
                                }
                            }
                        }, 
                        {
                            "term-name" : "is-ospf-hello-receive-not-increasing", 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "RPD OSPF receive module is not functioning"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "protocol-ospf-statistics-information-hello-sent", 
                        "synopsis" : "ospf hello sent statistics kpi", 
                        "description" : "Sets health based on ospf hello sent statistics", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-ospf-hello-sent-increasing", 
                            "when" : {
                                "min-rate-of-increase" : [
                                {
                                    "field-name" : "$hello-sent", 
                                    "rate" : "1", 
                                    "time-range" : "5m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "RPD OSPF send module is functioning"
                                }
                            }
                        }, 
                        {
                            "term-name" : "is-ospf-hello-sent-not-increasing", 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "RPD OSPF send module is not functioning"
                                }
                            }
                        }
                        ]
                    }
                    ]
                }, 
                {
                    "rule-name" : "fpc-link-stats", 
                    "keys" : ["target"],
                    "synopsis" : "ospf session hello statistics analyzer", 
                    "description" : "This topic is to monitors and notify OSPF sessions hello packet statitics", 
                    "sensor" : [
                    {
                        "sensor-name" : "fpclinkstats", 
                        "synopsis" : "iAgent sensor definition", 
                        "description" : "Netconf command show link stats iAgent sensor to collect telemetry data from network device", 
                        "iAgent" : {
                            "file" : "fpc_link_stats.yml", 
                            "table" : "FPCLinkStats", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "ospf-hello-increasing", 
                        "synopsis" : "OSPF hello packet kpi", 
                        "description" : "Sets health based on OSPF hello packets received", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "monotonically-increasing", 
                            "when" : {
                                "min-rate-of-increase" : [
                                {
                                    "field-name" : "$OSPF_Hello", 
                                    "rate" : "1", 
                                    "time-range" : "5m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "OSPF Hello packets received on $target within the last 60 seconds."
                                }
                            }
                        }, 
                        {
                            "term-name" : "not-increasing", 
                            "when" : {
                                "equal-to" : [
                                {
                                    "left-operand" : "True", 
                                    "right-operand" : "True"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "OSPF Hello packets *not* received on $target within the last 60 seconds."
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "ACX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "SRX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }, 
                        "helper-files" : [
                        {
                            "file-type" : "other", 
                            "list-of-files" : ["fpc_link_stats.yml"]
                        }
                        ]
                    }
                }, 
                {
                    "rule-name" : "pfe-ddos-policer", 
                    "keys" : ["location", "protocol", "target"],
                    "synopsis" : "ospf session ddos analyzer", 
                    "description" : "This rule collects ospf ddos policer stats periodically and notifies in case of anomalies", 
                    "sensor" : [
                    {
                        "sensor-name" : "ddospolicerstatstable", 
                        "synopsis" : "ospf netconf based iAgent sensor definition", 
                        "description" : "Netconf command show ddos policer stats iAgent sensor to collect telemetry data from network device", 
                        "iAgent" : {
                            "file" : "pfe-ddos-policer.yml", 
                            "table" : "DdosPolicerStatsTable", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "arrival", 
                        "synopsis" : "ospf hello packets kpi", 
                        "description" : "Sets health based on ospf packets received.", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "nothing-arrived", 
                            "when" : {
                                "equal-to" : [
                                {
                                    "left-operand" : "$pass", 
                                    "right-operand" : "0"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "No OSPF packets received."
                                }
                            }
                        }, 
                        {
                            "term-name" : "incrementing", 
                            "when" : {
                                "min-rate-of-increase" : [
                                {
                                    "field-name" : "$pass", 
                                    "rate" : "1", 
                                    "time-range" : "5m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "OSPF packets received in the last 60 seconds"
                                }
                            }
                        }, 
                        {
                            "term-name" : "not-incrementing", 
                            "when" : {
                                "matches-with" : [
                                {
                                    "left-operand" : "True", 
                                    "right-operand" : "True"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "OSPF packets stopped arriving."
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "drop", 
                        "synopsis" : "ospf hello packets kpi", 
                        "description" : "Sets health based on ospf packets dropped.", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "drops-increasing", 
                            "when" : {
                                "min-rate-of-increase" : [
                                {
                                    "field-name" : "$drop", 
                                    "rate" : "1", 
                                    "time-range" : "5m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "OSPF packets dropped in the last 60 seconds"
                                }
                            }
                        }, 
                        {
                            "term-name" : "not-increasing", 
                            "when" : {
                                "matches-with" : [
                                {
                                    "left-operand" : "True", 
                                    "right-operand" : "True"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "No OSPF packets dropped in the last 60 seconds."
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "pass-versus-arrival", 
                        "synopsis" : "ospf hello packets kpi", 
                        "description" : "Sets health based on ospf packets arrive rate.", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "equal", 
                            "when" : {
                                "equal-to" : [
                                {
                                    "left-operand" : "$arrival_rate", 
                                    "right-operand" : "$pass_rate"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "OSPF Arrival rate is equal to the Pass rate."
                                }
                            }
                        }, 
                        {
                            "term-name" : "less-than", 
                            "when" : {
                                "less-than" : [
                                {
                                    "left-operand" : "$pass_rate", 
                                    "right-operand" : "$arrival_rate"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "OSPF Arrival rate is less than the Pass rate."
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "ACX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "SRX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }, 
                        "helper-files" : [
                        {
                            "file-type" : "other", 
                            "list-of-files" : ["pfe-ddos-policer.yml"]
                        }
                        ]
                    }
                }
                ]
            }, 
            {
                "topic-name" : "protocol.routesummary", 
                "description" : "Monitors each forwarding table and each protocol route count and sets dynamic thresholds and notify anomaly when route count is abnormal", 
                "synopsis" : "FIB route tables and protocols statistics analyzer", 
                "rule" : [
                {
                    "rule-name" : "check-ascertain-routes", 
                    "keys" : ["table-name"],
                    "synopsis" : "Routing table statistics analyzer", 
                    "description" : "Collects total-route-count of each routing table and sets dynamic thresholds and notify anomaly when route count is abnormal", 
                    "sensor" : [
                    {
                        "sensor-name" : "route-summary", 
                        "synopsis" : "Get routing table statistics using iAgent sensor", 
                        "description" : "Get routing table statistics through -show route summary- command", 
                        "iAgent" : {
                            "file" : "route-summary.yml", 
                            "table" : "RouteSummaryTable", 
                            "frequency" : "10m"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "route-count-dynamic-threshold", 
                        "formula" : {
                            "dynamic-threshold" : {
                                "algorithm" : "k-means", 
                                "learning-period" : "7d", 
                                "pattern-periodicity" : "1h", 
                                "field-name" : "$total-route-count"
                            }
                        }, 
                        "type" : "integer", 
                        "description" : "Detects anomaly dynamically using kmeans algorithm"
                    }, 
                    {
                        "field-name" : "table-name", 
                        "sensor" : [
                        {
                            "sensor-name" : "route-summary", 
                            "where" : [
                            {
                                "query" : "table-name =~ /^{{route-table-name}}$/"
                            }
                            ], 
                            "path" : "table-name"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "Route-table to monitor"
                    }, 
                    {
                        "field-name" : "threshold", 
                        "constant" : {
                            "value" : "{{route-count-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "Route count static threshold"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "route-table-total-routes-count", 
                        "synopsis" : "Routing table route count KPI", 
                        "description" : "Sets health based on increase or drop in route count of each routing table", 
                        "frequency" : "10m", 
                        "term" : [
                        {
                            "term-name" : "is-route-count-abnormal", 
                            "when" : {
                                "greater-than-or-equal-to" : [
                                {
                                    "left-operand" : "$total-route-count", 
                                    "right-operand" : "$threshold", 
                                    "time-range" : "30m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Anomaly detected: Route table($table-name) total route count($total-route-count) is abnormal"
                                }
                            }
                        }, 
                        {
                            "term-name" : "above-dynamic-threshold", 
                            "when" : {
                                "equal-to" : [
                                {
                                    "left-operand" : "$route-count-dynamic-threshold", 
                                    "right-operand" : "1", 
                                    "time-range" : "30m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "Route table($table-name) total route count($total-route-count) is above dynamic threshold"
                                }
                            }
                        }, 
                        {
                            "term-name" : "route-count-normal", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "Route table($table-name) total route count($total-route-count) is normal"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "route-count-threshold", 
                        "value" : "10000", 
                        "description" : "Route table's route-count threshold", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "route-table-name", 
                        "value" : ".+", 
                        "description" : "Route table specific routes, regular expression, e.g. 'inet.0|inet6.0|vpn_1.inet6.0'", 
                        "type" : "string"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "ACX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "11.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "11.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "SRX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }, 
                        "helper-files" : [
                        {
                            "file-type" : "other", 
                            "list-of-files" : ["route-summary.yml"]
                        }
                        ]
                    }
                }, 
                {
                    "rule-name" : "check-fib-summary", 
                    "keys" : ["address-family", "enabled-protocols", "logical-system-name", "route-table-type", "table-name"],
                    "synopsis" : "Forwarding-table protocols routes statistics analyzer", 
                    "description" : "Collects forwarding-table's total-route-count of each protocol and sets dynamic thresholds and notify anomaly when route count is abnormal", 
                    "sensor" : [
                    {
                        "sensor-name" : "fib-sensor", 
                        "synopsis" : "FIB iAgent sensor definition", 
                        "description" : "iAgent sensor collect forwarding-table route-count stats from network device", 
                        "iAgent" : {
                            "file" : "fib.yml", 
                            "table" : "FibSummaryTable", 
                            "frequency" : "10m"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "address-family", 
                        "sensor" : [
                        {
                            "sensor-name" : "fib-sensor", 
                            "where" : [
                            {
                                "query" : "address-family =~ /^{{route-address-family}}$/"
                            }
                            ], 
                            "path" : "address-family"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "Address family name to be monitored"
                    }, 
                    {
                        "field-name" : "dt-route-count", 
                        "formula" : {
                            "dynamic-threshold" : {
                                "algorithm" : "k-means", 
                                "learning-period" : "7d", 
                                "pattern-periodicity" : "1h", 
                                "field-name" : "$route-count"
                            }
                        }, 
                        "type" : "integer", 
                        "description" : "Detects anamoly dynamically using kmeans algorithm"
                    }, 
                    {
                        "field-name" : "route-table-type", 
                        "sensor" : [
                        {
                            "sensor-name" : "fib-sensor", 
                            "where" : [
                            {
                                "query" : "route-table-type =~ /^{{table-type}}$/"
                            }
                            ], 
                            "path" : "route-table-type"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "Route table type to be monitored"
                    }, 
                    {
                        "field-name" : "table-name", 
                        "sensor" : [
                        {
                            "sensor-name" : "fib-sensor", 
                            "where" : [
                            {
                                "query" : "table-name =~ /^{{route-table-name}}$/"
                            }
                            ], 
                            "path" : "table-name"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "Route table name to be monitored"
                    }, 
                    {
                        "field-name" : "threshold", 
                        "constant" : {
                            "value" : "{{route-count-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "Route count static threshold"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "fib-route-count", 
                        "frequency" : "10m", 
                        "term" : [
                        {
                            "term-name" : "is-route-count-abnormal", 
                            "when" : {
                                "greater-than-or-equal-to" : [
                                {
                                    "left-operand" : "$route-count", 
                                    "right-operand" : "$threshold", 
                                    "time-range" : "30m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Route count of $table-name of $address-family of $route-table-type is ($route-count) abnormal"
                                }
                            }
                        }, 
                        {
                            "term-name" : "is-route-count-above-dt", 
                            "when" : {
                                "equal-to" : [
                                {
                                    "left-operand" : "$dt-route-count", 
                                    "right-operand" : "1", 
                                    "time-range" : "30m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "Route count of $table-name of $address-family of $route-table-type is ($route-count) is above dynamic threshold"
                                }
                            }
                        }, 
                        {
                            "term-name" : "route-count-normal", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "Route count of $table-name of $address-family of $route-table-type is ($route-count) normal"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "route-address-family", 
                        "value" : ".+", 
                        "description" : "address-family names to monitor, regular expression, eg 'Internet|Internet6|MPLS|VPLS'", 
                        "type" : "string"
                    }, 
                    {
                        "name" : "route-count-threshold", 
                        "value" : "10000", 
                        "description" : "Forwarding table's each protocol's route count threshold", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "route-table-name", 
                        "value" : ".+", 
                        "description" : "route table names to monitor, regular expression, eg 'default.inet|default.inet6|vpn_0.inet'", 
                        "type" : "string"
                    }, 
                    {
                        "name" : "table-type", 
                        "value" : ".+", 
                        "description" : "route table types to monitor, regular expression, eg 'perm|intf|user'", 
                        "type" : "string"
                    }
                    ]
                }, 
                {
                    "rule-name" : "check-protocol-route-count", 
                    "keys" : ["protocol-name", "table-name"],
                    "synopsis" : "Protocols routes statistics analyzer", 
                    "description" : "Collects total-route-count of each protocol and sets dynamic thresholds and notify anomaly when route count is abnormal", 
                    "sensor" : [
                    {
                        "sensor-name" : "route-protocol-summary", 
                        "synopsis" : "Get routing table protocol statistics using iAgent sensor", 
                        "description" : "Get routing table statistics through -show route summary- command and filters protocols in each routing table", 
                        "iAgent" : {
                            "file" : "route-protocol-summary.yml", 
                            "table" : "RouteProtocolsTable", 
                            "frequency" : "10m"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "protocol-name", 
                        "sensor" : [
                        {
                            "sensor-name" : "route-protocol-summary", 
                            "where" : [
                            {
                                "query" : "protocol-name =~ /^{{route-protocol-name}}$/"
                            }
                            ], 
                            "path" : "protocol-name"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "Protocol to monitor"
                    }, 
                    {
                        "field-name" : "route-count-dynamic-threshold", 
                        "formula" : {
                            "dynamic-threshold" : {
                                "algorithm" : "k-means", 
                                "learning-period" : "7d", 
                                "pattern-periodicity" : "1h", 
                                "field-name" : "$protocol-route-count"
                            }
                        }, 
                        "type" : "integer", 
                        "description" : "Detects anamoly dynamically using kmeans algorithm"
                    }, 
                    {
                        "field-name" : "table-name", 
                        "sensor" : [
                        {
                            "sensor-name" : "route-protocol-summary", 
                            "where" : [
                            {
                                "query" : "table-name =~ /^{{route-table-name}}$/"
                            }
                            ], 
                            "path" : "table-name"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "Route-table to monitor"
                    }, 
                    {
                        "field-name" : "threshold", 
                        "constant" : {
                            "value" : "{{route-count-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "Route count static threshold"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "protocol-routes-count", 
                        "synopsis" : "Protocol route count check KPI", 
                        "description" : "Sets health based on increase or drop in route count of each protocol", 
                        "frequency" : "10m", 
                        "term" : [
                        {
                            "term-name" : "above-static-threshold", 
                            "when" : {
                                "greater-than-or-equal-to" : [
                                {
                                    "left-operand" : "$protocol-route-count", 
                                    "right-operand" : "$threshold", 
                                    "time-range" : "60s"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Anomaly detected: Protocol $protocol-name of route-table ($table-name) route count($protocol-route-count) is abnormal"
                                }
                            }
                        }, 
                        {
                            "term-name" : "above-dynamic-threshold", 
                            "when" : {
                                "equal-to" : [
                                {
                                    "left-operand" : "$route-count-dynamic-threshold", 
                                    "right-operand" : "1", 
                                    "time-range" : "35m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "Anomaly detected: Protocol $protocol-name of route-table ($table-name) route count($protocol-route-count) is above dynamic threshold"
                                }
                            }
                        }, 
                        {
                            "term-name" : "protocol-route-count-ok", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "Protocol $protocol-name of route-table ($table-name) route count($protocol-route-count)is normal"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "route-count-threshold", 
                        "value" : "10000", 
                        "description" : "Route table's route-count threshold", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "route-protocol-name", 
                        "value" : ".+", 
                        "description" : "Route table specific routes, regular expression, e.g. 'BGP|RSVP|IS-ISI'", 
                        "type" : "string"
                    }, 
                    {
                        "name" : "route-table-name", 
                        "value" : ".+", 
                        "description" : "Route table specific routes, regular expression, e.g. 'inet.0|inet6.0|vpn_1.inet6.0'", 
                        "type" : "string"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "ACX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "11.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "11.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "SRX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }, 
                        "helper-files" : [
                        {
                            "file-type" : "other", 
                            "list-of-files" : ["route-protocol-summary.yml"]
                        }
                        ]
                    }
                }
                ]
            }, 
            {
                "topic-name" : "service.protocols", 
                "description" : "Rules related to PPPoE statistics monitoring of a JUNOS Broadband Network Gateway (BNG)", 
                "synopsis" : "BNG PPPoE error statistics monitoring rules", 
                "rule" : [
                {
                    "rule-name" : "pppoe-error-statistics", 
                    "synopsis" : "Monitors PPPoE error statistics", 
                    "description" : "Collects the PPPoE error periodically and notifies in case of anomalies", 
                    "sensor" : [
                    {
                        "sensor-name" : "pppoe-error-statistics", 
                        "synopsis" : "subscriber-management open-config sensor definition", 
                        "description" : "subscriber-management open-config sensor to collect telemetry data from network device", 
                        "open-config" : {
                            "sensor-name" : "/junos/system/subscriber-management/client-protocols/pppoe/statistics", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "ac-error-received", 
                        "sensor" : [
                        {
                            "sensor-name" : "pppoe-error-statistics", 
                            "path" : "/junos/system/subscriber-management/client-protocols/pppoe/statistics/ac-error-received"
                        }
                        ], 
                        "type" : "integer", 
                        "description" : "Number of ac-error-received"
                    }, 
                    {
                        "field-name" : "ac-error-sent", 
                        "sensor" : [
                        {
                            "sensor-name" : "pppoe-error-statistics", 
                            "path" : "/junos/system/subscriber-management/client-protocols/pppoe/statistics/ac-error-sent"
                        }
                        ], 
                        "type" : "integer", 
                        "description" : "Number of ac-error-sent"
                    }, 
                    {
                        "field-name" : "generic-error-received", 
                        "sensor" : [
                        {
                            "sensor-name" : "pppoe-error-statistics", 
                            "path" : "/junos/system/subscriber-management/client-protocols/pppoe/statistics/generic-error-received"
                        }
                        ], 
                        "type" : "integer", 
                        "description" : "Number of generic-error-received"
                    }, 
                    {
                        "field-name" : "generic-error-sent", 
                        "sensor" : [
                        {
                            "sensor-name" : "pppoe-error-statistics", 
                            "path" : "/junos/system/subscriber-management/client-protocols/pppoe/statistics/generic-error-sent"
                        }
                        ], 
                        "type" : "integer", 
                        "description" : "Number of generic-error-sent"
                    }, 
                    {
                        "field-name" : "malformed-pkts-rx", 
                        "sensor" : [
                        {
                            "sensor-name" : "pppoe-error-statistics", 
                            "path" : "/junos/system/subscriber-management/client-protocols/pppoe/statistics/malformed-packets-received"
                        }
                        ], 
                        "type" : "integer", 
                        "description" : "Number of malformed-packets-rec"
                    }, 
                    {
                        "field-name" : "min-rate-of-increase", 
                        "constant" : {
                            "value" : "{{min-value-of-increase}}"
                        }, 
                        "type" : "integer", 
                        "description" : "Minimum value of increase in 3 minutes"
                    }, 
                    {
                        "field-name" : "service-error-received", 
                        "sensor" : [
                        {
                            "sensor-name" : "pppoe-error-statistics", 
                            "path" : "/junos/system/subscriber-management/client-protocols/pppoe/statistics/service-error-received"
                        }
                        ], 
                        "type" : "integer", 
                        "description" : "service-error-received"
                    }, 
                    {
                        "field-name" : "service-error-sent", 
                        "sensor" : [
                        {
                            "sensor-name" : "pppoe-error-statistics", 
                            "path" : "/junos/system/subscriber-management/client-protocols/pppoe/statistics/service-error-sent"
                        }
                        ], 
                        "type" : "integer", 
                        "description" : "Number of service-error-sent"
                    }, 
                    {
                        "field-name" : "unknown-packets-received", 
                        "sensor" : [
                        {
                            "sensor-name" : "pppoe-error-statistics", 
                            "path" : "/junos/system/subscriber-management/client-protocols/pppoe/statistics/unknown-packets-received"
                        }
                        ], 
                        "type" : "integer", 
                        "description" : "Number of unknown-packets-received"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "ac-error-received", 
                        "synopsis" : "PPPoE ac-error-received kpi", 
                        "description" : "Sets health based on the change in ac-error-received count", 
                        "frequency" : "90s", 
                        "term" : [
                        {
                            "term-name" : "is-error-increasing", 
                            "when" : {
                                "increasing-at-least-by-value" : [
                                {
                                    "field-name" : "$ac-error-received", 
                                    "value" : "$min-rate-of-increase", 
                                    "time-range" : "3m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "PPPoE error statistics ac-error-received is increasing. Current value : $ac-error-received"
                                }
                            }
                        }, 
                        {
                            "term-name" : "default-term", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "PPPoE error statistics ac-error-received is not increasing. Current value : $ac-error-received"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "ac-error-sent", 
                        "synopsis" : "PPPoE ae-error-sent kpi", 
                        "description" : "Sets health based on the change in ae-error-sent count", 
                        "frequency" : "90s", 
                        "term" : [
                        {
                            "term-name" : "is-error-increasing", 
                            "when" : {
                                "increasing-at-least-by-value" : [
                                {
                                    "field-name" : "$ac-error-sent", 
                                    "value" : "$min-rate-of-increase", 
                                    "time-range" : "3m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "PPPoE error statistics ac-error-sent is increasing. Current value : $ac-error-sent"
                                }
                            }
                        }, 
                        {
                            "term-name" : "default-term", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "PPPoE error statistics ac-error-sent is not increasing. Current value : $ac-error-sent"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "generic-error-received", 
                        "synopsis" : "PPPoE generic-error-received kpi", 
                        "description" : "Sets health based on the change in generic-error-received count", 
                        "frequency" : "90s", 
                        "term" : [
                        {
                            "term-name" : "is-error-increasing", 
                            "when" : {
                                "increasing-at-least-by-value" : [
                                {
                                    "field-name" : "$generic-error-received", 
                                    "value" : "$min-rate-of-increase", 
                                    "time-range" : "3m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "PPPoE error statistics generic-error-received is increasing. Current value : $generic-error-received"
                                }
                            }
                        }, 
                        {
                            "term-name" : "default-term", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "PPPoE error statistics generic-error-received is not increasing. Current value : $generic-error-received"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "generic-error-sent", 
                        "synopsis" : "PPPoE generic-error-sent kpi", 
                        "description" : "Sets health based on the change in generic-error-sent count", 
                        "frequency" : "90s", 
                        "term" : [
                        {
                            "term-name" : "is-error-increasing", 
                            "when" : {
                                "increasing-at-least-by-value" : [
                                {
                                    "field-name" : "$generic-error-sent", 
                                    "value" : "$min-rate-of-increase", 
                                    "time-range" : "3m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "PPPoE error statistics generic-error-sent is increasing. Current value : $generic-error-sent"
                                }
                            }
                        }, 
                        {
                            "term-name" : "default-term", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "PPPoE error statistics generic-error-sent is not increasing. Current value : $generic-error-sent"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "malformed-packets-rx", 
                        "synopsis" : "PPPoE malformed-packets-recived kpi", 
                        "description" : "Sets health based on the change in malformed-packets-recived count", 
                        "frequency" : "90s", 
                        "term" : [
                        {
                            "term-name" : "is-error-increasing", 
                            "when" : {
                                "increasing-at-least-by-value" : [
                                {
                                    "field-name" : "$malformed-pkts-rx", 
                                    "value" : "$min-rate-of-increase", 
                                    "time-range" : "3m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "PPPoE error statistics malformed-packets-recived is increasing. Current value : $malformed-pkts-rx"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "service-error-received", 
                        "synopsis" : "PPPoE service-error-received kpi", 
                        "description" : "Sets health based on the change in service-error-received count", 
                        "frequency" : "90s", 
                        "term" : [
                        {
                            "term-name" : "is-error-increasing", 
                            "when" : {
                                "increasing-at-least-by-value" : [
                                {
                                    "field-name" : "$service-error-received", 
                                    "value" : "$min-rate-of-increase", 
                                    "time-range" : "3m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "PPPoE error statistics service-error-received is increasing. Current value : $service-error-received"
                                }
                            }
                        }, 
                        {
                            "term-name" : "default-term", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "PPPoE error statistics service-error-received is not increasing. Current value : $service-error-received"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "service-error-sent", 
                        "synopsis" : "PPPoE service-error-sent kpi", 
                        "description" : "Sets health based on the change in service-error-sent count", 
                        "frequency" : "90s", 
                        "term" : [
                        {
                            "term-name" : "is-error-increasing", 
                            "when" : {
                                "increasing-at-least-by-value" : [
                                {
                                    "field-name" : "$service-error-sent", 
                                    "value" : "$min-rate-of-increase", 
                                    "time-range" : "3m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "PPPoE error statistics service-error-sent is increasing. Current value : $service-error-sent"
                                }
                            }
                        }, 
                        {
                            "term-name" : "default-term", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "PPPoE error statistics service-error-sent is not increasing. Current value : $service-error-sent"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "min-value-of-increase", 
                        "value" : "10", 
                        "description" : "Minimum value of increase in 3 minutes", 
                        "type" : "int"
                    }
                    ]
                }
                ]
            }, 
            {
                "topic-name" : "service.subscribers", 
                "description" : "Rules related to subscribers address pool utilization", 
                "synopsis" : "BNG subscribers address pool monitoring rules", 
                "rule" : [
                {
                    "rule-name" : "chk-addr-pool-util", 
                    "keys" : ["lsri-name", "pool-name"],
                    "synopsis" : "single pool utilization", 
                    "description" : "single pool utilization, also collects info on linked pools", 
                    "sensor" : [
                    {
                        "sensor-name" : "pool", 
                        "synopsis" : "subscriber-management open-config sensor definition", 
                        "description" : "subscriber-management open-config sensor to collect telemetry data from network device", 
                        "open-config" : {
                            "sensor-name" : "/junos/system/subscriber-management/aaa/address-assignment-statistics/logical-system-routing-instances/logical-system-routing-instance/pools/pool", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "address-in-use", 
                        "sensor" : [
                        {
                            "sensor-name" : "pool", 
                            "path" : "/junos/system/subscriber-management/aaa/address-assignment-statistics/logical-system-routing-instances/logical-system-routing-instance/pools/pool/address-in-use"
                        }
                        ], 
                        "type" : "integer", 
                        "description" : "address-in-use field"
                    }, 
                    {
                        "field-name" : "address-total", 
                        "sensor" : [
                        {
                            "sensor-name" : "pool", 
                            "path" : "/junos/system/subscriber-management/aaa/address-assignment-statistics/logical-system-routing-instances/logical-system-routing-instance/pools/pool/address-total"
                        }
                        ], 
                        "type" : "integer", 
                        "description" : "address-total field"
                    }, 
                    {
                        "field-name" : "address-usage-ml", 
                        "formula" : {
                            "dynamic-threshold" : {
                                "algorithm" : "3sigma", 
                                "learning-period" : "1d", 
                                "pattern-periodicity" : "1h", 
                                "field-name" : "$address-usage-percent"
                            }
                        }, 
                        "type" : "integer", 
                        "description" : "Value calculated based on 3sigma algorithm"
                    }, 
                    {
                        "field-name" : "address-usage-percent", 
                        "sensor" : [
                        {
                            "sensor-name" : "pool", 
                            "path" : "/junos/system/subscriber-management/aaa/address-assignment-statistics/logical-system-routing-instances/logical-system-routing-instance/pools/pool/address-usage-percent"
                        }
                        ], 
                        "type" : "integer", 
                        "description" : "address-usage-percent field"
                    }, 
                    {
                        "field-name" : "linked-pool", 
                        "sensor" : [
                        {
                            "sensor-name" : "pool", 
                            "where" : [
                            {
                                "query" : "/junos/system/subscriber-management/aaa/address-assignment-statistics/logical-system-routing-instances/logical-system-routing-instance/pools/pool/linked-pool-head =~ /{{filter-linked-pool-head}}/"
                            }
                            ], 
                            "path" : "/junos/system/subscriber-management/aaa/address-assignment-statistics/logical-system-routing-instances/logical-system-routing-instance/pools/pool/linked-pool-name"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "linked-pool-name field"
                    }, 
                    {
                        "field-name" : "linked-pool-head", 
                        "sensor" : [
                        {
                            "sensor-name" : "pool", 
                            "path" : "/junos/system/subscriber-management/aaa/address-assignment-statistics/logical-system-routing-instances/logical-system-routing-instance/pools/pool/linked-pool-head"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "linked-pool-head name field"
                    }, 
                    {
                        "field-name" : "lsri-name", 
                        "sensor" : [
                        {
                            "sensor-name" : "pool", 
                            "where" : [
                            {
                                "query" : "/junos/system/subscriber-management/aaa/address-assignment-statistics/logical-system-routing-instances/logical-system-routing-instance/@name =~ /{{filter-lsri-name}}/"
                            }
                            ], 
                            "path" : "/junos/system/subscriber-management/aaa/address-assignment-statistics/logical-system-routing-instances/logical-system-routing-instance/@name"
                        }
                        ], 
                        "description" : "logical system routing instance name"
                    }, 
                    {
                        "field-name" : "pool-name", 
                        "sensor" : [
                        {
                            "sensor-name" : "pool", 
                            "where" : [
                            {
                                "query" : "/junos/system/subscriber-management/aaa/address-assignment-statistics/logical-system-routing-instances/logical-system-routing-instance/pools/pool/@pool-name =~ /{{filter-pool-name}}/"
                            }
                            ], 
                            "path" : "/junos/system/subscriber-management/aaa/address-assignment-statistics/logical-system-routing-instances/logical-system-routing-instance/pools/pool/@pool-name"
                        }
                        ], 
                        "description" : "pool name to monitor"
                    }, 
                    {
                        "field-name" : "utilization-max-threshold", 
                        "constant" : {
                            "value" : "{{pool-utilization-max-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "address pool utilization max threshold"
                    }, 
                    {
                        "field-name" : "utilization-min-threshold", 
                        "constant" : {
                            "value" : "{{pool-utilization-min-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "address pool utilization min threshold"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "pool-utilization", 
                        "synopsis" : "address pool utilization kpi", 
                        "description" : "Sets health based on address pool utilization", 
                        "frequency" : "90s", 
                        "term" : [
                        {
                            "term-name" : "is-utilization-abnormal", 
                            "when" : {
                                "greater-than" : [
                                {
                                    "left-operand" : "$address-usage-percent", 
                                    "right-operand" : "$utilization-max-threshold"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Pool $pool-name  ( Pool head : $linked-pool-head) utilization % ($address-usage-percent) is abnormal"
                                }
                            }
                        }, 
                        {
                            "term-name" : "utilization-abnormal-ls", 
                            "when" : {
                                "less-than" : [
                                {
                                    "left-operand" : "$address-usage-percent", 
                                    "right-operand" : "$utilization-min-threshold"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Pool $pool-name  ( Pool head : $linked-pool-head) utilization % ($address-usage-percent) is abnormal"
                                }
                            }
                        }, 
                        {
                            "term-name" : "utilization-abnormal-ml", 
                            "when" : {
                                "equal-to" : [
                                {
                                    "left-operand" : "$address-usage-ml", 
                                    "right-operand" : "1", 
                                    "time-range" : "5m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "Pool $pool-name  ( Pool head : $linked-pool-head) utilization % ($address-usage-percent) is abnormal based on ML algorithm"
                                }
                            }
                        }, 
                        {
                            "term-name" : "pool-util-normal", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "Pool $pool-name ( Pool head : $linked-pool-head) utilization % ($address-usage-percent) is normal"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "filter-linked-pool-head", 
                        "value" : ".*", 
                        "description" : "address pool header name", 
                        "type" : "string"
                    }, 
                    {
                        "name" : "filter-lsri-name", 
                        "value" : ".*", 
                        "description" : "logical system routing instance name", 
                        "type" : "string"
                    }, 
                    {
                        "name" : "filter-pool-name", 
                        "value" : ".*", 
                        "description" : "address pool name", 
                        "type" : "string"
                    }, 
                    {
                        "name" : "pool-utilization-max-threshold", 
                        "value" : "85", 
                        "description" : "address pool utilization maximum threshold value", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "pool-utilization-min-threshold", 
                        "value" : "10", 
                        "description" : "address pool utilization minimum threshold value", 
                        "type" : "int"
                    }
                    ]
                }, 
                {
                    "rule-name" : "linked-address-pool", 
                    "synopsis" : "linked address pool utilization analyzer", 
                    "description" : "Monitors linked address pool usage percentage and notifies anomalies", 
                    "rule-frequency" : "90s", 
                    "function" : [
                    {
                        "function-name" : "mean-pool-utilization", 
                        "path" : "mean-pool-utilization.py", 
                        "method" : "mean_pool_utilization", 
                        "argument" : [
                        {
                            "argument-name" : "list_pool_vector", 
                            "mandatory" : [null]
                        }
                        ]
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "linked-pool-head", 
                        "constant" : {
                            "value" : "{{filter-linked-pool-head}}"
                        }, 
                        "type" : "string", 
                        "description" : "linked-pool-head name field"
                    }, 
                    {
                        "field-name" : "mean-pool-utilization", 
                        "formula" : {
                            "user-defined-function" : {
                                "function-name" : "mean-pool-utilization", 
                                "argument" : [
                                {
                                    "argument" : "list_pool_vector", 
                                    "value" : "@list-pool-utilization"
                                }
                                ]
                            }
                        }, 
                        "type" : "integer", 
                        "description" : "average utilizaiton of linked address pool"
                    }, 
                    {
                        "field-name" : "mean-pool-utilization-ml", 
                        "formula" : {
                            "dynamic-threshold" : {
                                "algorithm" : "3sigma", 
                                "learning-period" : "1d", 
                                "pattern-periodicity" : "1h", 
                                "field-name" : "$mean-pool-utilization"
                            }
                        }, 
                        "type" : "integer", 
                        "description" : "Value calculated based on 3sigma algorithm"
                    }, 
                    {
                        "field-name" : "pool-maximum-utilization", 
                        "constant" : {
                            "value" : "{{pool-max-utilization}}"
                        }, 
                        "description" : "linked address pool utilization maximum threshold"
                    }, 
                    {
                        "field-name" : "pool-minimum-util", 
                        "constant" : {
                            "value" : "{{pool-min-utilization}}"
                        }, 
                        "description" : "linked address pool utilization minimum threshold"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "mean-pool-utilization", 
                        "synopsis" : "linked address pool utilization kpi", 
                        "description" : "Sets health based on linked address pool utilization", 
                        "frequency" : "120s", 
                        "term" : [
                        {
                            "term-name" : "is-mean-abnormal-gr", 
                            "when" : {
                                "greater-than" : [
                                {
                                    "left-operand" : "$mean-pool-utilization", 
                                    "right-operand" : "$pool-maximum-utilization"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Linked pool average utitilization($mean-pool-utilization) is abnormal."
                                }
                            }
                        }, 
                        {
                            "term-name" : "is-mean-abnormal-lt", 
                            "when" : {
                                "less-than" : [
                                {
                                    "left-operand" : "$mean-pool-utilization", 
                                    "right-operand" : "$pool-minimum-util"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Linked pool average utitilization($mean-pool-utilization) is abnormal."
                                }
                            }
                        }, 
                        {
                            "term-name" : "is-mean-abnormal-ml", 
                            "when" : {
                                "equal-to" : [
                                {
                                    "left-operand" : "$mean-pool-utilization-ml", 
                                    "right-operand" : "1", 
                                    "time-range" : "5m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "Linked pool average utitilization($mean-pool-utilization) is abnormal  based on ML algorithm"
                                }
                            }
                        }, 
                        {
                            "term-name" : "default-term", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "Linked pool average utitilization($mean-pool-utilization) is normal"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "filter-linked-pool-head", 
                        "value" : ".*", 
                        "description" : "address pool header name", 
                        "type" : "string"
                    }, 
                    {
                        "name" : "pool-max-utilization", 
                        "value" : "85", 
                        "description" : "linked address pool average utilization maximum threshold", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "pool-min-utilization", 
                        "value" : "10", 
                        "description" : "linked address pool average utilization minimum threshold", 
                        "type" : "int"
                    }
                    ], 
                    "vector" : [
                    {
                        "vector-name" : "list-pool-name", 
                        "path" : ["/topic[topic-name=service.subscribers]/rule[rule-name=chk-addr-pool-util]/field[linked-pool-head='{{filter-linked-pool-head}}']/pool-name"],
                        "time-range" : "90s"
                    }, 
                    {
                        "vector-name" : "list-pool-utilization", 
                        "path" : ["/topic[topic-name=service.subscribers]/rule[rule-name=chk-addr-pool-util]/field[linked-pool-head='{{filter-linked-pool-head}}']/address-usage-percent"],
                        "time-range" : "90s"
                    }
                    ]
                }, 
                {
                    "rule-name" : "monitor-subscriber-count", 
                    "synopsis" : "subscribers count statistics analyzer", 
                    "description" : "This rule collects total subscribers and notifies in case of anomalies", 
                    "sensor" : [
                    {
                        "sensor-name" : "total-subscribers", 
                        "synopsis" : "subscriber-management open-config sensor definition", 
                        "description" : "subscriber-management open-config sensor to collect telemetry data from network device", 
                        "open-config" : {
                            "sensor-name" : "/junos/system/subscriber-management/infra/resource-monitor/chassis", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "subscriber-count-maximum", 
                        "constant" : {
                            "value" : "{{subscriber-count-max}}"
                        }, 
                        "type" : "integer", 
                        "description" : "maximum total subscribers count"
                    }, 
                    {
                        "field-name" : "subscriber-count-minimum", 
                        "constant" : {
                            "value" : "{{subscriber-count-min}}"
                        }, 
                        "type" : "integer", 
                        "description" : "minimum total subscribers count"
                    }, 
                    {
                        "field-name" : "total-subscriber-count", 
                        "sensor" : [
                        {
                            "sensor-name" : "total-subscribers", 
                            "path" : "/junos/system/subscriber-management/infra/resource-monitor/chassis/current-subscriber-count"
                        }
                        ], 
                        "type" : "integer", 
                        "description" : "Number of subscribers in chassis"
                    }, 
                    {
                        "field-name" : "total-subscribers-pred", 
                        "formula" : {
                            "dynamic-threshold" : {
                                "algorithm" : "k-means", 
                                "learning-period" : "1d", 
                                "pattern-periodicity" : "1h", 
                                "field-name" : "$total-subscriber-count"
                            }
                        }, 
                        "type" : "integer", 
                        "description" : "Dynamic subscribers count threshold"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "total-subscribers-count", 
                        "synopsis" : "subscribers count threshold", 
                        "description" : "Sets health based on subscribers count", 
                        "frequency" : "90s", 
                        "term" : [
                        {
                            "term-name" : "subscriber-abnormal-gr", 
                            "when" : {
                                "greater-than" : [
                                {
                                    "left-operand" : "$total-subscriber-count", 
                                    "right-operand" : "$subscriber-count-maximum"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Total subscriber count is abnormal. Current total subscriber count is : $total-subscriber-count"
                                }
                            }
                        }, 
                        {
                            "term-name" : "subscriber-abnormal-ls", 
                            "when" : {
                                "less-than" : [
                                {
                                    "left-operand" : "$total-subscriber-count", 
                                    "right-operand" : "$subscriber-count-minimum"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Total subscriber count is abnormal. Current total subscriber count is : $total-subscriber-count"
                                }
                            }
                        }, 
                        {
                            "term-name" : "subscriber-abnormal-ml", 
                            "when" : {
                                "equal-to" : [
                                {
                                    "left-operand" : "$total-subscribers-pred", 
                                    "right-operand" : "1", 
                                    "time-range" : "5m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "Total subscriber count is abnormal according to ML algorithm. Current total subscriber count is : $total-subscriber-count"
                                }
                            }
                        }, 
                        {
                            "term-name" : "default-term", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "Total subscriber count is normal. Current total subscriber count is : $total-subscriber-count"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "subscriber-count-max", 
                        "value" : "60000", 
                        "description" : "maximum total subscribers count", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "subscriber-count-min", 
                        "value" : "10000", 
                        "description" : "Minimum total subscribers count count", 
                        "type" : "int"
                    }
                    ]
                }
                ]
            }, 
            {
                "topic-name" : "system.cpu", 
                "description" : "Monitors system statistics i.e. CPU, memory, storage, processes & queues and notifies anomalies", 
                "synopsis" : "System statistics analyzer", 
                "rule" : [
                {
                    "rule-name" : "check-system-cpu", 
                    "keys" : ["routing-engine"],
                    "synopsis" : "Routing engine CPU analyzer", 
                    "description" : "Collects system RE CPU statistics periodically and notifies anomalies when CPU utilization exceeds threshold", 
                    "function" : [
                    {
                        "function-name" : "subtract", 
                        "description" : "Subtracts cpu-idle% from 100 to get CPU used percent", 
                        "path" : "system-sensors.py", 
                        "method" : "subtract", 
                        "argument" : [
                        {
                            "argument-name" : "threshold", 
                            "mandatory" : [null]
                        }
                        ]
                    }
                    ], 
                    "sensor" : [
                    {
                        "sensor-name" : "components", 
                        "synopsis" : "system components open-config sensor definition", 
                        "description" : "/components open-config sensor to collect telemetry data from network device", 
                        "open-config" : {
                            "sensor-name" : "/components/", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "re-cpu-utilization", 
                        "formula" : {
                            "user-defined-function" : {
                                "function-name" : "subtract", 
                                "argument" : [
                                {
                                    "argument" : "threshold", 
                                    "value" : "$re-cpu-utilization-oc"
                                }
                                ]
                            }
                        }, 
                        "type" : "integer", 
                        "description" : "Derives used percentage from idle CPU utilization"
                    }, 
                    {
                        "field-name" : "re-cpu-utilization-high-threshold", 
                        "constant" : {
                            "value" : "{{re-cpu-high-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "RE CPU utilization high threshold"
                    }, 
                    {
                        "field-name" : "re-cpu-utilization-low-threshold", 
                        "constant" : {
                            "value" : "{{re-cpu-low-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "RE CPU utilization low threshold"
                    }, 
                    {
                        "field-name" : "re-cpu-utilization-oc", 
                        "sensor" : [
                        {
                            "sensor-name" : "components", 
                            "where" : [
                            {
                                "query" : "/components/component/properties/property/@name == 'cpu-utilization-idle'"
                            }
                            ], 
                            "path" : "/components/component/properties/property/state/value"
                        }
                        ], 
                        "description" : "RE CPU idle utilization"
                    }, 
                    {
                        "field-name" : "routing-engine", 
                        "sensor" : [
                        {
                            "sensor-name" : "components", 
                            "where" : [
                            {
                                "query" : "/components/component/@name =~ /^Routing Engine[{{re-slot-no}}]*$/"
                            }
                            ], 
                            "path" : "/components/component/@name"
                        }
                        ], 
                        "description" : "RE name to monitor"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "re-cpu-utilization", 
                        "synopsis" : "Routing engine CPU KPI", 
                        "description" : "Sets health based on increase in RE CPU utilization", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-re-cpu-utilization-abnormal", 
                            "when" : {
                                "greater-than-or-equal-to" : [
                                {
                                    "left-operand" : "$re-cpu-utilization", 
                                    "right-operand" : "$re-cpu-utilization-high-threshold", 
                                    "time-range" : "5m", 
                                    "all" : [null]
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "$routing-engine CPU utilization($re-cpu-utilization) exceeds high threshold($re-cpu-utilization-high-threshold)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "is-re-cpu-utilization-middle", 
                            "when" : {
                                "greater-than-or-equal-to" : [
                                {
                                    "left-operand" : "$re-cpu-utilization", 
                                    "right-operand" : "$re-cpu-utilization-low-threshold", 
                                    "time-range" : "5m", 
                                    "all" : [null]
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "$routing-engine CPU utilization($re-cpu-utilization) in medium range"
                                }
                            }
                        }, 
                        {
                            "term-name" : "re-cpu-utilization-normal", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "$routing-engine CPU utilization($re-cpu-utilization) is normal"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "re-cpu-high-threshold", 
                        "value" : "80", 
                        "description" : "RE CPU utilization high threshold: Utilization increase between metrics, before we report anomaly", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "re-cpu-low-threshold", 
                        "value" : "50", 
                        "description" : "RE CPU utilization low threshold: Utilization increase between metrics, before we report anomaly", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "re-slot-no", 
                        "value" : "0-1", 
                        "description" : "Routing engine numbers to monitor, regular expression, e.g. '0'", 
                        "type" : "string"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX9200"]
                                        }, 
                                        {
                                            "release-name" : "18.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX4650"]
                                        }, 
                                        {
                                            "release-name" : "18.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX4600"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "16.1R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["MX2010", "MX2020", "MX240", "MX480", "MX960"]
                                        }, 
                                        {
                                            "release-name" : "17.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["MX150"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["PTX1000", "PTX10000", "PTX5000"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX10000", "QFX5200"]
                                        }, 
                                        {
                                            "release-name" : "18.1R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX5100"]
                                        }, 
                                        {
                                            "release-name" : "18.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX5120-48Y"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }, 
                        "helper-files" : [
                        {
                            "file-type" : "other", 
                            "list-of-files" : ["system-sensors.py"]
                        }
                        ]
                    }
                }, 
                {
                    "rule-name" : "check-system-cpu-load-average", 
                    "keys" : ["slot"],
                    "synopsis" : "RE CPU load average analyzer", 
                    "description" : "Collects RE CPU load average data periodically and notifies anomalies when CPU utilization exceed threshold", 
                    "function" : [
                    {
                        "function-name" : "subtract", 
                        "description" : "function that tweaks thresholds by subtracting them from 100 so that CPU utilization can be found from cpu-idle%", 
                        "path" : "system-sensors.py", 
                        "method" : "subtract", 
                        "argument" : [
                        {
                            "argument-name" : "threshold", 
                            "mandatory" : [null]
                        }
                        ]
                    }
                    ], 
                    "sensor" : [
                    {
                        "sensor-name" : "cpuutilizationtable", 
                        "synopsis" : "Routing engines CPU iAgent sensor definition", 
                        "description" : "iAgent netconf rpc/cli command sensor to collect data from network device", 
                        "iAgent" : {
                            "file" : "system-cpu.yml", 
                            "table" : "CPUutilizationTable", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "cpu-15min", 
                        "formula" : {
                            "user-defined-function" : {
                                "function-name" : "subtract", 
                                "argument" : [
                                {
                                    "argument" : "threshold", 
                                    "value" : "$cpu-idle-15min"
                                }
                                ]
                            }
                        }, 
                        "type" : "integer", 
                        "description" : "Derives CPU used percentage using UDF"
                    }, 
                    {
                        "field-name" : "cpu-1min", 
                        "formula" : {
                            "user-defined-function" : {
                                "function-name" : "subtract", 
                                "argument" : [
                                {
                                    "argument" : "threshold", 
                                    "value" : "$cpu-idle-1min"
                                }
                                ]
                            }
                        }, 
                        "type" : "integer", 
                        "description" : "Derives CPU used percentage using UDF"
                    }, 
                    {
                        "field-name" : "cpu-5min", 
                        "formula" : {
                            "user-defined-function" : {
                                "function-name" : "subtract", 
                                "argument" : [
                                {
                                    "argument" : "threshold", 
                                    "value" : "$cpu-idle-5min"
                                }
                                ]
                            }
                        }, 
                        "type" : "integer", 
                        "description" : "Derives CPU used percentage using UDF"
                    }, 
                    {
                        "field-name" : "cpu-utilization-15min-high-threshold", 
                        "constant" : {
                            "value" : "{{re-cpu-15min-high-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "RE CPU utilization 15 minutes load average high threshold"
                    }, 
                    {
                        "field-name" : "cpu-utilization-15min-low-threshold", 
                        "constant" : {
                            "value" : "{{re-cpu-15min-low-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "RE CPU utilization 15 minutes load average low threshold"
                    }, 
                    {
                        "field-name" : "cpu-utilization-1min-high-threshold", 
                        "constant" : {
                            "value" : "{{re-cpu-1min-high-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "RE CPU utilization 1 minute load average high threshold"
                    }, 
                    {
                        "field-name" : "cpu-utilization-1min-low-threshold", 
                        "constant" : {
                            "value" : "{{re-cpu-1min-low-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "RE CPU utilization 1 minute load average low threshold"
                    }, 
                    {
                        "field-name" : "cpu-utilization-5min-high-threshold", 
                        "constant" : {
                            "value" : "{{re-cpu-5min-high-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "RE CPU utilization 5 minutes load average high threshold"
                    }, 
                    {
                        "field-name" : "cpu-utilization-5min-low-threshold", 
                        "constant" : {
                            "value" : "{{re-cpu-5min-low-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "RE CPU utilization 5 minutes load average low threshold"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "cpu-utilization-15min", 
                        "synopsis" : "RE CPU 15 min load average KPI", 
                        "description" : "Sets health based on increase in RE CPU 15 minutes load average utilization", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-cpu-utilization-15min-normal", 
                            "when" : {
                                "less-than-or-equal-to" : [
                                {
                                    "left-operand" : "$cpu-15min", 
                                    "right-operand" : "$cpu-utilization-15min-low-threshold"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "Routing Engine$slot 15min CPU utilization($cpu-15min) is normal"
                                }
                            }
                        }, 
                        {
                            "term-name" : "is-cpu-utilization-15min-middle", 
                            "when" : {
                                "less-than-or-equal-to" : [
                                {
                                    "left-operand" : "$cpu-15min", 
                                    "right-operand" : "$cpu-utilization-15min-high-threshold"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "Routing Engine$slot 15min CPU utilization($cpu-15min) is in medium range"
                                }
                            }
                        }, 
                        {
                            "term-name" : "cpu-utilization-15min-abnormal", 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Routing Engine$slot  15min CPU utilization($cpu-15min) exceed high threshold ($cpu-utilization-15min-high-threshold)"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "cpu-utilization-1min", 
                        "synopsis" : "RE CPU 1 min load average kpi", 
                        "description" : "Sets health based on increase in RE CPU 1 minute load average utilization", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-cpu-utilization-1min-abnormal", 
                            "when" : {
                                "greater-than-or-equal-to" : [
                                {
                                    "left-operand" : "$cpu-1min", 
                                    "right-operand" : "$cpu-utilization-1min-high-threshold", 
                                    "time-range" : "3m", 
                                    "all" : [null]
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Routing Engine$slot 1min CPU utilization($cpu-1min) exceed high threshold(cpu-utilization-1min-high-threshold)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "is-cpu-utilization-1min-middle", 
                            "when" : {
                                "greater-than-or-equal-to" : [
                                {
                                    "left-operand" : "$cpu-1min", 
                                    "right-operand" : "$cpu-utilization-1min-low-threshold", 
                                    "time-range" : "3m", 
                                    "all" : [null]
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "Routing Engine$slot  1min CPU utilization($cpu-1min) is in medium range"
                                }
                            }
                        }, 
                        {
                            "term-name" : "cpu-utilization-1min-normal", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "Routing Engine$slot 1min CPU utilization($cpu-1min) is normal"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "cpu-utilization-5min", 
                        "synopsis" : "RE CPU 5 min load average KPI", 
                        "description" : "Sets health based on increase in RE CPU 5 minutes load average utilization", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-cpu-utilization-5min-normal", 
                            "when" : {
                                "less-than" : [
                                {
                                    "left-operand" : "$cpu-5min", 
                                    "right-operand" : "$cpu-utilization-5min-low-threshold"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "Routing Engine$slot 5min CPU utilization($cpu-5min) is normal"
                                }
                            }
                        }, 
                        {
                            "term-name" : "is-cpu-utilization-5min-middle", 
                            "when" : {
                                "less-than" : [
                                {
                                    "left-operand" : "$cpu-5min", 
                                    "right-operand" : "$cpu-utilization-5min-high-threshold"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "Routing Engine$slot 5min CPU utilization($cpu-5min) is in medium range"
                                }
                            }
                        }, 
                        {
                            "term-name" : "cpu-utilization-5min-abnormal", 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Routing Engine$slot 5min CPU utilization($cpu-5min) exceed high threshold($cpu-utilization-5min-high-threshold)"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "re-cpu-15min-high-threshold", 
                        "value" : "75", 
                        "description" : "RE CPU 15 min load average high threshold", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "re-cpu-15min-low-threshold", 
                        "value" : "50", 
                        "description" : "RE CPU 15 min load average low threshold", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "re-cpu-1min-high-threshold", 
                        "value" : "85", 
                        "description" : "RE CPU 1 min load average high threshold", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "re-cpu-1min-low-threshold", 
                        "value" : "60", 
                        "description" : "RE CPU 1 min load average low threshold", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "re-cpu-5min-high-threshold", 
                        "value" : "80", 
                        "description" : "RE CPU 5 min load average high threshold", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "re-cpu-5min-low-threshold", 
                        "value" : "55", 
                        "description" : "RE CPU 5 min load average low threshold", 
                        "type" : "int"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "ACX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "SRX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }, 
                        "helper-files" : [
                        {
                            "file-type" : "other", 
                            "list-of-files" : ["system-cpu.yml", "system-sensors.py"]
                        }
                        ]
                    }
                }
                ]
            }, 
            {
                "topic-name" : "system.memory", 
                "description" : "Monitors system statistics i.e. CPU, memory, storage, processes& queues and notifies anomalies", 
                "synopsis" : "System statistics analyzer", 
                "rule" : [
                {
                    "rule-name" : "check-system-memory", 
                    "keys" : ["routing-engine"],
                    "synopsis" : "RE system memory statistics analyzer", 
                    "description" : "Collects REs' system memory statistics periodically and notifies anomaly when memory usage exceed threshold", 
                    "sensor" : [
                    {
                        "sensor-name" : "components", 
                        "synopsis" : "System components open-config sensor definition", 
                        "description" : "RE system open-config sensor to collect telemetry data from network device", 
                        "open-config" : {
                            "sensor-name" : "/components/", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "re-memory-buffer", 
                        "sensor" : [
                        {
                            "sensor-name" : "components", 
                            "where" : [
                            {
                                "query" : "/components/component/properties/property/@name == 'memory-utilization-buffer'"
                            }
                            ], 
                            "path" : "/components/component/properties/property/state/value"
                        }
                        ], 
                        "type" : "integer", 
                        "description" : "RE system memory buffer value"
                    }, 
                    {
                        "field-name" : "re-memory-buffer-high-threshold", 
                        "constant" : {
                            "value" : "{{memory-buffer-re-high-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "RE system memory buffer high threshold"
                    }, 
                    {
                        "field-name" : "re-memory-buffer-low-threshold", 
                        "constant" : {
                            "value" : "{{memory-buffer-re-low-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "RE system memory buffer low threshold"
                    }, 
                    {
                        "field-name" : "routing-engine", 
                        "sensor" : [
                        {
                            "sensor-name" : "components", 
                            "where" : [
                            {
                                "query" : "/components/component/@name =~ /^Routing Engine[{{re-slot-no}}]*$/"
                            }
                            ], 
                            "path" : "/components/component/@name"
                        }
                        ], 
                        "type" : "string", 
                        "description" : "Routing engine to be monitored"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "re-memory-buffer-utilization", 
                        "synopsis" : "RE system memory buffer utilization kpi", 
                        "description" : "Sets health based on increase in system memory buffer utilization", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-re-memory-buffer-utilization-abnormal", 
                            "when" : {
                                "greater-than-or-equal-to" : [
                                {
                                    "left-operand" : "$re-memory-buffer", 
                                    "right-operand" : "$re-memory-buffer-high-threshold", 
                                    "time-range" : "5m", 
                                    "all" : [null]
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "$routing-engine memory buffer utilization($re-memory-buffer) exceed high threshold($re-memory-buffer-high-threshold)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "is-re-memory-buffer-utilization-middle", 
                            "when" : {
                                "greater-than-or-equal-to" : [
                                {
                                    "left-operand" : "$re-memory-buffer", 
                                    "right-operand" : "$re-memory-buffer-low-threshold", 
                                    "time-range" : "5m", 
                                    "all" : [null]
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "$routing-engine memory buffer utilization($re-memory-buffer) is in middle range(>=$re-memory-buffer-low-threshold, <=$re-memory-buffer-high-threshold)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "is-re-memory-buffer-utilization-normal", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "$routing-engine memory buffer utilization is normal"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "memory-buffer-re-high-threshold", 
                        "value" : "75", 
                        "description" : "Memory buffer high threshold: Utilization increase between metrics, before we report anomaly", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "memory-buffer-re-low-threshold", 
                        "value" : "50", 
                        "description" : "Memory buffer low threshold: Utilization increase between metrics, before we report anomaly", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "re-slot-no", 
                        "value" : "0-1", 
                        "description" : "RE slot numbers to monitor, regular expression, e.g. '0'", 
                        "type" : "string"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX9200"]
                                        }, 
                                        {
                                            "release-name" : "18.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX4650"]
                                        }, 
                                        {
                                            "release-name" : "18.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["EX4600"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "16.1R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["MX2010", "MX2020", "MX240", "MX480", "MX960"]
                                        }, 
                                        {
                                            "release-name" : "17.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["MX150"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["PTX1000", "PTX10000", "PTX5000"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "17.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX10000", "QFX5200"]
                                        }, 
                                        {
                                            "release-name" : "18.1R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX5100"]
                                        }, 
                                        {
                                            "release-name" : "18.3R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["QFX5120-48Y"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }
                    }
                }
                ]
            }, 
            {
                "topic-name" : "system.processes", 
                "description" : "Monitors system statistics i.e. CPU, memory, storage, processes & queues and notifies anomalies", 
                "synopsis" : "System statistics analyzer", 
                "rule" : [
                {
                    "rule-name" : "check-process-cpu", 
                    "keys" : ["daemon"],
                    "synopsis" : "System processes cpu analyzer", 
                    "description" : "Collects system process's cpu utilization periodically and notifies anomalies when daemon CPU usage exceed threshold", 
                    "sensor" : [
                    {
                        "sensor-name" : "systemprocexttable", 
                        "synopsis" : "System processes CPU iAgent sensor definition", 
                        "description" : "iAgent netconf rpc/cli command sensor to collect data from network device", 
                        "iAgent" : {
                            "file" : "system-proc-ext.yml", 
                            "table" : "SystemProcExtTable", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "cpu-util-percent", 
                        "sensor" : [
                        {
                            "sensor-name" : "systemprocexttable", 
                            "path" : "wcpu"
                        }
                        ], 
                        "description" : "Daemon CPU utilization"
                    }, 
                    {
                        "field-name" : "daemon", 
                        "sensor" : [
                        {
                            "sensor-name" : "systemprocexttable", 
                            "path" : "cmd"
                        }
                        ], 
                        "description" : "Daemon to be monitored"
                    }, 
                    {
                        "field-name" : "max-threshold", 
                        "constant" : {
                            "value" : "{{process-cpu-high-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "Daemon cpu high threshold"
                    }, 
                    {
                        "field-name" : "min-threshold", 
                        "constant" : {
                            "value" : "{{process-cpu-low-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "Daemon cpu low threshold"
                    }, 
                    {
                        "field-name" : "process-name", 
                        "constant" : {
                            "value" : "{{process-name-input}}"
                        }, 
                        "type" : "string", 
                        "description" : "Selected daemon to be monitored"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "processes-cpu-utilization", 
                        "synopsis" : "System prcoesses cpu utilization kpi", 
                        "description" : "Sets health based on system processes cpu utilization", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-processes-not-found", 
                            "when" : {
                                "does-not-match-with" : [
                                {
                                    "left-operand" : "$daemon", 
                                    "right-operand" : "$process-name"
                                }
                                ]
                            }
                        }, 
                        {
                            "term-name" : "is-cpu-utilization-abnormal", 
                            "when" : {
                                "greater-than-or-equal-to" : [
                                {
                                    "left-operand" : "$cpu-util-percent", 
                                    "right-operand" : "$max-threshold", 
                                    "time-range" : "3m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "$daemon cpu utilization:($cpu-util-percent), crossed high threshold($max-threshold)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "is-cpu-utilization-middle", 
                            "when" : {
                                "greater-than-or-equal-to" : [
                                {
                                    "left-operand" : "$cpu-util-percent", 
                                    "right-operand" : "$min-threshold", 
                                    "time-range" : "3m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "$daemon cpu utilization:($cpu-util-percent), is in middle range"
                                }
                            }
                        }, 
                        {
                            "term-name" : "is-cpu-utilization-normal", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "$daemon cpu utilization:($cpu-util-percent), is normal"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "process-cpu-high-threshold", 
                        "value" : "80", 
                        "description" : "Daemon cpu high threshold: Utilization increase between metrics, before we report anomaly", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "process-cpu-low-threshold", 
                        "value" : "50", 
                        "description" : "Daemon cpu low threshold: Utilization increase between metrics, before we report anomaly", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "process-name-input", 
                        "value" : ".*", 
                        "description" : "Demon name to monitor, regular regular expression, eg 'rpd|dfwd|dcd'", 
                        "type" : "string"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "ACX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "SRX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }, 
                        "helper-files" : [
                        {
                            "file-type" : "other", 
                            "list-of-files" : ["system-proc-ext.yml"]
                        }
                        ]
                    }
                }, 
                {
                    "rule-name" : "check-process-memory", 
                    "keys" : ["daemon"],
                    "synopsis" : "System processes memory utilization analyzer", 
                    "description" : "Collects system process's memory utilization periodically and notifies anomalies when daemon memory usage exceed threshold", 
                    "function" : [
                    {
                        "function-name" : "isExceeding", 
                        "description" : "Function isExceeding returns 'True' if % of size used out of reserved memory is not exceeding the threshold", 
                        "path" : "system-processes.py", 
                        "method" : "isExceeding", 
                        "argument" : [
                        {
                            "argument-name" : "res", 
                            "mandatory" : [null]
                        }, 
                        {
                            "argument-name" : "size", 
                            "mandatory" : [null]
                        }, 
                        {
                            "argument-name" : "threshold", 
                            "mandatory" : [null]
                        }
                        ]
                    }
                    ], 
                    "sensor" : [
                    {
                        "sensor-name" : "systemprocexttable", 
                        "synopsis" : "System processes memory iAgent sensor definition", 
                        "description" : "iAgent netconf rpc/cli command sensor to collect data from network device", 
                        "iAgent" : {
                            "file" : "system-proc-ext.yml", 
                            "table" : "SystemProcExtTable", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "daemon", 
                        "sensor" : [
                        {
                            "sensor-name" : "systemprocexttable", 
                            "path" : "cmd"
                        }
                        ], 
                        "description" : "Daemon to be monitored"
                    }, 
                    {
                        "field-name" : "max-threshold", 
                        "constant" : {
                            "value" : "{{process-memory-high-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "Daemon memory max threshold"
                    }, 
                    {
                        "field-name" : "min-threshold", 
                        "constant" : {
                            "value" : "{{process-memory-low-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "Daemon memory low threshold"
                    }, 
                    {
                        "field-name" : "process-name", 
                        "constant" : {
                            "value" : "{{process-name-input}}"
                        }, 
                        "type" : "string", 
                        "description" : "Selected daemon to be monitored"
                    }, 
                    {
                        "field-name" : "reserved", 
                        "sensor" : [
                        {
                            "sensor-name" : "systemprocexttable", 
                            "path" : "res"
                        }
                        ], 
                        "description" : "Reserved memory of daemon"
                    }, 
                    {
                        "field-name" : "size", 
                        "sensor" : [
                        {
                            "sensor-name" : "systemprocexttable", 
                            "path" : "size"
                        }
                        ], 
                        "description" : "Daemon memory size"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "processes-memory-utilization", 
                        "synopsis" : "System prcoesses memory utilization kpi", 
                        "description" : "Sets health based on system processes memory utilization", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "skiping-undefined-processes", 
                            "when" : {
                                "does-not-match-with" : [
                                {
                                    "left-operand" : "$daemon", 
                                    "right-operand" : "$process-name"
                                }
                                ]
                            }
                        }, 
                        {
                            "term-name" : "is-memory-utilization-abnormal", 
                            "when" : {
                                "user-defined-function" : [
                                {
                                    "function-name" : "isExceeding", 
                                    "argument" : [
                                    {
                                        "argument" : "size", 
                                        "value" : "$size"
                                    }, 
                                    {
                                        "argument" : "res", 
                                        "value" : "$reserved"
                                    }, 
                                    {
                                        "argument" : "threshold", 
                                        "value" : "$max-threshold"
                                    }
                                    ], 
                                    "time-range" : "5m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "$daemon memory utilization is above high threshold($max-threshold)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "is-memory-utilization-middle", 
                            "when" : {
                                "user-defined-function" : [
                                {
                                    "function-name" : "isExceeding", 
                                    "argument" : [
                                    {
                                        "argument" : "size", 
                                        "value" : "$size"
                                    }, 
                                    {
                                        "argument" : "res", 
                                        "value" : "$reserved"
                                    }, 
                                    {
                                        "argument" : "threshold", 
                                        "value" : "$min-threshold"
                                    }
                                    ], 
                                    "time-range" : "5m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "$daemon memory utilization is in middle range(>=$min-threshold, <=$max-threshold)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "is-cpu-utilization-normal", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "$daemon memory utilization is normal"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "process-memory-high-threshold", 
                        "value" : "80", 
                        "description" : "Daemon memory high threshold: Utilization increase between metrics, before we report anomaly", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "process-memory-low-threshold", 
                        "value" : "50", 
                        "description" : "Daemon memory low threshold: Utilization increase between metrics, before we report anomaly", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "process-name-input", 
                        "value" : ".*", 
                        "description" : "Demon name to monitor, regular regular expression, e.g. 'rpd|dfwd|dcd'", 
                        "type" : "string"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "ACX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "SRX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }, 
                        "helper-files" : [
                        {
                            "file-type" : "other", 
                            "list-of-files" : ["system-proc-ext.yml", "system-processes.py"]
                        }
                        ]
                    }
                }
                ]
            }, 
            {
                "topic-name" : "system.statistics", 
                "description" : "Rules relevant to metrics and KPI of the system", 
                "synopsis" : "Virtual memory information analyzer", 
                "rule" : [
                {
                    "rule-name" : "check-routing-engine-cpu-utilization", 
                    "keys" : ["slot"],
                    "synopsis" : "Routing Engine CPU utilization analyzer", 
                    "description" : "Monitors the routing engine's cpu utilization", 
                    "sensor" : [
                    {
                        "sensor-name" : "reutilizationtable", 
                        "synopsis" : "Routing engine CPU utilization iAgent sensor definition", 
                        "description" : "Netconf rpc get-route-engine-information to collect data from network device", 
                        "iAgent" : {
                            "file" : "re-cpu-utilization.yml", 
                            "table" : "REutlizationTable", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "re-cpu-idle-threshold", 
                        "constant" : {
                            "value" : "{{re-cpu-idle-threshold-input}}"
                        }, 
                        "description" : "Routing Engine CPU idle threshold"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "routing-engine-cpu-utilization-idle-15min", 
                        "synopsis" : "Routing engine CPU kpi", 
                        "description" : "sets health based on Routing engine CPU utilization for 15 minutes", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-15min-cpu-idle-less-than-threshold", 
                            "when" : {
                                "less-than" : [
                                {
                                    "left-operand" : "$cpu-idle-15-min", 
                                    "right-operand" : "$re-cpu-idle-threshold"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "15 min cpu idle is less than configured threshold ($re-cpu-idle-threshold)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "cpu-idle-15min-greater-than-threshold", 
                            "then" : {
                                "status" : {
                                    "color" : "green"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "routing-engine-cpu-utilization-idle-1min", 
                        "synopsis" : "Routing engine CPU kpi", 
                        "description" : "sets health based on Routing engine CPU utilization for 1 minute", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-1min-cpu-idle-less-than-threshold", 
                            "when" : {
                                "less-than" : [
                                {
                                    "left-operand" : "$cpu-idle-1-min", 
                                    "right-operand" : "$re-cpu-idle-threshold"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "1 min cpu idle is less than configured threshold ($re-cpu-idle-threshold)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "cpu-idle-1min-greater-than-threshold", 
                            "then" : {
                                "status" : {
                                    "color" : "green"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "routing-engine-cpu-utilization-idle-5-sec", 
                        "synopsis" : "Routing engine CPU kpi", 
                        "description" : "sets health based on Routing engine CPU utilization for 5 seconds", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-5sec-cpu-idle-less-than-threshold", 
                            "when" : {
                                "less-than" : [
                                {
                                    "left-operand" : "$cpu-idle-5-sec", 
                                    "right-operand" : "$re-cpu-idle-threshold"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "5 second cpu idle is less than configured threshold ($re-cpu-idle-threshold)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "cpu-idle-5sec-greater-than-threshold", 
                            "then" : {
                                "status" : {
                                    "color" : "green"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "routing-engine-cpu-utilization-idle-5min", 
                        "synopsis" : "Routing engine CPU kpi", 
                        "description" : "sets health based on Routing engine CPU utilization for 5 minutes", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-5min-cpu-idle-less-than-threshold", 
                            "when" : {
                                "less-than" : [
                                {
                                    "left-operand" : "$cpu-idle-5-min", 
                                    "right-operand" : "$re-cpu-idle-threshold"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "5 min cpu idle is less than configured threshold ($re-cpu-idle-threshold)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "cpu-idle-5min-greater-than-threshold", 
                            "then" : {
                                "status" : {
                                    "color" : "green"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "re-cpu-idle-threshold-input", 
                        "value" : "20", 
                        "description" : "Routing-Engine CPU Idle threshold value", 
                        "type" : "int"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "ACX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "11.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "11.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "SRX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }, 
                        "helper-files" : [
                        {
                            "file-type" : "other", 
                            "list-of-files" : ["re-cpu-utilization.yml"]
                        }
                        ]
                    }
                }, 
                {
                    "rule-name" : "check-system-input-queues", 
                    "keys" : ["interface"],
                    "synopsis" : "Packet drops on the input interface analyzer", 
                    "description" : "Monitors packet drops on the input interface", 
                    "sensor" : [
                    {
                        "sensor-name" : "system-input-queues", 
                        "synopsis" : "Input interface packet drops iAgent sensor definition", 
                        "description" : "Netconf CLI show system queues to collect data from network device", 
                        "iAgent" : {
                            "file" : "system-queues.yml", 
                            "table" : "SystemQueuesINTable", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "system-queue-drop-count-threshold", 
                        "constant" : {
                            "value" : "{{queue-drop-count-threshold}}"
                        }, 
                        "description" : "System queue drop count threshold for input interface"
                    }, 
                    {
                        "field-name" : "system-queue-drop-rate-threshold", 
                        "constant" : {
                            "value" : "{{queue-drop-rate-threshold}}"
                        }, 
                        "description" : "System queue drop rate threshold for input interface"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "system-input-queue-drops", 
                        "synopsis" : "System input queue drops kpi", 
                        "description" : "sets health based on input queue drops", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "are-system-input-queue-drops-increasing", 
                            "when" : {
                                "min-rate-of-increase" : [
                                {
                                    "field-name" : "$drops", 
                                    "rate" : "$system-queue-drop-rate-threshold", 
                                    "time-range" : "300s"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "System interface input drops ($drops) increasing"
                                }
                            }
                        }, 
                        {
                            "term-name" : "are-system-input-queue-drops-above-threshold", 
                            "when" : {
                                "greater-than" : [
                                {
                                    "left-operand" : "$drops", 
                                    "right-operand" : "$system-queue-drop-count-threshold"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "System interface input drops ($drops) are non-zero"
                                }
                            }
                        }, 
                        {
                            "term-name" : "system-input-queue-drops-not-increasing", 
                            "then" : {
                                "status" : {
                                    "color" : "green"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "queue-drop-count-threshold", 
                        "value" : "0", 
                        "description" : "System queue drop count threshold value", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "queue-drop-rate-threshold", 
                        "value" : "1", 
                        "description" : "System queue drop rate threshold value", 
                        "type" : "int"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "ACX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "11.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "11.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "SRX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }, 
                        "helper-files" : [
                        {
                            "file-type" : "other", 
                            "list-of-files" : ["system-queues.yml"]
                        }
                        ]
                    }
                }, 
                {
                    "rule-name" : "check-system-output-queues", 
                    "keys" : ["interface"],
                    "synopsis" : "Packet drops on the output interface analyzer", 
                    "description" : "Monitors packet drops on the output interface", 
                    "sensor" : [
                    {
                        "sensor-name" : "system-output-queues", 
                        "synopsis" : "Input interface packet drops iAgent sensor definition", 
                        "description" : "Netconf CLI show system queues to collect data from network device", 
                        "iAgent" : {
                            "file" : "system-queues.yml", 
                            "table" : "SystemQueuesOutTable", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "system-queue-drop-count-threshold", 
                        "constant" : {
                            "value" : "{{queue-drop-count-threshold}}"
                        }, 
                        "description" : "System queue drop count threshold for output interface"
                    }, 
                    {
                        "field-name" : "system-queue-drop-rate-threshold", 
                        "constant" : {
                            "value" : "{{queue-drop-rate-threshold}}"
                        }, 
                        "description" : "System queue drop rate threshold for output interface"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "system-output-queue-drops", 
                        "synopsis" : "System output queue drops kpi", 
                        "description" : "sets health based on output queue drops", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "are-system-output-queue-drops-increasing", 
                            "when" : {
                                "min-rate-of-increase" : [
                                {
                                    "field-name" : "$drops", 
                                    "rate" : "$system-queue-drop-rate-threshold", 
                                    "time-range" : "300s"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "System interface output drops ($drops) increasing"
                                }
                            }
                        }, 
                        {
                            "term-name" : "are-system-output-queue-drops-above-threshold", 
                            "when" : {
                                "greater-than" : [
                                {
                                    "left-operand" : "$drops", 
                                    "right-operand" : "$system-queue-drop-count-threshold"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "System interface output drops ($drops) are non-zero"
                                }
                            }
                        }, 
                        {
                            "term-name" : "system-output-queue-drops-not-increasing", 
                            "then" : {
                                "status" : {
                                    "color" : "green"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "queue-drop-count-threshold", 
                        "value" : "0", 
                        "description" : "System queue drop count threshold value", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "queue-drop-rate-threshold", 
                        "value" : "1", 
                        "description" : "System queue drop rate threshold value", 
                        "type" : "int"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "ACX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "11.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "11.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "SRX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }, 
                        "helper-files" : [
                        {
                            "file-type" : "other", 
                            "list-of-files" : ["system-queues.yml"]
                        }
                        ]
                    }
                }, 
                {
                    "rule-name" : "check-system-statistics-ip", 
                    "keys" : ["incoming-rawip-packets-dropped-no-socket-buffer"],
                    "synopsis" : "Incoming raw ip packets analyzer", 
                    "description" : "Monitors incoming ip no socket buffer drops", 
                    "sensor" : [
                    {
                        "sensor-name" : "system-statistics-ip", 
                        "synopsis" : "Ip packets dropped no socket buffer iAgent sensor definition", 
                        "description" : "Netconf rpc get-statistics-information to collect data from network device", 
                        "iAgent" : {
                            "file" : "system-statistics-ip.yml", 
                            "table" : "systemStatisticsIP", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "configured-packets-dropped-count-threshold", 
                        "constant" : {
                            "value" : "{{ip-no-socket-buffer-count-threshold}}"
                        }, 
                        "description" : "IP no socket buffer count threshold"
                    }, 
                    {
                        "field-name" : "configured-packets-dropped-rate-threshold", 
                        "constant" : {
                            "value" : "{{ip-no-socket-buffer-rate-threshold}}"
                        }, 
                        "description" : "IP no socket buffer rate threshold"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "incoming-raw-ip-no-socket-buffer-packets-dropped", 
                        "synopsis" : "ip no socket buffer drop kpi", 
                        "description" : "sets health based on ip no socket buffer drop", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "are-incoming-ip-no-socket-drops-increasing-over-threshold-rate", 
                            "when" : {
                                "min-rate-of-increase" : [
                                {
                                    "field-name" : "$system-statistics-ip-no-socket-buffer", 
                                    "rate" : "$configured-packets-dropped-rate-threshold", 
                                    "time-range" : "300s"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "IP no socket buffer drops ($system-statistics-ip-no-socket-buffer) increase rate is higher than threshold ($configured-packets-dropped-rate-threshold)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "are-incoming-ip-no-buffer-drops-larger-than-threshold", 
                            "when" : {
                                "greater-than" : [
                                {
                                    "left-operand" : "$system-statistics-ip-no-socket-buffer", 
                                    "right-operand" : "$configured-packets-dropped-count-threshold"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "IP no socket buffer drops ($system-statistics-ip-no-socket-buffer) non-zero"
                                }
                            }
                        }, 
                        {
                            "term-name" : "incoming-ip-no-buffer-drops-not-increasing-above-configured-rate", 
                            "then" : {
                                "status" : {
                                    "color" : "green"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "ip-no-socket-buffer-count-threshold", 
                        "value" : "0", 
                        "description" : "System raw IP no socket buffer count threshold value", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "ip-no-socket-buffer-rate-threshold", 
                        "value" : "1", 
                        "description" : "System raw IP no socket buffer rate threshold value", 
                        "type" : "int"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "ACX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "11.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "11.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "SRX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }, 
                        "helper-files" : [
                        {
                            "file-type" : "other", 
                            "list-of-files" : ["system-statistics-ip.yml"]
                        }
                        ]
                    }
                }, 
                {
                    "rule-name" : "check-system-storage-capacity", 
                    "keys" : ["filesystem-name"],
                    "synopsis" : "System storage capacity analyzer", 
                    "description" : "Monitors the system storage capacity", 
                    "sensor" : [
                    {
                        "sensor-name" : "system-storage-capacity", 
                        "synopsis" : "System storage capacity iAgent sensor definition", 
                        "description" : "Netconf rpc get-system-storage to collect data from network device", 
                        "iAgent" : {
                            "file" : "system-storage-capacity.yml", 
                            "table" : "systemStorage", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "configured-storage-usage-threshold", 
                        "constant" : {
                            "value" : "{{storage-usage-threshold}}"
                        }, 
                        "description" : "System storage threshold value"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "system-storage-capacity", 
                        "synopsis" : "system storage usage kpi", 
                        "description" : "sets health based on system storage usage", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-system-storage-capacity-greater-than-threshold", 
                            "when" : {
                                "greater-than" : [
                                {
                                    "left-operand" : "$system-storage-capacity", 
                                    "right-operand" : "$configured-storage-usage-threshold"
                                }
                                ], 
                                "matches-with" : [
                                {
                                    "left-operand" : "$system-storage-filesystem", 
                                    "right-operand" : "/dev/gpt/junos"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "The system storage usage ($system-storage-capacity) is over threshold ($configured-storage-usage-threshold)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "system-storage-capacity-less-than-threshold", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "The system storage usage ($system-storage-capacity) is under threshold ($configured-storage-usage-threshold)"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "storage-usage-threshold", 
                        "value" : "80", 
                        "description" : "System storage used capacity threshold value", 
                        "type" : "int"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "ACX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "SRX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }, 
                        "helper-files" : [
                        {
                            "file-type" : "other", 
                            "list-of-files" : ["system-storage-capacity.yml"]
                        }
                        ]
                    }
                }, 
                {
                    "rule-name" : "check-system-virtual-memory-information", 
                    "keys" : ["vm-kmem-map-free"],
                    "synopsis" : "Virtual memory information analyzer", 
                    "description" : "Monitors the virtual memory and interrupt rate", 
                    "sensor" : [
                    {
                        "sensor-name" : "system-virtual-memory", 
                        "synopsis" : "iAgent sensor definition", 
                        "description" : "Netconf rpc get-system-virtual-memory-information iAgent sensor to collect telemetry data from network device", 
                        "iAgent" : {
                            "file" : "system-virtual-memory.yml", 
                            "table" : "systemVirtualMemory", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "free-virtual-memory-threshold", 
                        "constant" : {
                            "value" : "{{virtual-memory-threshold}}"
                        }, 
                        "description" : "This field is for Virtual memory threshold"
                    }, 
                    {
                        "field-name" : "interrupt-rate-threshold", 
                        "constant" : {
                            "value" : "{{interrupt-rate-threshold-value}}"
                        }, 
                        "description" : "This field is for Interrupt rate threshold"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "interrupt-rate", 
                        "synopsis" : "virtual memory interrupt rate kpi", 
                        "description" : "Sets health based on virtual memory interrupt rate", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-interrupt-rate-greater-than-threshold", 
                            "when" : {
                                "greater-than" : [
                                {
                                    "left-operand" : "$interrupt-rate", 
                                    "right-operand" : "$interrupt-rate-threshold"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Interrupt rate is greater than threshold ($interrupt-rate-threshold)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "interrupt-rate-less-than-threshold", 
                            "then" : {
                                "status" : {
                                    "color" : "green"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "vm-kmem-map-free", 
                        "synopsis" : "Virtual memory kpi", 
                        "description" : "Sets health based on Free virtual memory", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-virtual-memory-lower-than-threshold", 
                            "when" : {
                                "less-than" : [
                                {
                                    "left-operand" : "$vm-kmem-map-free", 
                                    "right-operand" : "$free-virtual-memory-threshold"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Virtual memory is lower than threshold ($free-virtual-memory-threshold)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "virtual-memory-greater-than-equal-to-1000000000", 
                            "then" : {
                                "status" : {
                                    "color" : "green"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "interrupt-rate-threshold-value", 
                        "value" : "500", 
                        "description" : "System Interrupt Rate threshold value", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "virtual-memory-threshold", 
                        "value" : "1000000000", 
                        "description" : "Free Virtual Memory threshold value in bytes", 
                        "type" : "int"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "ACX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "11.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "11.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "SRX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }, 
                        "helper-files" : [
                        {
                            "file-type" : "other", 
                            "list-of-files" : ["system-virtual-memory.yml"]
                        }
                        ]
                    }
                }, 
                {
                    "rule-name" : "check-version", 
                    "keys" : ["host-name"],
                    "synopsis" : "System product name and software version analyzer", 
                    "description" : "Validates the product name and Junos version", 
                    "sensor" : [
                    {
                        "sensor-name" : "product-and-junos-version", 
                        "synopsis" : "System product namd and software version iAgent sensor definition", 
                        "description" : "Netconf rpc get-software-information to collect data from network device", 
                        "iAgent" : {
                            "file" : "software-version.yml", 
                            "table" : "SoftwareVersionTable", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "configured-product-value", 
                        "constant" : {
                            "value" : "{{product-value}}"
                        }, 
                        "description" : "System product model like MX240 or MX480 or MX960"
                    }, 
                    {
                        "field-name" : "configured-software-version-value", 
                        "constant" : {
                            "value" : "{{software-version-value}}"
                        }, 
                        "description" : "System software version"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "product-name", 
                        "synopsis" : "system product model kpi", 
                        "description" : "sets health based on product model", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-product-model-valid", 
                            "when" : {
                                "matches-with" : [
                                {
                                    "left-operand" : "$product", 
                                    "right-operand" : "$configured-product-value"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "Device product model is valid ($configured-product-value)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "unauthorized-product-model-used", 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Unauthorized product ($product) is being used"
                                }
                            }
                        }
                        ]
                    }, 
                    {
                        "trigger-name" : "software-version", 
                        "synopsis" : "system software version kpi", 
                        "description" : "sets health based on software version", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-junos-version-correct", 
                            "when" : {
                                "matches-with" : [
                                {
                                    "left-operand" : "$version", 
                                    "right-operand" : "$configured-software-version-value"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "Junos version $configured-software-version-value is being used"
                                }
                            }
                        }, 
                        {
                            "term-name" : "unauthorized-junos-version-used", 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Unauthorized Junos version ($version) is being used"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "product-value", 
                        "value" : ".*", 
                        "description" : "Product model the system should be", 
                        "type" : "string"
                    }, 
                    {
                        "name" : "software-version-value", 
                        "value" : ".*", 
                        "description" : "Software Version the system should have", 
                        "type" : "string"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "ACX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "11.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "11.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "SRX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }, 
                        "helper-files" : [
                        {
                            "file-type" : "other", 
                            "list-of-files" : ["software-version.yml"]
                        }
                        ]
                    }
                }
                ]
            }, 
            {
                "topic-name" : "system.storage", 
                "description" : "Monitors system statistics i.e. CPU, memory, storage, processes& queues and notifies anomalies", 
                "synopsis" : "System statistics analyzer", 
                "rule" : [
                {
                    "rule-name" : "check-storage", 
                    "keys" : ["mounted-on"],
                    "synopsis" : "system storage usage analyzer", 
                    "description" : "Collects filesystem storage usage periodically and notifies anomalies when used space exceed threshold", 
                    "sensor" : [
                    {
                        "sensor-name" : "storagetable", 
                        "synopsis" : "System storage iAgent sensor definition", 
                        "description" : "iAgent netconf rpc/cli command sensor to collect data from network device", 
                        "iAgent" : {
                            "file" : "system-storage.yml", 
                            "table" : "StorageTable", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "high-threshold", 
                        "constant" : {
                            "value" : "{{storage-usage-high-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "Filesystem used storage high threshold"
                    }, 
                    {
                        "field-name" : "low-threshold", 
                        "constant" : {
                            "value" : "{{storage-usage-low-threshold}}"
                        }, 
                        "type" : "integer", 
                        "description" : "Filesystem used storage low threshold"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "file-system-utilization", 
                        "synopsis" : "File system usage kpi", 
                        "description" : "Sets health based on increase in file system storage usage", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "is-system-storage-abnormal", 
                            "when" : {
                                "greater-than-or-equal-to" : [
                                {
                                    "left-operand" : "$used-percent", 
                                    "right-operand" : "$high-threshold"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "$filesystem-name storage used($used-percent) is above ($high-threshold)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "is-system-storage-normal", 
                            "when" : {
                                "less-than" : [
                                {
                                    "left-operand" : "$used-percent", 
                                    "right-operand" : "$low-threshold"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "$filesystem-name storage used($used-percent) is normal ($used-percent)"
                                }
                            }
                        }, 
                        {
                            "term-name" : "system-storage-middle", 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "$filesystem-name storage used($used-percent) is in middle range(>=$low-threshold, <=$high-threshold)"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "storage-usage-high-threshold", 
                        "value" : "80", 
                        "description" : "Filesystem storage high threshold: exceed used % threshold, before we report anomaly", 
                        "type" : "int"
                    }, 
                    {
                        "name" : "storage-usage-low-threshold", 
                        "value" : "50", 
                        "description" : "Filesystem storage low threshold: exceed used % threshold, before we report anomaly", 
                        "type" : "int"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "ACX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "11.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "11.4R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "SRX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }, 
                        "helper-files" : [
                        {
                            "file-type" : "other", 
                            "list-of-files" : ["system-storage.yml"]
                        }
                        ]
                    }
                }
                ]
            }, 
            {
                "topic-name" : "system.traffic", 
                "description" : "This topic is to monitor system total input and output packets usage and notify in case difference in io traffic is above static and dynamic threshold", 
                "synopsis" : "System total Input and output packets analyzer", 
                "rule" : [
                {
                    "rule-name" : "check-system-traffic", 
                    "synopsis" : "system traffic statistics analyzer", 
                    "description" : "Collects system total io packets and notifies in case of anomalies when io traffic difference is above static and dynamic threshold", 
                    "function" : [
                    {
                        "function-name" : "traffic_diff", 
                        "description" : "Function traffic_diff returns io traffic difference", 
                        "path" : "traffic_diff.py", 
                        "method" : "traffic_diff", 
                        "argument" : [
                        {
                            "argument-name" : "inpkts", 
                            "mandatory" : [null]
                        }, 
                        {
                            "argument-name" : "outpkts", 
                            "mandatory" : [null]
                        }
                        ]
                    }
                    ], 
                    "sensor" : [
                    {
                        "sensor-name" : "SystemStatistics", 
                        "synopsis" : "System traffic iAgent sensor definition", 
                        "description" : "iAgent netconf rpc/cli command sensor to collect data from network device", 
                        "iAgent" : {
                            "file" : "traffic-statistics.yml", 
                            "table" : "SystemStatisticsTable", 
                            "frequency" : "60s"
                        }
                    }
                    ], 
                    "field" : [
                    {
                        "field-name" : "threshold", 
                        "constant" : {
                            "value" : "{{traffic-diff-threshold}}"
                        }, 
                        "type" : "float"
                    }, 
                    {
                        "field-name" : "traffic-diff-dynamic-threshold", 
                        "formula" : {
                            "dynamic-threshold" : {
                                "algorithm" : "k-means", 
                                "learning-period" : "7d", 
                                "pattern-periodicity" : "1h", 
                                "field-name" : "$traffic-difference"
                            }
                        }, 
                        "type" : "integer", 
                        "description" : "Dynamic system total input threshold"
                    }, 
                    {
                        "field-name" : "traffic-difference", 
                        "formula" : {
                            "user-defined-function" : {
                                "function-name" : "traffic_diff", 
                                "argument" : [
                                {
                                    "argument" : "inpkts", 
                                    "value" : "$pfe-input-packets"
                                }, 
                                {
                                    "argument" : "outpkts", 
                                    "value" : "$pfe-output-packets"
                                }
                                ]
                            }
                        }, 
                        "type" : "integer"
                    }
                    ], 
                    "trigger" : [
                    {
                        "trigger-name" : "compare-in-out-traffic", 
                        "frequency" : "60s", 
                        "term" : [
                        {
                            "term-name" : "traffic-mismatch-static", 
                            "when" : {
                                "greater-than-or-equal-to" : [
                                {
                                    "left-operand" : "$traffic-difference", 
                                    "right-operand" : "$threshold", 
                                    "time-range" : "5m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "red", 
                                    "message" : "Difference($traffic-difference %) in input($pfe-input-packets pkts) and output($pfe-output-packets pkts) traffic exceeds $threshold"
                                }
                            }
                        }, 
                        {
                            "term-name" : "traffic-mismatch-dynamic", 
                            "when" : {
                                "equal-to" : [
                                {
                                    "left-operand" : "$traffic-diff-dynamic-threshold", 
                                    "right-operand" : "1", 
                                    "time-range" : "5m"
                                }
                                ]
                            }, 
                            "then" : {
                                "status" : {
                                    "color" : "yellow", 
                                    "message" : "Difference($traffic-difference %) in input($pfe-input-packets pkts) and output($pfe-output-packets pkts) traffic exceeds dynamic threshold"
                                }
                            }
                        }, 
                        {
                            "term-name" : "traffic-normal", 
                            "then" : {
                                "status" : {
                                    "color" : "green", 
                                    "message" : "Difference($traffic-difference %) in input($pfe-input-packets pkts) and output($pfe-output-packets pkts) traffic is normal"
                                }
                            }
                        }
                        ]
                    }
                    ], 
                    "variable" : [
                    {
                        "name" : "traffic-diff-threshold", 
                        "value" : "15", 
                        "description" : "Iinput and ouput traffic difference threshold", 
                        "type" : "float"
                    }
                    ], 
                    "rule-properties" : {
                        "version" : 2, 
                        "contributor" : "juniper", 
                        "supported-healthbot-version" : "1.0.1", 
                        "catalogue" : {
                            "tier" : "1"
                        }, 
                        "supported-devices" : {
                            "juniper" : {
                                "operating-system" : [
                                {
                                    "os-name" : "junos", 
                                    "products" : [
                                    {
                                        "product-name" : "ACX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "EX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "MX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "PTX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "QFX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }, 
                                    {
                                        "product-name" : "SRX", 
                                        "releases" : [
                                        {
                                            "release-name" : "15.2R1", 
                                            "release-support" : "min-supported-release", 
                                            "platform" : ["All"]
                                        }
                                        ]
                                    }
                                    ]
                                }
                                ]
                            }
                        }, 
                        "helper-files" : [
                        {
                            "file-type" : "other", 
                            "list-of-files" : ["traffic-statistics.yml", "traffic_diff.py"]
                        }
                        ]
                    }
                }
                ]
            }
            ], 
            "playbook" : [
            {
                "playbook-name" : "bgp-route-hijack-detection", 
                "rules" : ["protocol.bgp/check-route-hijacking-v4", "protocol.bgp/check-route-hijacking-v6"],
                "description" : "Playbook detects bgp ipv4 and ipv6 route hijack", 
                "synopsis" : "Playbook detects route hijack"
            }, 
            {
                "playbook-name" : "bgp-session-stats-playbook", 
                "rules" : ["protocol.bgp/check-bgp-advertised-routes", "protocol.bgp/check-bgp-neighbor-flaps", "protocol.bgp/check-bgp-received-routes", "protocol.bgp/check-bgp-session-state"],
                "description" : "Playbook checks the BGP neighbor sessions health and notify anomaly when statistics are unusual", 
                "synopsis" : "BGP neighbor sessions key performance indicators"
            }, 
            {
                "playbook-name" : "chassis-kpis-playbook", 
                "rules" : ["chassis.fan/check-fan-health", "chassis.power/check-pem-power-usage", "chassis.power/check-system-power-usage", "chassis.power/check-zone-power-usage", "chassis.temperatures/check-chassis-temperature", "chassis.temperatures/check-fpc-temperature", "chassis.temperatures/check-re-cpu-temperature", "chassis.temperatures/check-re-temperature"],
                "description" : "Playbook monitor the chassis health i.e. chassis, RE, RE CPU and linecards temperatures, power and fan health", 
                "synopsis" : "Chassis key performance indicators"
            }, 
            {
                "playbook-name" : "chip-agnostic-kpis", 
                "rules" : ["linecard.statistics/check-center-chip-fabric-in", "linecard.statistics/check-center-chip-fabric-in-errors", "linecard.statistics/check-center-chip-host-path", "linecard.statistics/check-center-chip-lookup-in", "linecard.statistics/check-center-chip-lookup-out", "linecard.statistics/check-center-chip-pt-entries", "linecard.statistics/check-center-chip-wan-out"],
                "description" : "Playbook detects chip agnostic anomalies", 
                "synopsis" : "Chip agnostic kpis"
            }, 
            {
                "playbook-name" : "forwarding-table-summary", 
                "rules" : ["protocol.routesummary/check-fib-summary"],
                "description" : "Playbook monitors forwarding-table's each protocol's route count and notifies anomaly when route count is above static or dynamic threshold", 
                "synopsis" : "Forwarding table and protocol routes key performance indicators"
            }, 
            {
                "playbook-name" : "get-vpn-stats", 
                "rules" : ["protocol.l3vpn/get-interface-details", "protocol.l3vpn/get-routing-instance-details"],
                "description" : "Playbook collects interface and routing instance details periodically", 
                "synopsis" : "Interface and routing instance collector"
            }, 
            {
                "playbook-name" : "icmp-outlier", 
                "rules" : ["protocol.icmp/check-outlier"],
                "description" : "Detects network group outlier w.r.t RTT average response across devices", 
                "synopsis" : "ICMP outlier detector"
            }, 
            {
                "playbook-name" : "icmp-probe", 
                "rules" : ["protocol.icmp/check-icmp-statistics"],
                "description" : "Device playbook to monitor RTT response", 
                "synopsis" : "ICMP RTT response checker"
            }, 
            {
                "playbook-name" : "interface-kpis-playbook", 
                "rules" : ["interface.statistics/check-ifl-in-traffic", "interface.statistics/check-ifl-out-traffic", "interface.statistics/check-in-errors", "interface.statistics/check-in-traffic", "interface.statistics/check-interface-flaps", "interface.statistics/check-interface-status", "interface.statistics/check-neighbor-state", "interface.statistics/check-out-errors", "interface.statistics/check-out-traffic"],
                "description" : "Playbook to check interface health w.r.t. links, flaps, neighbor state, input & output traffic and errors", 
                "synopsis" : "Interface key performance indicators"
            }, 
            {
                "playbook-name" : "isis-stats-playbook", 
                "rules" : ["protocol.isis/check-isis-adjacencies", "protocol.isis/check-isis-statistics"],
                "description" : "Playbook checks the ISIS adjacencies health and notify anomaly when statistics are unusual", 
                "synopsis" : "ISIS adjacency key performance indicators"
            }, 
            {
                "playbook-name" : "linecard-kpis-playbook", 
                "rules" : ["linecard.cm-events/check-cm-events", "linecard.fpc/check-fpc-cpu", "linecard.fpc/check-fpc-memory"],
                "description" : "Playbook checks linecard health i.e. cpu, memory and CM errors", 
                "synopsis" : "Linecards key performance indicators"
            }, 
            {
                "playbook-name" : "lldp-kpis-playbook", 
                "rules" : ["protocol.lldp/check-lldp-session", "protocol.lldp/check-lldp-session-statistics", "protocol.lldp/get-lldp-state"],
                "description" : "Playbook checks health of each lldp session and notify anomalies", 
                "synopsis" : "LLDP session statistics KPI playbook"
            }, 
            {
                "playbook-name" : "microburst-playbook", 
                "rules" : ["class-of-service.microburst/check-queue"],
                "description" : "Playbook detects microbursts on interface egress queues", 
                "synopsis" : "Microburst detector"
            }, 
            {
                "playbook-name" : "mpls-blackhole-detection-playbook", 
                "rules" : ["linecard.jnh-exception-packets/check-drop-packets", "linecard.jnh-exception-packets/check-rsvp"],
                "description" : "Playbook detects blackhole based on jnh exceptions and compares with RSVP session statistics and notifies anomalies", 
                "synopsis" : "Mpls blackhole detection key performance indicators"
            }, 
            {
                "playbook-name" : "netsvc-playbook", 
                "rules" : ["chassis.networkservices/netsvc-rule"]
            }, 
            {
                "playbook-name" : "online-fpc-playbook", 
                "rules" : ["linecard.statistics/update-online-fpc"],
                "description" : "Playbook collects online FPCs list", 
                "synopsis" : "Collects online FPCs"
            }, 
            {
                "playbook-name" : "rca-ospf-playbook", 
                "rules" : ["interface.statistics/check-host-loopback-status", "linecard.fpc/check-fpc-memory", "linecard.ospf/check-ddos-statistics", "linecard.statistics/check-center-chip-host-path", "linecard.statistics/check-cm-error-table", "linecard.statistics/check-fpc-cpu-scheduler-info", "linecard.statistics/check-fpc-threads", "linecard.statistics/check-fpc-utilization-information", "linecard.statistics/check-ithrottle", "linecard.statistics/check-ithrottle-statistics", "linecard.statistics/check-jnh-exceptions", "linecard.statistics/check-jnh-interface-statistics", "linecard.statistics/check-linecard-ethernet-statistics", "linecard.statistics/check-pci-error-counters", "linecard.statistics/check-pfe-traffic-statistics", "linecard.statistics/check-pre-classifier-dropped-packets", "linecard.statistics/check-traffic-offload-engine-status", "protocol.infra/check-task-io-drops", "protocol.infra/check-task-memory-usage", "protocol.ospf/check-ospf-forwarding-table", "protocol.ospf/check-ospf-io-statistics-information", "protocol.ospf/check-ospf-neighbor-information", "protocol.ospf/check-ospf-statistics-information", "protocol.ospf/fpc-link-stats", "protocol.ospf/pfe-ddos-policer", "system.statistics/check-routing-engine-cpu-utilization", "system.statistics/check-system-input-queues", "system.statistics/check-system-output-queues", "system.statistics/check-system-statistics-ip", "system.statistics/check-system-storage-capacity", "system.statistics/check-system-virtual-memory-information", "system.statistics/check-version"],
                "description" : "Playbook detects OSPF protocol and its subsystems anomalies", 
                "synopsis" : "OSPF RCA kpis"
            }, 
            {
                "playbook-name" : "route-summary-playbook", 
                "rules" : ["protocol.routesummary/check-ascertain-routes", "protocol.routesummary/check-protocol-route-count"],
                "description" : "Playbook checks each table's and protocol's route count and notifies anomaly when route count is above or below dynamic threshold", 
                "synopsis" : "Route table and protocol routes key performance indicators"
            }, 
            {
                "playbook-name" : "subscriber-services", 
                "rules" : ["service.protocols/pppoe-error-statistics", "service.subscribers/chk-addr-pool-util", "service.subscribers/linked-address-pool", "service.subscribers/monitor-subscriber-count"],
                "description" : "The subscriber-services playbook contains rules for monitoring the health subscriber services KPI", 
                "synopsis" : "Subscriber services KPI"
            }, 
            {
                "playbook-name" : "system-blackhole-detection-playbook", 
                "rules" : ["system.traffic/check-system-traffic"],
                "description" : "Playbook detects blackhole based on difference between input and output traffic and notifies anomalies", 
                "synopsis" : "System blackhole detection key performance indicators"
            }, 
            {
                "playbook-name" : "system-kpis-playbook", 
                "rules" : ["system.cpu/check-system-cpu", "system.cpu/check-system-cpu-load-average", "system.memory/check-system-memory", "system.processes/check-process-cpu", "system.processes/check-process-memory", "system.storage/check-storage"],
                "description" : "Playbook checks the system health i.e. system cpu, memory, storage and junos processes cpu and memory utilization", 
                "synopsis" : "System key performance indicators"
            }, 
            {
                "playbook-name" : "vpn-view", 
                "rules" : ["protocol.l3vpn/check-l3vpn-state"],
                "description" : "Playbook checks health of L3VPN session, PE and CE interface status and notify anomaly when statistics are unusual", 
                "synopsis" : "L3VPN network health analyzer"
            }
            ]
        }
    }
}
